<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="ICJJ Blog"><meta property="og:type" content="article"><meta property="og:image" content="img/site/小米汽车/原型车壁纸/2880x1280/2880x1280-00.png"><meta property="twitter:image" content="img/site/小米汽车/原型车壁纸/2880x1280/2880x1280-00.png"><meta name=title content="AMBA5 APB 协议翻译"><meta property="og:title" content="AMBA5 APB 协议翻译"><meta property="twitter:title" content="AMBA5 APB 协议翻译"><meta name=description content="AMBA5 APB的协议翻译"><meta property="og:description" content="AMBA5 APB的协议翻译"><meta property="twitter:description" content="AMBA5 APB的协议翻译"><meta property="twitter:card" content="summary"><meta name=keyword content="程建军, chengjianjun, ChengJianjun, , 程建军的网络日志, 程建军的博客, ChengJianjun Blog, 博客, 个人网站, AMBA, FPGA, SPINALHDL, PCIE"><link rel="shortcut icon" href=/icer/img/site/favicon.ico><title>AMBA5 APB 协议翻译 | 程建军的博客 | ChengJianjun Blog</title>
<link rel=canonical href=/icer/post/amba5-apb-%E5%8D%8F%E8%AE%AE%E7%BF%BB%E8%AF%91/><link rel=stylesheet href=/icer/css/bootstrap.min.css><link rel=stylesheet href=/icer/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/icer/css/zanshang.css><link rel=stylesheet href=/icer/css/font-awesome.all.min.css><script src=/icer/js/jquery.min.js></script><script src=/icer/js/bootstrap.min.js></script><script src=/icer/js/hux-blog.min.js></script><script src=/icer/js/lazysizes.min.js></script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-FWR2FVFK68"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FWR2FVFK68")}</script><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=/icer>ICJJ Blog</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/icer>Posts</a></li><li><a href=/icer/categories/bus/>bus</a></li><li><a href=/icer/categories/tech/>tech</a></li><li><a href=/icer/categories/tips/>tips</a></li><li><a href=/icer/archive/>ARCHIVE</a></li><li><a href=/icer/about/>ABOUT</a></li><li><a href=/icer/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/icer/img/site/%e5%b0%8f%e7%b1%b3%e6%b1%bd%e8%bd%a6/%e5%8e%9f%e5%9e%8b%e8%bd%a6%e5%a3%81%e7%ba%b8/2880x1280/2880x1280-00.png)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags><a class=tag href=/tags/amba5 title=AMBA5>AMBA5
</a><a class=tag href=/tags/apb title=APB>APB
</a><a class=tag href=/tags/%E5%8D%8F%E8%AE%AE%E7%BF%BB%E8%AF%91 title=协议翻译>协议翻译</a></div><h1>AMBA5 APB 协议翻译</h1><h2 class=subheading></h2><span class=meta>Posted by
程建军
on
Tuesday, April 23, 2024</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><h1 id=a-idamba-apb-协议规范amba-apb-协议规范a><a id="AMBA APB 协议规范">AMBA APB 协议规范</a></h1><blockquote><p><a href=https://icjj.github.io/icer/document/IHI0024E_amba_apb_architecture_spec.pdf>IHI0024E_amba_apb_architecture_spec.pdf</a></p></blockquote><h2 id=a-idamba-apb-的协议翻译amba-apb-的协议翻译a><a id="AMBA APB 的协议翻译">AMBA APB 的协议翻译</a></h2><p><strong>发布信息<strong></p><table><thead><tr><th>时间</th><th>版本号</th><th>保密性</th><th>变化</th></tr></thead><tbody><tr><td>2023.09.05</td><td>A</td><td>无保密要求</td><td>第一次发布，v1.0</td></tr><tr><td>2004.08.17</td><td>B</td><td>无保密要求</td><td>第二次发布，v2.0</td></tr><tr><td>2010.04.13</td><td>C</td><td>无保密要求</td><td>第一次发布，v1.0</td></tr><tr><td>2021.05.09</td><td>D</td><td>无保密要求</td><td>为APB5版本加入了新功能</td></tr><tr><td>2023.02.28</td><td>E</td><td>无保密要求</td><td>在APB5版本加入了RME功能</td></tr></tbody></table><blockquote><p>Note:RME(Realm Management Extension)</p></blockquote><h3 id=a-id引言引言a><a id=引言>引言</a></h3><p>介绍了AMBA APB协议规范它包含以下部分：</p><ul><li><em><a href=#关于规范>关于规范</a></em></li><li><em><a href=#反馈>反馈</a></em></li></ul><h4 id=a-id关于规范关于规范a><a id=关于规范>关于规范</a></h4><p>此规格是针对高级微控制器总线架构（AMBA）高级外设总线（APB）协议规格的。</p><ul><li><em><a href=#目标受众>目标受众</a></em></li><li><em><a href=#使用本规范>使用本规范</a></em></li><li><em><a href=#约定>约定</a></em></li><li><em><a href=#外链阅读>外链阅读</a></em></li></ul><h5 id=a-id目标受众目标受众a><a id=目标受众>目标受众</a></h5><p>该规范是为希望熟悉AMBA APB协议的硬件和软件工程师编写的。</p><h5 id=a-id使用本规范使用本规范a><a id=使用本规范>使用本规范</a></h5><p>本规范组织如下章节：</p><p><em><a href="#第1章 介绍">第1章 介绍</a></em> ：介绍了AMBA APB协议的概述</br><em><a href="#第2章 信号介绍">第2章 信号介绍</a></em> ：介绍APB的信号</br><em><a href="#第3章 传输">第3章 传输</a></em> ：介绍APB的典型传输、错误响应和保护支持</br><em><a href="#第4章 操作状态">第4章 操作状态</a></em> ：介绍APB的操作状态和变换</br><em><a href="#第5章 接口奇偶校验保护">第5章 接口奇偶校验保护</a></em> ：介绍校验接口保护</br><em><a href="#附录a 信号有效性">附录A 信号有效性</a></em> ：介绍信号有效性的规则</br><em><a href="#附录b 信号列表">附录B 信号列表</a></em> ：汇总了APB的信号</br><em><a href="#附录c 版本">附录C 版本</a></em> ：介绍规范各个版本的变化。</br></p><h5 id=a-id约定约定a><a id=约定>约定</a></h5><p>本节描述了本规格使用的约定：</p><ul><li><a href=#排版>排版</a></li><li><a href=#时序图>时序图</a></li><li><a href=#信号>信号</a></li><li><a href=#数字>数字</a></li></ul><h6 id=a-id排版排版a><a id=排版>排版</a></h6><p>排版惯例是：</p><ul><li>italic(斜体)：突出重要笔记，介绍特殊术语，并指示内部交叉引用和引用。</li><li>bold(粗体)：表示信号名称，并用于描述性列表中的术语(如果适用)。</li><li>monospace(等宽)：该字体用于汇编程序语法描述、伪代码和源代码示例。</br>同时用于主要文本中的指令助记符，以及对出现在汇编程序语法描述、伪代码和源代码示例中的其他项目的引用。</li><li>SMALL CAPITALS(小写大写字母)：用于几个具有特定技术含义的术语。</li></ul><h6 id=a-id时序图时序图a><a id=时序图>时序图</a></h6><p><img src=https://icjj.github.io/icer/img/post/ahb/%e6%97%b6%e5%ba%8f%e5%9b%be%e7%ba%a6%e5%ae%9a.png alt></p><p>时序图有时会同时将单比特信号显示为高电平和低电平，它们看起来与时序图约定中的总线变化相似。
如果时序图以这种方式显示单比特信号，则其值不会影响随附的描述。
阴影总线和信号区域是未定义的，因此总线或信号可以在该时间内的阴影区域内假设任何值。实际电平并不重要，也不影响正常操作。</p><h6 id=a-id信号信号a><a id=信号>信号</a></h6><p>下面是关于信号方面的约定：</p><ul><li>信号电平：</br>断言信号的水平取决于信号是高有效还是低有效，断言意味着<ul><li>HIGH：表示高电平有效。</li><li>LOW：表示低电平有效。</li></ul></li><li>小写n：出现在信号名的开始或结束都表示低电平有效。</li><li>前缀H：表示AHB信号。</li><li>前缀P：表示APB信号。</li></ul><h6 id=a-id数字数字a><a id=数字>数字</a></h6><p>数字通常用十进制表示。二进制数字前加0b，而十六进制数字前加0x。</p><h5 id=a-id外链阅读外链阅读a><a id=外链阅读>外链阅读</a></h5><p><em><a href=https://developer.arm.com/docs>Arm Doc</a></em></p><h4 id=a-id反馈反馈a><a id=反馈>反馈</a></h4><ul><li>请通过填写 <em><a href=https://developer.arm.com/feedback/survey>https://developer.arm.com/feedback/survey</a></em>
上的表单，提交关于Arm产品文档的反馈意见。</li><li>有关Arm产品、架构和规格的技术反馈、问题或咨询，请在 <em><a href=https://support.developer.arm.com/my-cases/open-case/>https://support.developer.arm.com/my-cases/open-case/</a></em>
上提交支持请求。</li></ul><h3 id=a-id第1章-介绍第1章-介绍a><a id="第1章 介绍">第1章 介绍</a></h3><p>本章提供了APB协议的概述。它包含以下几个部分：</p><ul><li><em><a href="#1.1 关于APB">1.1 关于APB</a></em></li></ul><h4 id=a-id11-关于apb11-关于apba><a id="1.1 关于APB">1.1 关于APB</a></h4><p>APB协议是一种低成本接口，优化了最小功耗和减少接口复杂性。
APB接口没有流水线，是一种简单的同步协议。
每次传输至少需要两个周期才能完成。</p><p>APB接口旨在访问外围设备的可编程控制寄存器。
APB外设通常通过APB桥连接到主存储系统。
例如，可以使用AXI到APB的桥将多个APB外设连接到AXI存储系统。</p><p>APB传输由APB桥启动。APB桥也可以称为请求者（主机）。
外设接口对请求作出响应。APB外设也可以称为完成者（从机）。本规范将使用请求者（主机）和完成者（从机）。</p><h3 id=a-id第2章-信号介绍第2章-信号介绍a><a id="第2章 信号介绍">第2章 信号介绍</a></h3><p>本章描述了AMBA APB信号。它包含以下部分：</p><ul><li><em><a href="#2.1 信号介绍">2.1 信号介绍</a></em></li></ul><h4 id=21-amba-apb-信号>2.1 AMBA APB 信号</h4><p>本节描述了APB接口信号。</p><p>某些APB接口上的信号具有固定位宽，而某些信号可以具有多种位宽。
当位宽不是固定时，它通过属性进行描述。
如果属性值为零，这意味着该信号在接口上不存在。</p><p><em><a href="#表 2-1">表 2-1</a></em> 提供了APB协议接口信号的描述。</p><p><a id="表 2-1">表 2-1</a> APB 信号描述</p><table><thead><tr><th><strong>信号名</strong></th><th><strong>信号源</strong></th><th><strong>位宽</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><strong>PCLK</strong></td><td>时钟源</td><td>1</td><td>时钟。<br><strong>PCLK</strong>是时钟信号。所有APB信号都在<strong>PCLK</strong>的上升沿进行采样。</td></tr><tr><td><strong>PRESETn</strong></td><td>复位源</td><td>1</td><td>复位。<br><strong>PRESETn</strong>是复位信号，且为低有效信号。<br><strong>PRESETn</strong>通常直接连接到系统总线复位信号。</td></tr><tr><td><strong>PADDR</strong></td><td>主机</td><td>ADDR_WIDTH</td><td>地址。<strong>PADDR</strong>是APB地址总线，<strong>PADDR</strong>位宽可以达到32位。</td></tr><tr><td><strong>PPROT</strong></td><td>主机</td><td>3</td><td>保护类型。<br><strong>PPROT</strong>表示传输的正常、特权或安全保护级别，以及该传输是数据访问还是指令访问。详见 <em><a href="#3.5 保护单元支持">3.5 保护单元支持</a></em></td></tr><tr><td><strong>PNSE</strong></td><td>主机</td><td>1</td><td>扩展保护类型。详见 <em><a href="#3.6 realm扩展管理，RME">3.6 Realm扩展管理，RME</a></em></td></tr><tr><td><strong>PSELx</strong></td><td>主机</td><td>1</td><td>选择。<br>主机为每个从机生成一个<strong>PSELx</strong>信号，<strong>PSELx</strong>表示从机被选择并且需要进行数据传输。</td></tr><tr><td><strong>PENABLE</strong></td><td>主机</td><td>1</td><td>使能。<br><strong>PENABLE</strong>表示APB传输的第二个及后续周期。</td></tr><tr><td><strong>PWRITE</strong></td><td>主机</td><td>1</td><td>方向。<br>高电平<strong>PWRITE</strong>表示APB是写入访问，低电平<strong>PWRITE</strong>表示APB读取访问。</td></tr><tr><td><strong>PWDATA</strong></td><td>主机</td><td>DATA_WIDTH</td><td>写数据。<br><strong>PWRITE</strong>写数据总线在写周期内由APB桥主机驱动，当<strong>PWRITE</strong>为高电平时<strong>PWDATA</strong>可以是8位、16位或32位宽。</td></tr><tr><td><strong>PSTRB</strong></td><td>主机</td><td>DATA_WIDTH/8</td><td>脉冲写信号。<br>PSTRB 指示在写传输期间要更新哪些字节通道。每 8 位写数据总线有一个写使能信号。<strong>PSTRB[n]</strong>对应于<strong>PWDATA[(8n + 7):(8n)]</strong>。在读传输期间，<strong>PSTRB</strong>不能处于活动状态。详见 <em><a href="#3.2 脉冲写">3.2 脉冲写</a></em></td></tr><tr><td><strong>PREADY</strong></td><td>从机</td><td>1</td><td>准备。<br><strong>PREADY</strong>用于从机扩展APB传输。</td></tr><tr><td><strong>PRDATA</strong></td><td>从机</td><td>DATA_WIDTH</td><td>读取数据。<br>在<strong>PWRITE</strong>为低时，<strong>PRDATA</strong>读取数据总线由所选的从机在读取周期内驱动，<strong>PRDATA</strong>可以是8位、16位或32位宽。</td></tr><tr><td><strong>PSLVERR</strong></td><td>从机</td><td>1</td><td>传输错误。<strong>PSLVERR</strong>是一个可选信号，可以由主机断言为高电平，以指示APB传输出现错误。详见 <em><a href="#3.4 error响应">3.4 ERROR响应</a></em></td></tr><tr><td><strong>PWAKEUP</strong></td><td>主机</td><td>1</td><td>唤醒。<br><strong>PWAKEUP</strong>指的是与APB接口相关的任何唤醒动作。详见 <em><a href="#3.7 唤醒信号">3.7 唤醒信号</a></em></td></tr><tr><td><strong>PAUSER</strong></td><td>主机</td><td>USER_REQ_WIDTH</td><td>user请求属性。<br>建议<strong>PAUSER</strong>的最大位宽为128位。 详见 <em><a href="#3.8 user信号">3.8 user信号</a></em></td></tr><tr><td><strong>PWUSER</strong></td><td>主机</td><td>USER_DATA_WIDTH</td><td>user写数据属性。<br>建议<strong>PWUSER</strong>的最大位宽为DATA_WIDTH/2。详见 <em><a href="#3.8 user信号">3.8 user信号</a></em></td></tr><tr><td><strong>PRUSER</strong></td><td>从机</td><td>USER_DATA_WIDTH</td><td>user读数据属性。<br>建议<strong>PRUSER</strong>的最大位宽为DATA_WIDTH/2。详见 <em><a href="#3.8 user信号">3.8 user信号</a></em></td></tr><tr><td><strong>PBUSER</strong></td><td>从机</td><td>USER_RESP_WIDTH</td><td>user响应属性。<strong>PBUSER</strong>建议最大位宽为16位。详见 <em><a href="#3.8 user信号">3.8 user信号</a></em></td></tr></tbody></table><h5 id=a-id211-地址总线211-地址总线a><a id="2.1.1 地址总线">2.1.1 地址总线</a></h5><p>APB接口有一个单一的地址总线<strong>PADDR</strong>用于读写传输。<strong>PADDR</strong>表示字节地址。</p><p><strong>PADDR</strong>可以与数据位宽不对齐，但结果是不可预测的。
例如，一个从机可能使用未对齐的地址、对齐的地址，发出错误响应。</p><p>[ For example, a Subordinate might use the unaligned address, aligned address, or signal an error response.]</p><h5 id=a-id212-数据总线212-数据总线a><a id="2.1.2 数据总线">2.1.2 数据总线</a></h5><p>APB协议具有两个独立的数据总线，<strong>PRDATA</strong>用于读取数据，<strong>PWDATA</strong>用于写入数据。
这些总线可以是8位、16位或32位宽。
读取数据总线和写入数据总线必须具有相同的位宽。</p><p>数据传输不能同时进行，因为读取数据和写入数据总线没有各自独立的握手信号。</p><h3 id=a-id第3章-传输第3章-传输a><a id="第3章 传输">第3章 传输</a></h3><p>本章描述了典型的AMBA APB传输、错误响应和保护单元支持，包含以下各节：</p><ul><li><em><a href="#3.1 写传输">3.1 写传输</a></em></li><li><em><a href="#3.2 脉冲写">3.2 脉冲写</a></em></li><li><em><a href="#3.3 读传输">3.3 读传输</a></em></li><li><em><a href="#3.4 error响应">3.4 ERROR响应</a></em></li><li><em><a href="#3.5 保护单元支持">3.5 保护单元支持</a></em></li><li><em><a href="#3.6 realm管理扩展，rme">3.6 Realm管理扩展，RME</a></em></li><li><em><a href="#3.7 唤醒信号">3.7 唤醒信号</a></em></li><li><em><a href="#3.8 user信号">3.8 user信号</a></em></li></ul><h4 id=a-id31-写传输31-写传输a><a id="3.1 写传输">3.1 写传输</a></h4><p>本节描述以下几种写入传输类型：</p><ul><li><em><a href="#3.1.1 无等待写">3.1.1 无等待写</a></em></li><li><em><a href="#3.1.2 有等待写">3.1.2 有等待写</a></em></li></ul><p>本节中显示的所有信号都在PCLK的上升沿采样。</p><h5 id=a-id311-无等待写311-无等待写a><a id="3.1.1 无等待写">3.1.1 无等待写</a></h5><p><em><a href="#图 3-1">图 3-1</a></em> 显示了一个没有等待状态的基本写入传输。</p><p><a id="图 3-1">图 3-1
<img src=https://icjj.github.io/icer/img/post/apb/Figure_3-1_Write_transfer_with_no_wait_states.png alt></a></p><p>在 <em><a href="#图 3-1">图 3-1</a></em> 中：</p><ul><li>T0-T1：</br>无动作。</li><li>T1-T2：</br>主机请求对地址Addr1发起strong>PWRITE</strong>为高的Setup阶段写传输。</br>从机无动作。</li><li>T2-T3：</br>主机请求对地址Addr1发起<strong>PENABLE</strong>为高的Access阶段写传输。</br>从机拉高<strong>PREADY</strong>完成地址Addr1的传输。</li><li>T3-T4：</br>无动作。</li></ul><p>写入传输的Setup阶段发生在 <em><a href="#图 3-1">图 3-1</a></em> 中的T1处。
选择信号<strong>PSELx</strong>被断言（拉高），
这意味着<strong>PADDR</strong>、strong>PWRITE</strong>和<strong>PWDATA</strong>必须是有效的。</p><p>写入传输的Access阶段在 <em><a href="#图 2-1">图 2-1</a></em> 中的T2处显示，在此期间<strong>PENABLE</strong>被断言（拉高）。
<strong>PREADY</strong>在<strong>PCLK</strong>上升沿由从机断言（拉高），以表示写入数据将在T3处被接受。
<strong>PADDR</strong>、<strong>PWDATA</strong>和其他任何控制信号必须稳定，直到传输完成。</p><p>在传输结束时，<strong>PENABLE</strong>被解除断言（拉低）。除非存在另一个传输到同一外设，否则<strong>PSELx</strong>也被解除断言（拉低）。</p><h5 id=a-id312-有等待写312-有等待写a><a id="3.1.2 有等待写">3.1.2 有等待写</a></h5><p><em><a href="#图 3-2">图 3-2</a></em> 显示了从机如何使用<strong>PREADY</strong>来扩展写传输。</p><p><a id="图 3-2">图 3-2
<img src=https://icjj.github.io/icer/img/post/apb/Figure_3-2_Write_transfer_with_wait_states.png alt></a></p><p>在 <em><a href="#图 3-2">图 3-2</a></em> 中</p><ul><li>T0-T1：</br>无动作。</li><li>T1-T2：</br>主机请求对地址Addr1发起strong>PWRITE</strong>为高的Setup阶段写传输。</br>从机无动作。</li><li>T2-T3：</br>主机请求对地址Addr1发起<strong>PENABLE</strong>为高的Access阶段写传输。</br>从机拉低<strong>PREADY</strong>请求主机对传输插入一个等待周期。</li><li>T3-T4：</br>主机保持不变。</br>从机保持不变。</li><li>T4-T5：</br>主机保持不变。</br>从机拉高<strong>PREADY</strong>完成地址Addr1的传输。</li><li>T5-T6：</br>无动作。</li></ul><p>在Access阶段，当<strong>PENABLE</strong>为高时，从机通过将<strong>PREADY</strong>拉低来扩展传输。</p><p>在<strong>PREADY</strong>为低时，以下信号保持不变：</p><ul><li>地址信号，<strong>PADDR</strong></li><li>方向信号，<strong>PWRITE</strong></li><li>选择信号，<strong>PSELx</strong></li><li>使能信号，<strong>PENABLE</strong></li><li>写数据信号，<strong>PWDATA</strong></li><li>写脉冲信号，<strong>PSTRB</strong></li><li>保护类型信号，<strong>PPROT</strong></li><li>用户请求属性，<strong>PAUSER</strong></li><li>用户写数据属性，<strong>PWUSER</strong></li></ul><p>当<strong>PENABLE</strong>为低时，<strong>PREADY</strong>可以取任何值。
这确保了具有固定两个周期访问的外设可以将<strong>PREADY</strong>拉高。</p><h4 id=a-id32-脉冲写32-脉冲写a><a id="3.2 脉冲写">3.2 脉冲写</a></h4><p><strong>PSTRB</strong>使得写数据总线上的稀疏数据传输成为可能。
每个<strong>PSTRB</strong>对应于写数据总线的1个字节。
当<strong>PSTRB</strong>某个bit断言为高电平时，表示写数据总线相应的字节通道包含有效信息。</p><p>每8位写数据总线都与一个<strong>PSTRB</strong> bit对应，
因此<strong>PSTRB[n]</strong>对应于<strong>PWDATA[(8n + 7):(8n)]</strong>。</p><p><em><a href="#图 3-3">图 3-3</a></em> 展示了在 32 位数据总线上的这种关系。</p><p><a id="图 3-3">图 3-3
<img src=https://icjj.github.io/icer/img/post/apb/Figure_3-3_Byte_lane_mapping.png alt></a></p><p>对于读取传输，请求者必须将所有PSTRB位拉低。</p><h5 id=a-id321-pstrb的兼容性321-pstrb的兼容性a><a id="3.2.1 PSTRB的兼容性">3.2.1 PSTRB的兼容性</a></h5><p><strong>PSTRB</strong>是一个可选信号。
APB外设可能支持有限的访问类型，这些类型必须记录给程序员。
这意味着如果该文档声明不支持稀疏写入，则所有<strong>PSTRB</strong>存在的组合可能是兼容的。
当连接主机和从机时，<strong>PSTRB</strong>的兼容性描述在 <em><a href="#表 3-1">表 3-1</a></em> 。</p><p><a id="表 3-1">表 3-1</a> <strong>PSTRB</strong>的存在与兼容性</p><table><thead><tr><th><strong>PSTRB</strong></th><th>从机不存在该信号</th><th>从机存在该信号</th></tr></thead><tbody><tr><td>主机不存在该信号</td><td>兼容。</br>不支持稀疏写。</td><td>兼容.</br>所有写数据字节通道在写入时均有效。</br><strong>PSTRB</strong>应该与<strong>PWDATA</strong>直接连接。</td></tr><tr><td>主机存在该信号</td><td>兼容。</br>不支持稀疏写。</td><td>兼容。</br>不支持稀疏写.</td></tr></tbody></table><h4 id=a-id33-读传输33-读传输a><a id="3.3 读传输">3.3 读传输</a></h4><p>包含有两种读方式：</p><ul><li><em><a href="#3.3.1 无等待读传输">3.3.1 无等待读传输</a></em></li><li><em><a href="#3.3.2 有等待读传输">3.3.2 有等待读传输</a></em></li></ul><p>本节中显示的所有信号都在PCLK的上升沿采样。</p><h5 id=a-id331-无等待读传输331-无等待读传输a><a id="3.3.1 无等待读传输">3.3.1 无等待读传输</a></h5><p><em><a href="#图 3-4">图 3-4</a></em> 显示了无等待读取传输。</p><p><a id="图 3-4">图 3-4
<img src=https://icjj.github.io/icer/img/post/apb/Figure_3-4_Read_transfer_with_no_wait_states.png alt></a></p><p>在 <em><a href="#图 3-4">图 3-4</a></em> 中：</p><ul><li>T0-T1：</br>无动作。</li><li>T1-T2：</br>主机请求对地址Addr1发起strong>PWRITE</strong>为低的Setup阶段读传输。</br>从机无动作。</li><li>T2-T3：</br>主机请求对地址Addr1发起<strong>PENABLE</strong>为高的Access阶段读传输。</br>从机拉高<strong>PREADY</strong>完成地址Addr1的传输。</li><li>T3-T4：</br>无动作。</li></ul><p>地址信号<strong>PADDR</strong>、写信号<strong>PWRITE</strong>、选择信号<strong>PSELx</strong>和
使能信号<strong>PENABLE</strong>的时序与 <em><a href="#3.1.1 无等待写传输">3.1.1 无等待写传输</a></em> 描述的相似。
主机必须在读传输结束之前提供数据。</p><h5 id=a-id332-有等待读332-有等待读a><a id="3.3.2 有等待读">3.3.2 有等待读</a></h5><p><em><a href="#图 3-5">图 3-5</a></em> 展示了<strong>PREADY</strong>信号如何扩展读传输。</p><p><a id="图 3-5">图 3-5
<img src=https://icjj.github.io/icer/img/post/apb/Figure_3-5_Read_transfer_with_wait_states.png alt></a></p><p>在 <em><a href="#图 3-5">图 3-5</a></em> 中</p><ul><li>T0-T1：</br>无动作。</li><li>T1-T2：</br>主机请求对地址Addr1发起strong>PWRITE</strong>为低的Setup阶段读传输。</br>从机无动作。</li><li>T2-T3：</br>主机请求对地址Addr1发起<strong>PENABLE</strong>为高的Access阶段读传输。</br>从机拉低<strong>PREADY</strong>请求主机对传输插入一个等待周期。</li><li>T3-T4：</br>主机保持不变。</br>从机保持不变。</li><li>T4-T5：</br>保持不变。</br>从机拉高<strong>PREADY</strong>完成地址Addr1的传输。</li><li>T5-T6：</br>无动作。</li></ul><p>如果在Access阶段期间将<strong>PREADY</strong>拉低，则传输将延长。
以下信号在<strong>PREADY</strong>保持拉低时保持不变：</p><ul><li>地址信号，<strong>PADDR</strong></li><li>方向信号，<strong>PWRITE</strong></li><li>选择信号，<strong>PSELx</strong></li><li>使能信号，<strong>PENABLE</strong></li><li>保护信号，<strong>PPROT</strong></li><li>用户信号，<strong>PAUSER</strong></li></ul><p><em><a href="#图 3-5">图 3-5</a></em> 显示使用<strong>PREADY</strong>添加了两个周期等待。
然而，可以添加任意数量的额外周期实现等待操作。</p><h4 id=a-id34-error响应34-error响应a><a id="3.4 error响应">3.4 ERROR响应</a></h4><p><strong>PSLVERR</strong>可用于表示APB传输中的错误状态。错误状态可以在读和写传输中发生。</p><p><strong>PSLVERR</strong>仅在APB传输的最后一个周期内被视为有效，
此时<strong>PSELx</strong>、<strong>PENABLE</strong>和<strong>PREADY</strong>均为高电平。</p><p>建议，但不要求，当<strong>PSELx</strong>、<strong>PENABLE</strong>或<strong>PREADY</strong>为低电平时，
将<strong>PSLVERR</strong>驱动为低电平。</p><p>收到错误的传输可能已经或未改变外设的状态，
相对于于外设来说，两种状态都是可以接受的。
当写传输收到错误时，并不意味着外设内的寄存器没有被更新。</p><p>收到错误的读传输可能返回无效数据，
对于读错误，外设没有必要将数据总线驱动为全0。</p><p>收到读传输错误响应的主机仍然可以使用该数据。
从机不能依赖错误响应来阻止读取<strong>PRDATA</strong>上的值。</p><p>从机不强制支持<strong>PSLVERR</strong>。
如果主机不包含<strong>PSLVERR</strong>，
则主机的相应输入应该被连接为低电平。</p><h5 id=a-id341-写传输341-写传输a><a id="3.4.1 写传输">3.4.1 写传输<a></h5><p><em><a href="#图 3-6">图 3-6</a></em> 显示了一个失败的写入传输示例，该传输以错误结束。</p><p>在 <em><a href="#图 3-6">图 3-6</a></em> 中</p><ul><li>T0-T1：</br>无动作。</li><li>T1-T2：</br>主机请求对地址Addr1发起strong>PWRITE</strong>为高的Setup阶段写传输。</br>从机无动作。</li><li>T2-T3：</br>主机请求对地址Addr1发起<strong>PENABLE</strong>为高的Access阶段写传输。</br>从机拉低<strong>PREADY</strong>请求主机对传输插入一个等待周期。</li><li>T4-T5：</br>主机保持不变。</br>从机拉高<strong>PREADY</strong>和<strong>PSLVERR</strong>完成地址Addr1的失败传输。</li><li>T5-T6：</br>无动作。</li></ul><p><a id="图 3-6">图 3-6
<img src=https://icjj.github.io/icer/img/post/apb/Figure_3-6_Example_failing_write_transfer.png alt></a></p><h5 id=a-id342-读传输342-读传输a><a id="3.4.2 读传输">3.4.2 读传输</a></h5><p>读取传输也可以用ERROR响应完成，表示没有有效的读取数据可用。
<em><a href="#图 3-7">图 3-7</a></em> 显示了一个以ERROR响应完成的读取传输。</p><p><a id="图 3-7">图 3-7
<img src=https://icjj.github.io/icer/img/post/apb/Figure_3-7_Example_failing_read_transfer.png alt></a></p><p>在 <em><a href="#图 3-7">图 3-7</a></em> 中</p><ul><li>T0-T1：</br>无动作。</li><li>T1-T2：</br>主机请求对地址Addr1发起strong>PWRITE</strong>为低的Setup阶段读传输。</br>从机无动作。</li><li>T2-T3：</br>主机请求对地址Addr1发起<strong>PENABLE</strong>为高的Access阶段读传输。</br>从机拉低<strong>PREADY</strong>请求主机对传输插入一个等待周期。</li><li>T3-T4：</br>主机保持不变。</br>从机保持不变。</li><li>T4-T5：</br>保持不变。</br>从机拉高<strong>PREADY</strong>和<strong>PSLVERR</strong>完成地址Addr1的ERROR传输。</li><li>T5-T6：</br>无动作。</li></ul><h5 id=a-id343-pslverr的映射343-pslverr的映射a><a id="3.4.3 PSLVERR的映射">3.4.3 PSLVERR的映射</a></h5><p>当进行桥接时：</p><ul><li>从AXI到APB： 在<strong>PSLVERR</strong>上的APB错误被映射回AXI读取的<strong>RRESP</strong>和写入的<strong>BRESP</strong>。</li><li>从AHB到APB： 在<strong>PSLVERR</strong>上的APB错误被映射回AHB读取和写入的<strong>HRESP</strong>。</li></ul><h4 id=a-id35-保护单元支持35-保护单元支持a><a id="3.5 保护单元支持">3.5 保护单元支持</a></h4><p>为了支持复杂的系统设计，通常需要系统中的互连和其他设备提供对非法交易的保护。
对于APB接口，这种保护通过<strong>PPROT[2:0]</strong>信号提供。
<em><a href="#表 3-2">表 3-2</a></em> 显示了三种访问保护级别及其保护级别编码。</p><p><a id="表 3-2">表 3-2</a> 访问保护</p><table><thead><tr><th><strong>PPROT</strong></th><th>保护类型</th><th>描述</th><th>信号值和对应保护类型</th></tr></thead><tbody><tr><td><strong>PPROT[0]</strong></td><td>Normal或Privileged</td><td><strong>PPROT[0]</strong>被主机用来表示处理模式。特权处理模式通常在系统中具有更高的访问级别。</td><td>LOW：normal<br>HIGH：privileged</td></tr><tr><td><strong>PPROT[1]</strong></td><td>Secure或Non-secure</td><td><strong>PPROT[1]</strong>用于需要在处理模式之间具有更大区分度的系统。</td><td>LOW：secure<br>HIGH：None-secure</td></tr><tr><td><strong>PPROT[2]</strong></td><td>Data或Instruction</td><td><strong>PPROT[0]</strong>用于表示该传输是否为数据或指令访问，传输表示作为提示提供，在所有情况下并不一定准确</td><td>LOW：data<br>HIGH：Inst</td></tr></tbody></table><blockquote><p>Note：PPROT的主要用途是作为安全或非安全交易的标识符。
使用不同的PPROT[0]和PPROT[2]标识符的解释是可以接受的。</p></blockquote><h5 id=a-id351-pprot的存在和兼容性351-pprot的存在和兼容性a><a id="3.5.1 PPROT的存在和兼容性">3.5.1 PPROT的存在和兼容性</a></h5><p>PPROT是主机和从机接口上的一个可选信号。
<em><a href="#表 3-3">表 3-3</a></em> 描述了连接主机到从机时的<strong>PPROT</strong>兼容性表现。</p><p><a id="表 3-3">表 3-3</a> <strong>PPROT[0]</strong>的存在和兼容性</p><table><thead><tr><th><strong>PPROT</strong></th><th>从机不存在该信号</th><th>从机存在该信号</th></tr></thead><tbody><tr><td>主机不存在该信号</td><td>兼容</td><td>不兼容，如果在功能上保证了正确就是兼容的。详见 <em><a href="#表 3-2">表 3-2</a></em></td></tr><tr><td>主机存在该信号</td><td>兼容，从机无法访问该信号，因此该信号可以被忽略。</td><td>兼容</td></tr></tbody></table><h4 id=a-id36-realm管理扩展rme36-realm管理扩展rmea><a id="3.6 realm管理扩展，rme">3.6 Realm管理扩展，RME</a></h4><p>本节描述了APB协议对Arm ® Realm Management Extension (RME)系统架构的支持。
RME是ARM TrustZoon架构的一部分。</p><h5 id=a-id361-root和realm-物理地址空间361-root和realm-物理地址空间a><a id="3.6.1 Root和Realm 物理地址空间">3.6.1 Root和Realm 物理地址空间</a></h5><p>RME将Root和Realm物理地址空间添加到Arm架构中。
这些可以在APB事务的权限检查中使用。
<em><a href="#表 3-4">表 3-4</a></em> 列出了为支持RME而在APB5接口上添加的额外信号。</p><p><a id="表 3-4">表 3-4</a> PNSE信号描述</p><table><thead><tr><th>信号</th><th>位宽</th><th>信号源</th><th>描述</th></tr></thead><tbody><tr><td>PNSE</td><td>1</td><td>主机</td><td>扩展保护类型。</br>当<strong>PSELx</strong>被断言（拉高）时<strong>PNSE</strong>必须有效</td></tr></tbody></table><p><em><a href="#表 3-5">表 3-5</a></em> 列出了<strong>PNSE</strong>和<strong>PPROT</strong>的允许组合，
这些组合决定了事务的物理地址空间。</p><p><a id="表 3-5">表 3-5</a> <strong>PNSE</strong>和<strong>PPROT[1]</strong>决定了传输的物理地址空间</p><table><thead><tr><th><strong>PNSE</strong></th><th><strong>PPROT[1]</strong></th><th>物理地址空间</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>Secure</td></tr><tr><td>0</td><td>1</td><td>Non-secure</td></tr><tr><td>1</td><td>0</td><td>Root</td></tr><tr><td>1</td><td>1</td><td>Realm</td></tr></tbody></table><h5 id=a-id362-配置362-配置a><a id="3.6.2 配置">3.6.2 配置</a></h5><p>RME_Support 属性用于表示 APB 接口是否支持 RME：</p><ul><li>True：RME是支持的，<strong>PNSE</strong>信号在接口上存在，且能在APB5接口上使用。</li><li>False：RME不支持。<strong>PNSE</strong>信号在接口上不存在，如果在接口上未声明RME_Support属性，则视为False。</li></ul><p>如果<strong>PNSE</strong>存在于接口上，<strong>PPROT</strong>也必须存在。</p><p><strong>PNSE</strong>信号使用<strong>PCTRLCHK</strong>信号进行奇偶校验保护。</p><p><em><a href="#表 3-6">表 3-6</a></em> 列出了依据RME_Support属性的值，主机和从机接口之间的兼容性，</p><p><a id="表 3-6">表 3-6</a> RME_Support 存在和兼容性</p><table><thead><tr><th>RME_Support</th><th>从机不存在该信号</th><th>从机存在该信号</th></tr></thead><tbody><tr><td>主机不存在该信号</td><td>兼容</td><td>兼容。</br><strong>PNSE</strong>绑定为LOW</td></tr><tr><td>主机存在该信号</td><td>不兼容</td><td>兼容</td></tr></tbody></table><h4 id=a-id37-唤醒信号37-唤醒信号a><a id="3.7 唤醒信号">3.7 唤醒信号</a></h4><p>本节描述了在APB接口中使用的唤醒信号。</p><h5 id=a-id371-介绍371-介绍a><a id="3.7.1 介绍">3.7.1 介绍</a></h5><p>唤醒信号<strong>PWAKEUP</strong>用于表示与任何APB接口关联的任何唤醒行为。</p><p><strong>PWAKEUP</strong>提供一个无毛刺的信号，可以路由到时钟控制器或类似组件，
以使连接组件的电源和时钟启用Wakeup_Signal属性用于表示组件是否支持唤醒信号：</p><ul><li>True：存在唤醒信号</li><li>False 不存在唤醒信号。如果未声明Wakeup_Signal属性，则视为False。</li></ul><p>唤醒信号只能添加到APB5协议接口。</p><h5 id=a-id372-唤醒信号372-唤醒信号a><a id="3.7.2 唤醒信号">3.7.2 唤醒信号</a></h5><p><em><a href="#表 3-7">表 3-7</a></em> 描述了<strong>PWAKEUP</strong>信号。</p><p><a id="表 3-7">表 3-7</a> <strong>PWAKEUP</strong>信号描述</p><table><thead><tr><th>信号</th><th>位宽</th><th>信号源</th><th>描述</th></tr></thead><tbody><tr><td><strong>PWAKEUP</strong></td><td>1</td><td>主机</td><td><strong>PWAKEUP</strong>指与主机接口相关的任何唤醒行为。</td></tr></tbody></table><p><strong>PWAKEUP</strong>的规则和建议如下：</p><ul><li><strong>PWAKEUP</strong>与<strong>PCLK</strong>同步，必须在与其不同的时钟域中异步采样，
这是<strong>PWAKEUP</strong>无毛刺所需要的。例如，可以通过直接从寄存器生成或通过无毛刺的OR树来实现。</li><li><strong>PWAKEUP</strong>可以在<strong>PSELx</strong>断言之前、期间或之后被断言。</li><li>在<strong>PREADY</strong>断言之前，允许主机等待<strong>PWAKEUP</strong>被断言。
如果<strong>PWAKEUP</strong>存在但从未被断言，接口可能会出现死锁。</li><li>如果<strong>PWAKEUP</strong>和<strong>PSELx</strong>在同一个周期内均为HIGH，
<strong>PWAKEUP</strong>必须保持被断言状态，直至<strong>PREADY</strong>被断言。</li><li>建议在断言<strong>PSELx</strong>之前至少提前一个周期断言<strong>PWAKEUP</strong>，以防止新传输被延迟。</li><li>建议在不再需要进一步传输时解除<strong>PWAKEUP</strong>的断言。</li><li>允许但不建议在没有发生传输的情况下先断言<strong>PWAKEUP</strong>再解除其断言。</li><li>建议连接的主机和从机的时钟一起进行时钟门控。
如果从机接口的时钟与主机时钟独立门控，并且使用<strong>PWAKEUP</strong>启用从机时钟，
则存在从机错过传输的Setup阶段的可能性。</li></ul><h4 id=a-id38-user信号38-user信号a><a id="3.8 user信号">3.8 user信号</a></h4><p>本节描述了APB接口中的user信号。</p><h5 id=a-id381-介绍381-介绍a><a id="3.8.1 介绍">3.8.1 介绍</a></h5><p>APB协议的用户可能会遇到一个需要添加未在APB协议中指定的信令的应用程序。
user信号定义了一种将此信号添加到传输的标准方法，而不定义信号的使用。</p><p>通常建议不要使用user信号。APB协议接口并未定义这些信号的功能，
如果两个组件以不兼容的方式使用相同的user信号，将导致互操作性问题。</p><p>user信号只能添加到APB5协议接口。</p><h5 id=a-id382-信号382-信号a><a id="3.8.2 信号">3.8.2 信号</a></h5><p>所有信号都是可选的。如果相关的位宽属性为零，则信号不存在。</p><table><thead><tr><th>信号</th><th>位宽</th><th>信号源</th><th>描述</th></tr></thead><tbody><tr><td><strong>PAUSER</strong></td><td>USER_REQ_WIDTH</td><td>主机</td><td>用户定义的请求。<br>当<strong>PSELx</strong>被断言（拉高）时，<strong>PAUSER</strong>必须有效。<br>在一次传输的Setup和Access阶段内<strong>PAUSER</strong>值必须保持不变。<br>在Access阶段内部的每一个周期<strong>PAUSER</strong>也必须保持不变。</td></tr><tr><td><strong>PWUSER</strong></td><td>USER_DATA_WIDTH</td><td>主机</td><td>用户定义的写数据。<br>当<strong>PSELx</strong>和<strong>PWRITE</strong>被断言时，<strong>PWUSER</strong>必须有效。<br>在一次传输的Setup和Access阶段内<strong>PWUSER</strong>值必须保持不变。<br>在Access阶段内部的每一个周期<strong>PWUSER</strong>也必须保持不变。</td></tr><tr><td><strong>PRUSER</strong></td><td>USER_DATA_WIDTH</td><td>从机</td><td>用户定义的读数据。<br>当<strong>PSELx</strong>、<strong>PENABLE</strong>、<strong>PREADY</strong>被断言时，<strong>PWRITE</strong>被解除断言（拉低）时，<strong>PRUSER</strong>必须有效。</td></tr><tr><td><strong>PBUSER</strong></td><td>USER_RESP_WIDTH</td><td>从机</td><td>用户定义的响应。<br>当<strong>PSELx</strong>、<strong>PENABLE</strong>、<strong>PREADY</strong>被断言时，<strong>PBUSER</strong>必须有效。</td></tr></tbody></table><h5 id=a-id383-user信号的建议383-user信号的建议a><a id="3.8.3 user信号的建议">3.8.3 user信号的建议</a></h5><p>在user信号被实现的地方，本规范不要求支持所有user信号。
user信号的位宽由实现决定，并且请求、数据和响应的位宽可以不同。</p><p>建议在域跨越的桥或互连上包含所有user信号的支持。
然而，从机上没有要求必须包括它们。</p><p>建议USER_DATA_WIDTH是数据总线位宽的整数倍（以字节为单位），便于进行数据位宽和协议转换。</p><h3 id=a-id第4章-操作状态第4章-操作状态a><a id="第4章 操作状态">第4章 操作状态</a></h3><p>本章描述了AMBA APB的操作状态。它包含以下部分：</p><ul><li><em><a href="#4.1 操作状态">4.1 操作状态</a></em></li></ul><h4 id=a-id41-操作状态41-操作状态a><a id="4.1 操作状态">4.1 操作状态</a></h4><p><em><a href="#图 4-1">图 4-1</a></em> 展示了APB接口的操作状态。</p><p><a id="图 4-1">图 4-1
<img src=https://icjj.github.io/icer/img/post/apb/Figure_4-1_State_diagram.png alt></a></p><p>状态机通过以下状态进行操作：</p><ul><li>IDLE：</br>这是APB接口的默认状态。</li><li>SETUP：</br>当需要传输时，接口会进入SETUP状态，此时选择信号<strong>PSELx</strong>被断言。
接口只在SETUP状态停留一个时钟周期，并且总是在下一个时钟上升沿移动到ACCESS状态。</li><li>ACCESS：</br>在ACCESS状态中，使能信号<strong>PENABLE</strong>被断言。
在SETUP和ACCESS之间的转变以及ACCESS状态中的周期之间，以下信号必须保持不变：<ul><li><strong>PADDR</strong></li><li><strong>PPROT</strong></li><li><strong>PWRITE</strong></li><li><strong>PWDATA</strong>，仅针对写传输。</li><li><strong>PSTRB</strong></li><li><strong>PAUSER</strong></li><li><strong>PWUSER</strong></br>ACCESS状态的退出由来自从机的<strong>PREADY</strong>信号所控制。</br>如果从机将<strong>PREADY</strong>拉低，则保持ACCESS状态。</br>如果从机将<strong>PREADY</strong>拉高，则退出ACCESS状态，如果不再需要传输，总线返回到IDLE状态。
如果另一个传输跟随，则总线直接移动到SETUP状态。</li></ul></li></ul><h3 id=a-id第5章-奇偶校验接口保护第5章-奇偶校验接口保护a><a id="第5章 奇偶校验接口保护">第5章 奇偶校验接口保护</a></h3><p>本章描述了一种用于检测组件之间接口上单比特错误的奇偶校验方案。它包含以下几个部分：</p><ul><li><em><a href="#5.1 接口保护">5.1 接口保护</a></em></li><li><em><a href="#5.2 接口保护配置">5.2 接口保护配置</a></em></li><li><em><a href="#5.3 奇偶校验检查">5.3 奇偶校验检查</a></em></li><li><em><a href="#5.4 错误检测">5.4 错误检测</a></em></li><li><em><a href="#5.5 校验检查信号">5.5 校验检查信号</a></em></li></ul><h4 id=a-id51-接口保护51-接口保护a><a id="5.1 接口保护">5.1 接口保护</a></h4><p>对于安全关键应用，必须在SoC内部的单个线路上检测和纠正瞬态和功能错误。</p><p>系统组件中的错误可能会传播并导致连接组件之间出现多个错误。
需要端到端的错误检测与纠正（EDC），覆盖从源到目的地的所有逻辑和线路。</p><p>实现端到端保护的一种方法是在组件中使用定制的EDC方案，并在组件之间实施简单的错误检测方案。
在这些组件之间没有逻辑，单比特错误不会传播为多比特错误。
本节描述了一种在组件之间接口上检测单比特错误的奇偶校验方案。
如果多比特错误发生在不同的奇偶校验信号组中，则可以检测到这些错误。</p><p><a id="图 5-1">图 5-1</a> 显示了可以使用奇偶校验的位置。</p><p><a id="图 5-1">图 5-1
<img src=https://icjj.github.io/icer/img/post/apb/Figure_5-1_Example_use_of_parity_protection.png alt></a></p><h4 id=a-id52-接口保护配置52-接口保护配置a><a id="5.2 接口保护配置">5.2 接口保护配置</a></h4><p>接口的EDC方案由Check_Type属性定义。以下是定义的Check_Type值：</p><ul><li>False：</br>接口上没有检测信号。</li><li>Odd_Parity_Byte_All：</br>所有信号都包含奇数奇偶校验。 奇偶校验信号的每一位覆盖最多8位。</li></ul><p>如果未声明Check_Type，则视为False。</p><p>检测信号仅可以添加到APB5接口中。</p><h4 id=a-id53-奇偶校验检查53-奇偶校验检查a><a id="5.3 奇偶校验检查">5.3 奇偶校验检查</a></h4><p>以下属性是为字节奇偶校验接口保护所添加检查信号的共同特征：</p><ul><li>使用奇数奇偶校验时。奇数奇偶校验意味着在接口信号和检查信号中，总是存在奇数个比特被断言（高）。检查信号与每个接口信号相关联。</li><li>每个校验bit覆盖的有效payload bit不超过8位。这个限制假设在生成每个校验比特的时间余量中最多有三个逻辑电平可用。</li><li>涉及关键控制信号的奇偶校验信号由一个单独的奇偶校验bit定义。单个奇偶校验bit是原始关键控制信号的反转。关键控制信号可能只有较小的时间余量可用。</li><li>对于宽度超过1位的检查信号：<ul><li>检查比特[n]对应于有效payload中的[(8n+7):8n]。</li><li>如果有效payload不是整数个字节，则检查信号的最高有效位覆盖有效payload中少于8位的最高有效部分。</li></ul></li><li>检查信号必须在每个检查使能项为真时正确驱动。请参见 <em><a href="#表 5-1">表 5-1</a></em> 。</li><li>有效payload的所有bit对应的校验信号必须适当地驱动，无论这些bit在传输中是否被使用。例如，<strong>PWDATACHK</strong>的所有bit必须正确驱动，即使某些字节不是有效数据字节。</li><li>如果被检查信号覆盖的一些信号在接口上不存在，则假定缺失的信号为低电平。</li><li>如果被检查信号覆盖的信号在接口上都不存在，则检查信号被省略。</li></ul><h4 id=a-id54-错误检测54-错误检测a><a id="5.4 错误检测">5.4 错误检测</a></h4><p>该规范并不规定在检测到校验错误时组件或系统的行为。
根据系统和受影响的信号，翻转的bit可以产生不同的影响。
它可能是无害的，导致性能问题，导致数据损坏，导致安全违规或死锁。</p><p>当检测到错误时，从机可以：</p><ul><li>终止或传播传输。</li><li>修正奇偶校验信号或传播错误。</li><li>更新其内存或保持不变。</li><li>通过其他方式发出错误响应，例如通过中断。</li></ul><h4 id=a-id55-校验检查信号55-校验检查信号a><a id="5.5 校验检查信号">5.5 校验检查信号</a></h4><p>检查信号与<strong>PCLK</strong>同步，并且必须在检查使能项为真时的每个周期都被正确驱动。</p><p><em><a href="#表 5-1">表 5-1</a></em> 显示了奇偶校验检查信号。</p><p><a id="表 5-1">表 5-1</a> 奇偶校验检查信号</p><table><thead><tr><th>check信号</th><th>相关联的信号</th><th>位宽</th><th>颗粒度</th><th>check使能</th></tr></thead><tbody><tr><td><strong>PADDRCHK</strong></td><td><strong>PADDR</strong></td><td>ceil(ADDR_WIDTH/8)</td><td>1-8</td><td><strong>PSEL</strong></td></tr><tr><td><strong>PCTRLCHK</strong></td><td><strong>PPROT</strong>、<strong>PWRITE</strong>、<strong>PNSE</strong></td><td>1</td><td>1-5</td><td><strong>PSEL</strong></td></tr><tr><td><strong>PSELxCHK</strong></td><td><strong>PSELx</strong></td><td>1</td><td>1</td><td><strong>PRESETn</strong></td></tr><tr><td><strong>PENABLECHK</strong></td><td><strong>PENABLE</strong></td><td>1</td><td>1</td><td><strong>PSEL</strong></td></tr><tr><td><strong>PWDATACHK</strong></td><td><strong>PWDATA</strong></td><td>DATA_WIDTH/8</td><td>8</td><td><strong>PSELx</strong>&<strong>PWRITE</strong></td></tr><tr><td><strong>PSTRBCHK</strong></td><td><strong>PSTRB</strong></td><td>1</td><td>1-4</td><td><strong>PSELx</strong>&<strong>PWRITE</strong></td></tr><tr><td><strong>PREADYCHK</strong></td><td><strong>PREADY</strong></td><td>1</td><td>1</td><td><strong>PSELx</strong>&<strong>PENABLE</strong></td></tr><tr><td><strong>PRDATACHK</strong></td><td><strong>PRDATA</strong></td><td>DATA_WIDTH/8</td><td>8</td><td><strong>PSEL</strong>&<strong>PENABLE</strong>&<strong>PREADY</strong>&!<strong>PWRITE</strong></td></tr><tr><td><strong>PSLVERRCHK</strong></td><td><strong>PSLVERR</strong></td><td>1</td><td>1</td><td><strong>PSEL</strong>&<strong>PENABLE</strong>&<strong>PREADY</strong></td></tr><tr><td><strong>PWAKEUPCHK</strong></td><td><strong>PWAKEUP</strong></td><td>1</td><td>1</td><td><strong>PRESETn</strong></td></tr><tr><td><strong>PAUSERCHK</strong></td><td><strong>PAUSER</strong></td><td>ceil(USER_REQ_WIDTH/8)</td><td>1-8</td><td><strong>PSELx</strong></td></tr><tr><td><strong>PWUSERCHK</strong></td><td><strong>PAUSER</strong></td><td>ceil(USER_DATA_WIDTH/8</td><td>1-8</td><td><strong>PSELx</strong>&<strong>PWRITE</strong></td></tr><tr><td><strong>PRUSERCHK</strong></td><td><strong>PRUSER</strong></td><td>ceil(USER_DATA_WIDTH/8)</td><td>1-8</td><td><strong>PSELx</strong>&<strong>PENABLE</strong>&<strong>PREADY</strong>&!<strong>PWRITE</strong></td></tr><tr><td><strong>PBUSERCHK</strong></td><td><strong>PBUSER</strong></td><td>ceil(USER_RESP_WIDTH/8)</td><td>1-8</td><td><strong>PSELx</strong>&<strong>PENABLE</strong>&<strong>PREADY</strong></td></tr></tbody></table><blockquote><p>Note：ceil()表示对括号内的数值向下取整。
Note：需对PSEL分开检查，是由于只有一个PSEL会路由到每个从机。</p></blockquote><h3 id=a-id附录a-信号有效性附录a-信号有效性a><a id="附录a 信号有效性">附录A 信号有效性</a></h3><p>本附录总结了描述信号何时必须有效的规则</p><h4 id=a-ida1-有效性规则a1-有效性规则a><a id="a.1 有效性规则">A.1 有效性规则</a></h4><p>下面信号必须总是有效：</p><ul><li><strong>PSELx</strong></li><li><strong>PWAKEUP</strong></li></ul><p>当<strong>PSELx</strong>断言（高）时，下面信号必须有效：</p><ul><li><strong>PADDR</strong></li><li><strong>PPROT</strong></li><li><strong>PNSE</strong></li><li><strong>PENABLE</strong></li><li><strong>PWRITE</strong></li><li><strong>PAUSER</strong></li><li><strong>PSTRB</strong></li><li><strong>PWDATA</strong>（只在写传输）</li><li><strong>PWUSER</strong>（只在写传输）</li></ul><p>当<strong>PSELx</strong>和<strong>PENABLE</strong>断言时，下面信号必须有效：</p><ul><li><strong>PREADY</strong></li></ul><p>当<strong>PSELx</strong>、<strong>PENABLE</strong>、<strong>PREADY</strong>断言时，下面信号必须有效：</p><ul><li><strong>PRDATA</strong>(只在读传输)</li><li><strong>PSLVERR</strong></li><li><strong>PRUSER</strong>(只在读传输)</li><li><strong>PBUSER</strong></li></ul><p>建议将不需要为有效的信号驱动为零。</p><h3 id=a-id附录b-信号列表附录b-信号列表a><a id="附录b 信号列表">附录B 信号列表</a></h3><p>本附录提供了APB接口上所有信号的摘要。</p><h4 id=a-idb1-apb信号b1-apb信号a><a id="b.1 apb信号">B.1 APB信号</a></h4><p><em><a href="#表 b-1">表 B-1</a></em> 描述了APB信号的列表。
<em><a href="#表 b-2">表 B-2</a></em> 描述了APB检查信号的列表。可选信号有一个默认值，应用于任何未驱动输入。</p><p><em><a href="#表 b-1">表 B-1</a></em> 和 <em><a href="#表 b-2">表 B-2</a></em> 中使用的以下代码含义是：</p><ul><li>Y： 强制。</li><li>N： 不得存在。</li><li>O： 输入和输出可选。</li><li>OO：对输出端口可选，对输入端口强制。</li><li>C： 条件性的。如果属性为真，则必须存在。</li><li>OC：条件性，可选性。可选性只能在属性为真时存在。</li></ul><p><a id="表 b-1">表 B-1</a> APB信号</p><table><thead><tr><th>signal</th><th>width</th><th>default</th><th>property</th><th>APB5</th><th>apb4</th><th>APB3</th><th>APB2</th></tr></thead><tbody><tr><td><strong>PCLK</strong></td><td>1</td><td>-</td><td>-</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td><strong>PRESETn</strong></td><td>1</td><td>-</td><td>-</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td><strong>PADDR</strong></td><td>ADDR_WIDTH</td><td>-</td><td>-</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td><strong>PPROT</strong></td><td>3</td><td>0b000</td><td>−</td><td>O</td><td>O</td><td>N</td><td>N</td></tr><tr><td><strong>PNSE</strong></td><td>1</td><td>0b0</td><td>RME_Support</td><td>C</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PSELx</strong></td><td>1</td><td>−</td><td>−</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td><strong>PENABLE</strong></td><td>1</td><td>−</td><td>−</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td><strong>PWRITE</strong></td><td>1</td><td>−</td><td>−</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td><strong>PWDATA</strong></td><td>DATA_WIDTH</td><td>−</td><td>−</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td><strong>PSTRB</strong></td><td>DATA_WIDTH/8</td><td>−</td><td>−</td><td>O</td><td>O</td><td>N</td><td>N</td></tr><tr><td><strong>PREADY</strong></td><td>1</td><td>0b1</td><td>−</td><td>OO</td><td>OO</td><td>OO</td><td>N</td></tr><tr><td><strong>PRDATA</strong></td><td>DATA_WIDTH</td><td>0b0</td><td>−</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td><strong>PSLVERR</strong></td><td>1</td><td>0b0</td><td>−</td><td>OO</td><td>OO</td><td>OO</td><td>N</td></tr><tr><td><strong>PWAKEUP</strong></td><td>1</td><td>−</td><td>Wakeup_signal</td><td>C</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PAUSER</strong></td><td>USER_REQ_WIDTH</td><td>−</td><td>USER_REQ_WIDTH</td><td>OC</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PWUSER</strong></td><td>USER_DATA_WIDTH</td><td>−</td><td>USER_DATA_WIDTH</td><td>OC</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PRUSER</strong></td><td>USER_DATA_WIDTH</td><td>−</td><td>USER_DATA_WIDTH</td><td>OC</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PBUSER</strong></td><td>USER_RESP_WIDTH</td><td>−</td><td>USER_RESP_WIDTH</td><td>OC</td><td>N</td><td>N</td><td>N</td></tr></tbody></table><p><a id="表 b-2">表 B-2</a> 检查信号</p><table><thead><tr><th>signal</th><th>width</th><th>property</th><th>APB5</th><th>apb4</th><th>APB3</th><th>APB2</th></tr></thead><tbody><tr><td><strong>PADDRCHK</strong></td><td>ADDR_WIDTH/8</td><td>Check_Type</td><td>C</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PCTRLCHK</strong></td><td>1</td><td>Check_Type</td><td>C</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PSELxCHK</strong></td><td>1</td><td>Check_Type</td><td>C</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PENABLECHK</strong></td><td>1</td><td>Check_Type</td><td>C</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PWDATACHK</strong></td><td>DATA_WIDTH/8</td><td>Check_Type</td><td>C</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PSTRBCHK</strong></td><td>1</td><td>Check_Type</td><td>C</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PREADYCHK</strong></td><td>1</td><td>Check_Type</td><td>C</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PRDATACHK</strong></td><td>DATA_WIDTH/8</td><td>Check_Type</td><td>C</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PSLVERRCHK</strong></td><td>1</td><td>Check_Type</td><td>OC</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PWAKEUPCHK</strong></td><td>1</td><td>Check_Type & Wakeup_Signal</td><td>C</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PAUSERCHK</strong></td><td>ceil(USER_REQ_WIDTH/8)</td><td>Check_Type & USER_REQ_WIDTH</td><td>OC</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PWUSERCHK</strong></td><td>ceil(USER_DATA_WIDTH/8)</td><td>Check_Type & USER_DATA_WIDTH</td><td>OC</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PRUSERCHK</strong></td><td>ceil(USER_DATA_WIDTH/8)</td><td>Check_Type & USER_DATA_WIDTH</td><td>OC</td><td>N</td><td>N</td><td>N</td></tr><tr><td><strong>PBUSERCHK</strong></td><td>ceil(USER_RESP_WIDTH/8)</td><td>Check_Type & USER_RESP_WIDTH</td><td>OC</td><td>N</td><td>N</td><td>N</td></tr></tbody></table><p><em><a href=#表b-3>表B-3</a></em> 展示了接口属性</p><p>如果一个条目不是Y，则该接口类型的属性必须为False或未声明</p><p><a id="表 b-3">表 B-3</a> 接口属性</p><table><thead><tr><th>Property</th><th>Issue introduced</th><th>APB5</th><th>APB4</th><th>APB3</th><th>APB2</th></tr></thead><tbody><tr><td>Check_Type</td><td>D</td><td>y</td><td>&mdash;</td><td></td><td></td></tr><tr><td>USER_REQ_WIDTH</td><td>D</td><td>y</td><td>&mdash;</td><td></td><td></td></tr><tr><td>USER_DATA_WIDTH</td><td>D</td><td>y</td><td>&mdash;</td><td></td><td></td></tr><tr><td>USER_RESP_WIDTH</td><td>D</td><td>y</td><td>&mdash;</td><td></td><td></td></tr><tr><td>Wakeup_Signal</td><td>D</td><td>y</td><td>&mdash;</td><td></td><td></td></tr></tbody></table><h3 id=a-id附录c-版本附录c-版本a><a id="附录c 版本">附录C 版本</a></h3><p>本附录描述了本书已发布版本之间的技术变化：</p><p><a id="表 c-1">表 C-1</a> 版本A</p><table><thead><tr><th>变化</th><th>位置</th></tr></thead><tbody><tr><td>第一次发布</td><td>-</td></tr></tbody></table><p><a id="表 c-2">表 C-2</a> 版本B和版本A的区别</p><table><thead><tr><th>变化</th><th>位置</th></tr></thead><tbody><tr><td>增加了信号<strong>PREADY</strong></td><td><em><a href="#表 2-1">表 2-1</a></em></br><em><a href="#3.1 写传输">3.1 写传输</a></em></br><em><a href="#3.3 读传输">3.3 读传输</a></em></br><em><a href="#3.4 error响应">3.4 ERROR响应</a></em></br><em><a href="#第4章 操作状态">第4章 操作状态</a></em></td></tr><tr><td>增加了信号<strong>PSLVERR</strong></td><td><em><a href="#表 2-1">表 2-1</a></em></br><em><a href="#3.4 error响应">3.4 ERROR响应</a></em></td></tr></tbody></table><p><a id="表 c-3">表 C-3</a> 版本C和版本B的区别</p><table><thead><tr><th>变化</th><th>位置</th></tr></thead><tbody><tr><td>新增章节列出了在每次修订该文档时所做的更改。</td><td><em><a href="#附录c b版本">附录C 版本</a></em></td></tr><tr><td>增加了信号<strong>PPROT</strong></td><td><em><a href="#表 2-1">表 2-1</a></em></br><em><a href="#3.5 保护单元支持">3.5 保护单元支持</a></em></td></tr><tr><td>增加了信号<strong>PSTRB</strong></td><td><em><a href="#表 2-1">表 2-1</a></em></br><em><a href="#3.2 脉冲写">3.2 脉冲写</a></em></td></tr></tbody></table><p><a id="表 c-4">表 C-1</a> 版本D和版本C的区别</p><table><thead><tr><th>变化</th><th>位置</th></tr></thead><tbody><tr><td>增加了位宽属性</td><td><em><a href="#2.1 amba apb信号">2.1 AMBA APB信号</a></em></td></tr><tr><td>增加了信号<strong>PWAKEUP</strong></td><td><em><a href="#3.7 唤醒信号">3.7 唤醒信号</a></em></td></tr><tr><td>增加了user信号</td><td><em><a href="#3.8 user信号">3.8 user信号</a></em></td></tr><tr><td>增加了接口校验</td><td><em><a href="#第5章 奇偶校验接口保护">第5章 奇偶校验接口保护</a></em></td></tr><tr><td>规范化术语，使用Completer和Requester</td><td>整个规范</td></tr><tr><td>增加了信号有效性规则</td><td><em><a href="#附录a 信号有效性">附录A 信号有效性</a></em></td></tr><tr><td>增加了信号汇总</td><td><em><a href="#附录b 信号列表">附录B 信号列表</a></em></td></tr></tbody></table><p><a id="表 c-5">表 C-1</a> 版本E和版本D的区别</p><table><thead><tr><th>变化</th><th>位置</th></tr></thead><tbody><tr><td>加入了对RME的支持</td><td><em><a href="#3.6 realm管理扩展，rme">3.6 Realm管理扩展，RME</a></em></td></tr></tbody></table><hr><ul class=pager><li class=previous><a href=/icer/post/amba5-apb-%E7%9F%A5%E8%AF%86%E6%8F%90%E7%BA%B2/ data-toggle=tooltip data-placement=top title="AMBA5 APB 知识提纲">&larr;
Previous Post</a></li><li class=next><a href=/icer/post/amba5-ahb-%E7%9F%A5%E8%AF%86%E6%8F%90%E7%BA%B2/ data-toggle=tooltip data-placement=top title="AMBA5 AHB 知识提纲">Next
Post &rarr;</a></li></ul><script src=https://giscus.app/client.js data-repo=ICJJ/icer data-repo-id=R_kgDOMWEQRg data-category=General data-category-id=DIC_kwDOMWEQRs4CgyrH data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=light data-lang=en crossorigin=anonymous async></script></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=/tags/>FEATURED TAGS</a></h5><div class=tags><a href=/icer/tags/ahb title=ahb>ahb
</a><a href=/icer/tags/amba title=amba>amba
</a><a href=/icer/tags/amba5 title=amba5>amba5
</a><a href=/icer/tags/apb title=apb>apb
</a><a href=/icer/tags/axi title=axi>axi
</a><a href=/icer/tags/blog title=blog>blog
</a><a href=/icer/tags/bus title=bus>bus
</a><a href=/icer/tags/cache title=cache>cache
</a><a href=/icer/tags/ddr title=ddr>ddr
</a><a href=/icer/tags/git title=git>git
</a><a href=/icer/tags/html title=html>html
</a><a href=/icer/tags/i2c title=i2c>i2c
</a><a href=/icer/tags/ic%E9%AA%8C%E8%AF%81 title=ic验证>ic验证
</a><a href=/icer/tags/multi-layer-ahb title=multi-layer-ahb>multi-layer-ahb
</a><a href=/icer/tags/nxp title=nxp>nxp
</a><a href=/icer/tags/spi title=spi>spi
</a><a href=/icer/tags/uart title=uart>uart
</a><a href=/icer/tags/%E4%B8%B2%E5%8F%A3 title=串口>串口
</a><a href=/icer/tags/%E5%8D%8F%E8%AE%AE%E7%BF%BB%E8%AF%91 title=协议翻译>协议翻译
</a><a href=/icer/tags/%E5%A4%A7%E5%B0%8F%E7%AB%AF title=大小端>大小端
</a><a href=/icer/tags/%E5%AD%97%E8%8A%82%E5%BA%8F title=字节序>字节序
</a><a href=/icer/tags/%E7%9F%A5%E8%AF%86%E6%8F%90%E7%BA%B2 title=知识提纲>知识提纲</a></div></section><section><hr><h5>FRIENDS</h5><ul class=list-inline><li><a target=_blank href=https://zhaozhihan.com>Linda的博客</a></li></ul></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:chengjj9527@gmail.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/icjj><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/ICJJ><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-gitlab fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://stackoverflow.com/users/26381389><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i></span></a></li><li><a href rel=alternate type=application/rss+xml title="ICJJ Blog"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; ICJJ Blog 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> by <a href=https://zhaohuabing.com>Huabing</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){t=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),n=$(this).text(),i=$('<a href="'+o+'" rel="nofollow">'+n+"</a>"),s=$('<li class="'+t+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/icer/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script><script src=https://cdn.jsdelivr.net/gh/jmnote/plantuml-encoder@1.2.4/dist/plantuml-encoder.min.js integrity="sha256-Qsk2KRBCN5qVZX7B+8+2IvQl1Aqc723qV1tBCQaVoqo=" crossorigin=anonymous></script><script>(function(){let e="language-plantuml";Array.prototype.forEach.call(document.querySelectorAll("[class^="+e+"]"),function(e){let t=document.createElement("IMG");t.loading="lazy",t.src="http://www.plantuml.com/plantuml/svg/~1"+plantumlEncoder.encode(e.innerText),e.parentNode.parentNode.insertBefore(t,e.parentNode),e.parentNode.style.display="none"})})()</script></body></html>