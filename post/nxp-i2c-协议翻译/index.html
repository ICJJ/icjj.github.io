<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="ICJJ Blog"><meta property="og:type" content="article"><meta property="og:image" content="img/site/小米汽车/原型车壁纸/2880x1280/2880x1280-05.png"><meta property="twitter:image" content="img/site/小米汽车/原型车壁纸/2880x1280/2880x1280-05.png"><meta name=title content="NXP I2C 协议翻译"><meta property="og:title" content="NXP I2C 协议翻译"><meta property="twitter:title" content="NXP I2C 协议翻译"><meta name=description content="NXP I2C的协议翻译"><meta property="og:description" content="NXP I2C的协议翻译"><meta property="twitter:description" content="NXP I2C的协议翻译"><meta property="twitter:card" content="summary"><meta name=keyword content="程建军, chengjianjun, ChengJianjun, , 程建军的网络日志, 程建军的博客, ChengJianjun Blog, 博客, 个人网站, AMBA, FPGA, SPINALHDL, PCIE"><link rel="shortcut icon" href=/icer/img/site/favicon.ico><title>NXP I2C 协议翻译 | 程建军的博客 | ChengJianjun Blog</title>
<link rel=canonical href=/icer/post/nxp-i2c-%E5%8D%8F%E8%AE%AE%E7%BF%BB%E8%AF%91/><link rel=stylesheet href=/icer/css/bootstrap.min.css><link rel=stylesheet href=/icer/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/icer/css/zanshang.css><link rel=stylesheet href=/icer/css/font-awesome.all.min.css><script src=/icer/js/jquery.min.js></script><script src=/icer/js/bootstrap.min.js></script><script src=/icer/js/hux-blog.min.js></script><script src=/icer/js/lazysizes.min.js></script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-FWR2FVFK68"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FWR2FVFK68")}</script><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=/icer>ICJJ Blog</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/icer>Posts</a></li><li><a href=/icer/categories/bus/>bus</a></li><li><a href=/icer/categories/tech/>tech</a></li><li><a href=/icer/categories/tips/>tips</a></li><li><a href=/icer/archive/>ARCHIVE</a></li><li><a href=/icer/about/>ABOUT</a></li><li><a href=/icer/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/icer/img/site/%e5%b0%8f%e7%b1%b3%e6%b1%bd%e8%bd%a6/%e5%8e%9f%e5%9e%8b%e8%bd%a6%e5%a3%81%e7%ba%b8/2880x1280/2880x1280-05.png)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags><a class=tag href=/tags/nxp title=NXP>NXP
</a><a class=tag href=/tags/i2c title=I2C>I2C
</a><a class=tag href=/tags/%E5%8D%8F%E8%AE%AE%E7%BF%BB%E8%AF%91 title=协议翻译>协议翻译
</a><a class=tag href=/tags/%E4%B8%B2%E5%8F%A3 title=串口>串口</a></div><h1>NXP I2C 协议翻译</h1><h2 class=subheading></h2><span class=meta>Posted by
程建军
on
Tuesday, April 23, 2024</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><h1 id=nxp-i2c协议翻译>NXP I2C协议翻译</h1><h2 id=i2c-总线规范和用户手册翻译>I2C 总线规范和用户手册翻译</h2><blockquote><p><a href=https://icjj.github.io/icer/document/UM10204.pdf>UM10204.pdf</a></p></blockquote><p>文档信息</p><ul><li><p>keywords：</br>I2C, I2C-bus, Standard-mode, Fast-mode, Fast-mode Plus, Fm+, UltraFast-mode,
UFm, High Speed, Hs, inter-IC, SDA, SCL, USDA, USCL</p></li><li><p>摘要：</br>飞利浦半导体（现为恩智浦半导体）开发了一种简单的双向2线总线，用于高效的芯片间控制，称为芯片间总线或I2C（Inter-Integrated Circuit）总线。
只需要两条总线线：一条串行数据线（SDA）和一条串行时钟线（SCL）。
在标准模式下，可以以高达100 kbit/s的速度进行串行8位导向的双向数据传输。
在快速模式下可达到400 kbit/s，在快速加模式（Fm+）下可达到1 Mbit/s，或者在高速模式下可达到3.4 Mbit/s。
超快速模式是一种单向模式，数据传输速度可高达5 Mbit/s。</p></li></ul><p><a id="表 1">表 1</a> 版本历史</p><table><thead><tr><th>版本</th><th>时间</th><th>描述</th></tr></thead><tbody><tr><td>Original</td><td>1982</td><td>初次发布。</td></tr><tr><td>v1.0</td><td>1992</td><td>I2C版本1.0。</td></tr><tr><td>v2.0</td><td>1998</td><td>I2C总线已成为一种事实上的世界标准，目前在超过1000种不同的集成电路中实施，并已授权给50多家公司。然而，今天的许多应用需要<strong>更高的总线速度和更低的供电电压</strong>。这一更新版本的I2C总线规范满足了这些要求</td></tr><tr><td>v2.1</td><td>2000</td><td>I2C版本2.1。</td></tr><tr><td>v3.0</td><td>20070619</td><td>许多现代应用程序需要更长的总线和/或更快的速度。为了满足这一需求，推出了<strong>快速加模式（Fast-mode Plus）</strong>，它通过提高多达10倍的驱动强度并将数据速率提高到1 Mbit/s，同时保持向下兼容<strong>快速模式（Fast-mode）</strong>和<strong>标准模式（Standard-mode）</strong>的速度和软件命令。</td></tr><tr><td>v4.0</td><td>20120213</td><td>I2C版本4.0。</td></tr><tr><td>v5.0</td><td>20121009</td><td>I2C版本5.0。</td></tr><tr><td>v6.0</td><td>20140404</td><td>I2C版本6.0。</br>重新计算了 <em><a href="#图 41">图 41</a></em> 和 <em><a href="#图 42">图 42</a></em> 。</td></tr><tr><td>v7.0</td><td>20211001</td><td>I2C版本7.0.</br>更新了 <em><a href="#表 5">表 5</a></em> 。</br>将这个文档的<code>master/slave</code>更新为<code>controller/target</code>以符合MIPI I3C规范和NXP的包容性语言项目。</br>增加了 <em><a href="#第9章 mipi i3c概述">第9章 MIPI I3C概述</a></em></td></tr></tbody></table><p>本规范包含了以下章节：</p><ul><li><em><a href="#第1章 介绍">第1章 介绍</a></em></li><li><em><a href="#第2章 i2c总线功能">第2章 I2C总线功能</a></em></li><li><em><a href="#第3章 i2c总线协议">第3章 I2C总线协议</a></em></li><li><em><a href="#第4章 i2c总线协议的其他用途">第4章 I2C总线协议的其他用途</a></em></li><li><em><a href="#第5章 i2c总线速度">第5章 I2C总线速度</a></em></li><li><em><a href="#第6章 io阶段和总线线路的电气规格及时序">第6章 IO阶段和总线线路的电气规格及时序</a></em></li><li><em><a href="#第7章 i2c总线设备的电气连接到总线线路">第7章 I2C总线设备的电气连接到总线线路</a></em></li><li><em><a href="#第8章 缩写">第8章 缩写</a></em></li><li><em><a href="#第9章 mipi i3c概述">第9章 MIPI I3C概述</a></em></li><li><em><a href="#第10章 法律信息">第10章 法律信息</a></em></li><li><em><a href=#表格>表格</a></em></li><li><em><a href=#图片>图片</a></em></li><li><em><a href=#目录>目录</a></em></li></ul><h3 id=a-id第1章-介绍第1章-介绍a><a id="第1章 介绍">第1章 介绍</a></h3><p>I2C总线是一个世界标准的总线，目前已在超过1000种由50多家公司生产的不同集成电路中实施。
此外，通用I2C总线还用于各种控制架构，
如系统管理总线( System Management Bus - SMBus)、
电源管理总线(Power Management Bus - PMBus)、
智能平台管理接口(Intelligent Platform Management Interface - IPMI)、
显示数据通道( Display Data Channel - DDC)和
先进电信计算架构(Advanced Telecom Computing Architecture - ATCA)。</p><p>本文帮助设备和系统设计师理解I2C总线的工作原理，并实现一个可行的应用程序。
描述了各种操作模式。它包含了对I2C总线数据传输、握手和总线仲裁方案的全面介绍。
细节部分涵盖了I2C总线在其每种操作模式下的时序要求和电气规格。</p><p>I2C兼容芯片的设计师应该将本文档作为参考，并确保新设备满足本文档中规定的所有限制。
包含I2C设备的系统设计师应审查本文档，并参考各个组件的数据手册。</p><p>寻求开发基于I2C解决方案的读者也可能对I3C感兴趣，I3C由MIPI联盟于2017年推出，并得到了NXP的参与和贡献。
MIPI I3C提供了与I2C的向后兼容性，具有更高的速度和更低的功耗，并且为实施者提供了无 royalties 的版本。
更多信息请见 <em><a href="#第9章 mipi i3c概述">第9章 MIPI I3C概述</a></em>。</p><h3 id=a-id第2章-i2c总线功能第2章-i2c总线功能a><a id="第2章 i2c总线功能">第2章 I2C总线功能</a></h3><p>在消费电子、电信和工业电子领域，似乎不相关的设计之间常常有许多相似之处。例如，几乎每个系统都包括：</p><ul><li>智能控制，通常是单片微控制器</li><li>通用电路，如LCD和LED驱动器、远程I/O端口、RAM、EEPROM、RTC时钟或A/D和D/A转换器</li><li>应用导向电路，如无线电和视频系统的数字调谐和信号处理电路、温度传感器和智能卡。</li></ul><p>为了利用这些相似性来造福系统设计师和设备制造商，并最大化硬件效率和电路简单性，
飞利浦半导体（现为 NXP 半导体）开发了一种简单的双向两线总线，用于IC间高效控制。
这种总线被称为I2C或I2C总线。所有与I2C总线兼容的设备都包含一个片上接口，使它们能够通过I2C总线直接相互通信。
这种设计概念解决了在设计数字控制电路时遇到的许多接口问题。</p><p>以下是 I2C 总线的一些特性：</p><ul><li>只需两个总线；一条串行数据线（serial data - <strong>SDA</strong>）和一条串行时钟线（serial clock - <strong>SCL</strong>）。</li><li>连接到总线的每个设备都可以通过唯一地址进行软件寻址，并且在任何时候都存在简单的主从机关系；
主机可以作为主机发送端或从机接收器端。</li><li>它是一个真正的多控制器总线，包括冲突检测和仲裁，以防止在两个或多个控制器同时发起数据传输时数据损坏。</li><li>串行、8位导向的双向数据传输有多重传输速度：<ul><li>标准模式下可达到100 kbit/s，</li><li>在快速模式下可达到400 kbit/s，</li><li>在快速模式加强版中可达到1 Mbit/s，</li><li>在高速模式下可达到3.4 Mbit/s。</li><li>在超快速模式下可达到5 Mbit/s。</li></ul></li><li>片上滤波器可以抑制总线数据线上的尖峰，以保持数据完整性。</li><li>可连接到同一总线的IC数量仅受最大总线电容的限制。在某些条件下可能允许更大的电容。请参阅 <em><a href="#7.2 超出最大允许电容运行">7.2 超出最大允许电容运行</a></em> 。</li></ul><p><em><a href="#图 1">图 1</a></em> 显示了I2C总线应用的示例。</p><p><a id="图 1">图 1
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_1._Example_of_I2C-bus_applications.png alt></a></p><h4 id=a-id12-设计优势12-设计优势a><a id="1.2 设计优势">1.2 设计优势</a></h4><p>I2C总线兼容的电路让系统设计能够迅速从功能框图转向原型。
此外，由于它们直接嵌入在I2C总线上，不需要任何额外的外部接口，
它们允许原型系统通过简单地嵌入或非嵌入行为电路来修改或升级。
以下是一些I2C总线兼容电路对设计师特别有吸引力的特点：</p><ul><li>功能块在框图上的对应实际的电路；设计可以迅速从框图转向最终原理图。</li><li>不需要设计总线接口，因为I2C总线接口已经集成在芯片上。</li><li>集成地址和数据传输协议允许系统完全基于软件定义。</li><li>相同的电路类型通常可以用于许多不同的应用。</li><li>设计时间减少，因为设计师迅速熟悉I2C总线兼容IC所代表的常用功能模块</li><li>电路可以在不影响总线上其他电路的情况下添加或移除。</li><li>故障诊断和调试简单；故障可以立即追踪。</li><li>通过组装可重用软件模块的库，可以减少软件开发时间。</li></ul><p>除了这些优点，
I2C总线兼容范围内的CMOS电路为设计师提供了特别适合便携设备和电池供电系统的特殊功能。<br>它们都具有：</p><ul><li>极低的电流消耗。</li><li>高抗噪声能力。</li><li>宽供电电压范围。</li><li>宽工作温度范围。</li></ul><h4 id=a-id12-制造优势12-制造优势a><a id="1.2 制造优势">1.2 制造优势</a></h4><p>I2C总线兼容的电路不仅帮助设计师，它们还给设备制造商带来广泛的好处，因为：</p><ul><li>简单的2线串行I2C总线最小化了互连，因此集成电路的引脚更少，PCB走线也没有那么多；
这样的结果就是——更小且更便宜的PCB。</li><li>完全集成的I2C总线协议消除了对地址解码器和其他“粘合逻辑”的需求。</li><li>I2C总线的多控制器能力允许通过与生产线的外部连接快速测试和校准终端设备。</li><li>各种无引脚封装中可用的I2C总线兼容电路进一步减少了空间需求。</li></ul><p>这些只是一些好处。
此外，I2C总线兼容的电路通过允许简单构建设备变体和易于升级模型来保持设计的最新性， 从而增加了系统设计的灵活性。
通过这种方式，可以围绕基本模型开发整个设备系列。
新设备或增强功能型号（即扩展内存、遥控等）的升级可以通过简单地将适当的集成电路嵌入在总线上来生产。
如果需要更大的ROM，只需从我们全面的产品范围中选择一个具有更大ROM的微控制器即可。
随着新的电路取代旧的电路，可以通过简单地将过时的电路从总线上卸下并更换新的电路来轻松为设备添加新功能或提高其性能。</p><h4 id=a-id13-ic设计优势13-ic设计优势a><a id="1.3 ic设计优势">1.3 IC设计优势</a></h4><p>微控制器的设计师常常面临保留输出引脚的压力。
I2C协议允许连接各种外设，而无需单独的地址或芯片使能信号。
此外，包含I2C接口的微控制器在市场上更具竞争力，因为有丰富的现有外设可供选择。</p><h3 id=a-id第3章-i2c总线协议第3章-i2c总线协议a><a id="第3章 i2c总线协议">第3章 I2C总线协议</a></h3><h4 id=a-id31-标准模式快速模式和快速加模式的i2c总线协议31-标准模式快速模式和快速加模式的i2c总线协议a><a id="3.1 标准模式、快速模式和快速加模式的I2C总线协议">3.1 标准模式、快速模式、和快速加模式的I2C总线协议</a></h4><p>串行数据（<strong>SDA</strong>）和串行时钟（<strong>SCL</strong>）在连接到总线的设备之间传递信息。
每个设备都有一个唯一的地址（无论它是微控制器、LCD驱动器、内存还是键盘接口），
并且可以根据设备的功能，作为发送器或接收器工作。LCD驱动器可能仅作为接收器，而内存既可以接收数据也可以发送数据。
除了发送器和接收器，设备在进行数据传输时也可以被视为主机或从机（见 <em><a href="#表 2">表 2</a></em> ）。
主机是发起总线上数据传输的设备，并生成时钟信号以允许该传输。
在此时，任何被寻址的设备都被视为从机。</p><p><a id="表 2">表 2</a> I2C总线术语描述</p><table><thead><tr><th>术语</th><th>描述</th></tr></thead><tbody><tr><td>发送端</td><td>这个设备将数据发送到总线上。</td></tr><tr><td>接收端</td><td>这个设备从总线上接收数据。</td></tr><tr><td>主机（Controller）</td><td>这个设备主动发起传输，产生时钟以及终止传输</td></tr><tr><td>从机（Target）</td><td>这个设备由主机进行控制</td></tr><tr><td>多主机</td><td>多个控制器可以尝试同时控制总线而不会破坏信息。</td></tr><tr><td>仲裁</td><td>确保如果多个控制器同时尝试控制总线，则只允许一个控制器进行控制，并且传输消息不被损坏的程序。</td></tr><tr><td>同步</td><td>同步两个或更多设备时钟信号的程序。</td></tr></tbody></table><p>I2C总线是一个多主机总线。
这意味着可以连接多个能够控制总线的设备。
由于主机通常是微控制器，<em><a href="#图 2">图 2</a></em> 考虑了两个连接到I2C总线的微控制器之间数据传输的情况。</p><p><a id="图 2">图 2
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_2._Example_of_an_I2C-bus_configuration_using_two_microcontrollers.png alt></a></p><p>这个例子突出了在I2C总线上的主机-从机和接收端-发送端关系。
请注意，这些关系不是永久的，而是仅取决于当时的数据传输方向。数据传输将按照以下方式进行：</p><ol><li>假设微控制器A想要向微控制器B发送信息：<ul><li>微控制器A（主机）寻址微控制器B（从机）；</li><li>微控制器A（主机作为发送端）向微控制器B（从机作为接收端）发送数据；</li><li>微控制器A（主机）终止传输。</li></ul></li><li>如果微控制器A想要接收微控制器B的信息：<ul><li>微控制器A（主机）寻址微控制器B（从机）；</li><li>微控制器A（主机作为接收端）从微控制器B（从机作为发送端）接收数据。</li><li>微控制器A（主机）终止传输。</li></ul></li></ol><p>即使在这种情况下，主机（微控制器 A）也会生成时序并终止传输。</p><p>将多个微控制器连接到I2C总线意味着多个主机可能会试图同时发起数据传输。
为避免随之而来的混乱，已经制定了一种仲裁程序。
该程序依赖于所有I2C接口并通过I2C总线的线与连接。</p><p>如果两个或更多主机试图将信息放入总线，首先发送bit “1”的主机在另一个主机发送bit “0”时将输掉仲裁。
在仲裁期间的时钟信号是由主机通过线与连接到<strong>SCL</strong>线生成时钟的同步组合（有关仲裁的更详细信息，
请参见 <em><a href="#3.1.8 仲裁">3.1.8 仲裁</a></em> ）。</p><p>在I2C总线上生成时钟信号始终是主机设备的责任；每个主机在总线上传输数据时生成自己的时钟信号。
来自主机的总线时钟信号仅在被慢速从机拉伸或在发生仲裁时由另一个主机占有时被改变。</p><p><em><a href="#表 3">表 3</a></em> 总结了I2C总线规格中强制和可选部分的使用情况以及哪些系统配置使用它们。</p><p><a id="表 3">表 3</a> I2C总线功能适用性</br>M = 强制的；O=可选的；n/a=不适用。</p><table><thead><tr><th>功能</th><th>配置：</br>单主机</th><th>配置：</br>多主机</th><th>配置：</br>从机<sup><em><a href=#[3-1]>[3-1]</a></em></sup></th></tr></thead><tbody><tr><td>START condition</td><td>M</td><td>M</td><td>M</td></tr><tr><td>STOP condition</td><td>M</td><td>M</td><td>M</td></tr><tr><td>Acknowledge</td><td>M</td><td>M</td><td>M</td></tr><tr><td>Synchronization</td><td>n/a</td><td>M</td><td>n/a</td></tr><tr><td>Arbitration</td><td>n/a</td><td>M</td><td>n/a</td></tr><tr><td>Clock stretching</td><td>O <sup><em><a href=#[3-2]>[3-2]</a></em></sup></td><td>O <sup><em><a href=#[3-2]>[3-2]</a></em></sup></td><td>O</td></tr><tr><td>7-bit target address</td><td>M</td><td>M</td><td>M</td></tr><tr><td>10-bit target address</td><td>O</td><td>O</td><td>O</td></tr><tr><td>General Call address</td><td>O</td><td>O</td><td>O</td></tr><tr><td>Software Reset</td><td>O</td><td>O</td><td>O</td></tr><tr><td>START byte</td><td>n/a</td><td>O <sup><em><a href=#[3-3]>[3-3]</a></em></sup></td><td>n/a</td></tr><tr><td>Device ID</td><td>n/a</td><td>n/a</td><td>O</td></tr></tbody></table><p><a id=[3-1]>[3-]</a> :也指一个作为目标的控制器。</p><p><a id=[3-2]>[3-2]</a> :时钟拉伸是某些从机的一个特性。如果系统中没有从机可以拉伸时钟
（保持<strong>SCL</strong>低），主机就不需要设计来处理这个程序。</p><p><a id=[3-3]>[3-3]</a> : “位翻转”（软件仿真）多主机系统应考虑一个启动字节，
参见 <em><a href="#3.1.15 start字节">3.1.15 START字节</a></em></p><h5 id=a-id311-sda和scl信号311-sda和scl信号a><a id="3.1.1 sda和scl信号">3.1.1 SDA和SCL信号</a></h5><p><strong>SDA</strong>和<strong>SCL</strong>都是双向线路，
通过电流源或上拉电阻连接到正电源电压（见 <em><a href="#图 3">图 3</a></em> ）。
当总线空闲时，两条线路都是高电平。连接到总线的设备输出级必须具有开漏 <sup><em><a href=#[3-4]>[3-4]</a></em> </sup>或开集电极 <sup><em><a href=#[3-5]>[3-5]</a></em> </sup>以执行线与功能。
I2C总线上的数据可以在标准模式下以高达100 kbit/s的速度传输，在快速模式下以高达400 kbit/s的速度传输，
在快速加模式下以高达1 Mbit/s的速度传输，或在高速模式下以高达3.4 Mbit/s的速度传输。
总线电容限制了连接到总线的接口数量。</p><p>对于单个主机系统，如果总线上没有会拉伸时钟的设备，则控制器的<strong>SCL</strong>输出可以是推挽 <sup><em><a href=#[3-5]>[3-5]</a></em> </sup>驱动器设计。</p><p><a id=[3-4]>[3-4]</a> ：开漏（open-drain）配置依赖一个单一的场效应管（通常是nMOSFET）。
当该晶体管导通时，输出引脚被拉至地（低电平），当其关闭时，输出引脚则处于浮空状态（未连接）。
为了避免输出引脚在关闭时处于不确定状态，通常会通过上拉电阻将引脚拉至高电平。
由于较强的电流能力、较低的导通电阻和较低的功耗常选用open-drain的方式驱动i2c。</p><p><a id=[3-5]>[3-5]</a> ：开集（open-collector）配置依赖一个单一的双极性晶体管（通常是BJT），
当基极有电流时，开关导通，输出连接低电平；
当基极没有电流时，开关关闭，输出悬空。
在开关关闭时接上拉电阻将引脚接到高电平。本身无法提供源电流，需要外部电路提供。</p><p><a id=[3-5]>[3-5]</a> ：push-pull配置需要两个晶体管（MOSFET或BJT），一个用来将输出拉高（到电源电压），另一个用来将输出拉低（到地）。
多主从结构，由于线与的仲裁机制，可能会损坏设备。只推荐在单主从结构中使用。</p><p><a id="图 3">图 3
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_3._Devices_with_various_supply_voltages_sharing_the_same_bus.png alt></a></p><h5 id=a-id312-sda和scl逻辑电平312-sda和scl逻辑电平a><a id="3.1.2 sda和scl逻辑电平">3.1.2 SDA和SCL逻辑电平</a></h5><p>由于连接到I2C总线不同技术设备（CMOS，NMOS，双极型）的多样性，逻辑‘0’（低）和‘1’（高）的电平不是固定的，而是依赖于V<sub>DD</sub>的相关电平。
输入参考电平设置为V<sub>DD</sub>的30%和70%；V<sub>IL</sub>为0.3V<sub>DD</sub>，V<sub>IH</sub>为0.7V<sub>DD</sub>。请参见 <em><a href="#图 38">图 38</a></em> 的时序图。
一些旧设备的输入电平固定为V<sub>IL</sub> = 1.5 V和V<sub>IH</sub> = 3.0 V，但所有新设备都要求采用此30%/70%的规范。
有关电气规范，请参见 <em><a href="#第6章 io阶段和总线线路的电气规格及时序">第6章 IO阶段和总线线路的电气规格及时序</a></em> 。</p><h5 id=a-id313-数据有效性313-数据有效性a><a id="3.1.3 数据有效性">3.1.3 数据有效性</a></h5><p>在时钟的高电平期间，<strong>SDA</strong>线上的数据必须保持稳定。
数据线的高或低状态只能在SCL线上的时钟信号为低时改变（见 <em><a href="#图 4">图 4</a></em> ）。
每传输一个数据位，都会生成一个时钟脉冲。</p><p><a id="图 4">图 4
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_4._Bit_transfer_on_the_I2C-bus.png alt></a></p><h5 id=a-id314-start和stop的条件314-start和stop的条件a><a id="3.1.4 start和stop的条件">3.1.4 START和STOP的条件</a></h5><p>所有事务都以START(S)开始，并以STOP(P)结束(见 <em><a href="#图 5">图 5</a></em> )。
在<strong>SCL</strong>为高电平时，<strong>SDA</strong>线上的高到低的转换定义了START条件。
在<strong>SCL</strong>为高电平时，<strong>SDA</strong>线上的低到高的转换定义了STOP条件。</p><p><a id="图 5">图 5
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_5._START_and_STOP_conditions.png alt></a></p><p>START和STOP条件始终由主机生成。
在START条件之后，总线被视为繁忙状态。
在STOP条件之后经过一定时间，总线再次被视为空闲状态。
这个总线空闲情况在 <em><a href="#第6章 io阶段和总线线路的电气规格及时序">第6章 IO阶段和总线线路的电气规格及时序</a></em> 中指定。</p><p>如果生成了重复的START（Sr）而不是STOP条件，则总线保持繁忙状态。
在这方面，START（S）和重复的START（Sr）条件功能上是相同的。
因此，在本文档的其余部分，S符号被用作通用术语来表示START和重复的START条件，除非Sr特别相关。</p><p>如果连接到总线的设备包含必要的接口硬件，则检测START和STOP条件很简单。
然而，没有此类接口的微控制器必须至少每个时钟周期对<strong>SDA</strong>线进行两次采样以进行必要的强化采样。</p><h5 id=a-id315-byte-格式315-byte-格式a><a id="3.1.5 byte 格式">3.1.5 Byte 格式</a></h5><p>每个传输在<strong>SDA</strong>线上的字节必须是8位长的。
每次传输可以传输的字节数没有限制。
每个字节后面必须跟一个确认位（ACK/NACK）。
数据以最高有效位(MSB)优先的方式传输(见 <em><a href="#图 6">图 6</a></em> )。
如果从机在执行某些其他功能之前无法接收或传输另一个完整的字节数据，例如处理内部中断，它可以将时钟线SCL保持在低电平，以迫使主机进入等待状态。
当从机准备好接收另一个字节的数据并释放时钟线之后，数据传输将继续。</p><p><a id="图 6">图 6
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_6._Data_transfer_on_the_I2C-bus.png alt></a></p><h5 id=a-id316-ack和nack316-ack和nacka><a id="3.1.6 ack和nack">3.1.6 ACK和NACK</a></h5><p>确认信号在每个字节后发生。确认位允许接收方向发送端发出信号，表示字节已成功接收，可以发送另一个字节。
主机生成所有时钟脉冲，包括确认第九个时钟脉冲。</p><p>确认信号定义如下：</p><ul><li>发送端在确认时钟脉冲期间释放<strong>SDA</strong>线路，以便接收方可以将<strong>SDA</strong>线路拉低（发出ACK信号），并在此时钟脉冲的高电平期间保持稳定的低电平（见 <em><a href="#图 4">图 4</a></em> ）。</li><li>还必须考虑建立时间和保持时间（在 <em><a href="#第6章 io阶段和总线线路的电气规格及时序">第6章 io阶段和总线线路的电气规格及时序</a></em> 中规定）。</li><li>当<strong>SDA</strong>在第九个时钟脉冲期间保持高电平时，这被定义为nack信号。然后，主机可以生成STOP条件以中止传输，或生成START条件以开始新的传输。</li><li>有五种条件会导致NACK信号的生成：<ol><li>在总线上没有具有所传输地址的从机，因此没有从机可以响应ack，<strong>SDA</strong>线默认保持高电平的nack响应。</li><li>从机无法接收或发送，因为它正在执行某些实时功能，尚未准备好与主机进行通信。</li><li>在传输过程中，接收端收到其无法理解的数据或命令。</li><li>在传输过程中，接收端无法再接收更多数据字节。</li><li>主机接收方必须向从机发送端发出传输结束的信号。</li></ol></li></ul><h5 id=a-id317-时钟同步317-时钟同步a><a id="3.1.7 时钟同步">3.1.7 时钟同步</a></h5><p>两个主机可以同时在空闲总线上开始传输，并且必须有一种方法来决定哪个主机控制总线并完成其传输。
这是通过时钟同步和仲裁来实现的。
在单个主机系统中，不需要时钟同步和仲裁。</p><p>时钟同步是通过将I2C接口的<strong>SCL</strong>进行线与实现的。
这意味着<strong>SCL</strong>线上的高到低转换会使相关的主机开始计算它们的低电平周期。
一旦某个主机的时钟变为低电平，它将促使<strong>SCL</strong>线保持该状态，直到时钟达到高电平状态（见 <em><a href="#图 7">图 7</a></em> ）。
然而，如果另一个时钟仍处于其低电平周期内，则该时钟的低到高转换可能不会改变<strong>SCL</strong>线的状态。
因此，<strong>SCL</strong>线由具有最长低电平周期的主机保持在低电平状态。在此期间，低电平周期较短的主机进入高电平等待状态。</p><p><a id="图 7">图 7
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_7._Clock_synchronization_during_the_arbitration_procedure.png alt></a></p><p>当所有相关主机都计算完它们的低电平周期后，时钟线被释放并变为高电平。
此时，主机时钟和<strong>SCL</strong>线的状态没有区别，所有主机开始计重新数它们的高电平周期。</p><p>第一个结束高电平周期的主机再次将<strong>SCL</strong>线拉低。
通过这种方式，生成一个同步的<strong>SCL</strong>时钟，其低电平周期由具有最长低电平周期的主机决定，高电平周期由具有最短高电平周期的的主机决定。</p><h5 id=a-id318-仲裁318-仲裁a><a id="3.1.8 仲裁">3.1.8 仲裁</a></h5><p>仲裁与同步类似，指的是仅在系统中使用多个主机时所需的协议的一部分。
从机在仲裁过程中不参与。只有当总线空闲时，主机才能开始数据传输。
两个主机可能在START条件的最小保持时间(t<sub>HD;STA</sub>)内生成一个START条件，从而在总线上导致有效的START条件。
随后需要进行仲裁，以确定哪个主机将完成其传输。</p><p>仲裁逐位进行。在每一位期间，当<strong>SCL</strong>为高电平时，每个主机检查<strong>SDA</strong>电平是否与其发送的相匹配。
这个过程可能需要许多位。只要传输相同，两个主机实际上可以在没有错误的情况下完成整个传输。
当一个主机第一次尝试发送高电平但发现<strong>SDA</strong>电平为低电平时，该主机知道它已经失去仲裁，并关闭其<strong>SDA</strong>输出驱动器。
另一个主机继续完成其传输。在仲裁过程中没有信息丢失。
失去仲裁的主机可以在失去仲裁的字节结束之前生成时钟脉冲，并在总线空闲时必须重新启动其传输。</p><p>如果一个主机还包含从机功能，并且在寻址阶段失去仲裁，获得总线控制权的主机可能正在尝试寻址它。
因此，失去仲裁的主机必须立即切换到其从机模式。</p><p><em><a href="#图 8">图 8</a></em> 显示了两个主机的仲裁过程。
根据连接到总线的主机数量，可能会涉及更多的主机。
当生成DATA1的主机内部数据电平与SDA线上的实际电平之间存在差异时，DATA1输出会关闭。这不会影响获得总线控制权主机发起的数据传输。</p><p><a id="图 8">图 8
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_8._Arbitration_procedure_of_two_controllers.png alt></a></p><p>由于I2C总线的控制完全由竞争控制器发送的地址和数据决定，因此不存在中央控制器，也没有总线上的优先顺序。
如果仲裁程序在一个主机发送重复的START条件或STOP条件时，另一个主机仍在发送数据时，这将导致一种未定义的状态。
换句话说，以下组合会导致未定义的状态：</p><ul><li>主机1发送重复的START条件，而主机2发送数据位。</li><li>主机1发送STOP条件，而主机2发送数据位。</li><li>主机1发送重复的START条件，而主机2发送STOP条件。</li></ul><h5 id=a-id319-时钟拉伸319-时钟拉伸a><a id="3.1.9 时钟拉伸">3.1.9 时钟拉伸</a></h5><p>时钟拉伸通过将<strong>SCL</strong>线保持在低电平来暂停事务。
在该线路再次释放至高电平之前，传输无法继续。
时钟拉伸是可选的，实际上大多数从机不包含<strong>SCL</strong>驱动器，因此它们无法拉伸时钟。</p><p>在字节级别，设备可能能够以较快的速率接收数据字节，但需要更多时间来存储接收到的字节或准备要传输的另一个字节。
从机可以在接收和确认一个字节后将<strong>SCL</strong>线保持在低电平，以强制主机进入等待状态，直到从机准备好进行下一个字节传输，
这是一种握手过程（见 <em><a href="#图 7">图 7</a></em> ）。</p><p>在比特级别，诸如微控制器的设备，无论是否有用于I2C总线的有限硬件，都可以通过延长每个时钟低电平周期来减慢总线时钟。
任何控制器的速度都适应于该设备的内部操作速率。</p><p>在高速模式下，该握手功能仅可在字节级别使用（见 <em><a href="#5.3.2 高速模式下的串行数据格式">5.3.2 下的串行数据格式</a></em> ）。</p><h5 id=a-id3110-从机地址和rw-bit3110-从机地址和rw-bita><a id="3.1.10 从机地址和rw-bit">3.1.10 从机地址和RW-bit</a></h5><p>数据传输遵循 <em><a href="#图 9">图 9</a></em> 所示的格式。</p><ol><li>启动阶段：发送START条件；</li><li>地址阶段：发送一个从机地址。这个地址可以是7位，也可以选择实现10位的地址；</li><li>方向阶段：发送数据方向位（R/W）——‘0’表示请求写入，‘1’表示请求读取；</li><li>响应阶段：由地址接收方发送一个响应；</li><li>数据发送阶段：8位的地址+一位的响应位；</li><li>停止阶段：</li></ol><p>在START条件（S）之后，发送一个从机地址。这个地址是七位长，
后面跟着第八位，即数据方向位（R/W）——‘0’表示发送数据（写入），‘1’表示请求数据（读取）（参见 <em><a href="#图 10">图 10</a></em> ）。
数据传输总是由主机生成的STOP条件（P）结束。
然而，如果主机仍希望在总线上进行通信，它可以生成重复的START条件（Sr）并在不先生成STOP条件的情况下寻址另一个从机。
在这样的传输中，可能会有各种读/写格式的组合。</p><p><a id="图 9">图 9
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_9._A_complete_data_transfer.png alt></a></p><p><a id="图 10">图 10
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_10._The_first_byte_after_the_START_procedure.png alt></a></p><p>可能的数据传输格式包括：</p><ul><li>主机发送端向从机接收端发送数据。传输方向不变（见 <em><a href="#图 11">图 11</a></em> ）。从机接收端确认每一个字节，发送ack或者nack。</li><li>主机在第一个字节之后立即读取从机（见 <em><a href="#图 12">图 12</a></em> ）。
在第一次确认之后，主机发送端变为主机接收端，从机接收端变为从机发送端。这个第一次确认仍然由从机生成。主机生成后续的确认。
STOP条件由主机生成，主机在STOP条件之前发送一个nack（<span style=text-decoration:overline>A</span>）。</li><li>组合格式（见 <em><a href="#图 13">图 13</a></em> ）。在传输过程中的方向变化时，START条件和从机地址都被重复，但R/W位则反转。
如果主机接收端发送一个重复的START条件，它会在重复的START条件之前发送一个nack（<span style=text-decoration:overline>A</span>）。
注意事项：<ol><li>组合格式可以用于控制串行存储器。内部存储位置必须在第一个数据字节期间写入。在START条件和从机地址重复后，数据可以被传输。</li><li>所有关于自动增量或减量内存地址的决定由设备设计者做出。</li><li>每个字节后面都有一个确认位，如序列中的A或<span style=text-decoration:overline>A</span>所示。</li><li>兼容I2C总线的设备在接收到START或重复START条件时，必须重置其总线逻辑，以便它们都能预期发送从机地址，即使这些START条件并没有按照正确的格式定位。</li><li>一个START条件后紧接着STOP条件（空消息）是一个非法格式。然而，许多设备设计上能够在这种条件下正常工作。</li><li>连接到总线的每个设备都有唯一的地址。通常存在简单的主从关系，但也可以有多个相同的从机能够同时接收和响应，例如在组广播中。
这种技术在使用总线切换设备(如PCA9546A)时效果最佳，其中所有四个通道都打开且相同的设备同时配置，应当理解无法同时确定每个目标是否确认。
需要一次打开一个通道依次读取每个单独设备的配置以确认传输结果。细节请参阅各个组件的数据表。</li></ol></li></ul><p><a id="图 11">图 11
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_11._A_controller-transmitter_addressing_a_target_receiver_with_a_7-bit_address_%28the_transfer_direction_is_not_changed%29.png alt></a></p><p><a id="图 12">图 12
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_12._A_controller_reads_a_target_immediately_after_the_first_byte.png alt></a></p><p><a id="图 13">图 13
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_13._Combined_format.png alt></a></p><h5 id=a-id3111-10-bit地址3111-10-bit地址a><a id="3.1.11 10-bit地址">3.1.11 10-bit地址</a></h5><p>10位寻址扩展了可能的地址数量。设备可以使用7位和10位地址连接到同一个I2C总线。
7位和10位寻址可以在所有总线速度模式下使用。目前10位寻址并未被广泛使用。</p><p>10位从机地址由START条件S或重复START条件Sr后的前两个字节组成。</p><p>第一个字节的前七位是0b1111_0XX组合，其中最后两位XX是10位地址的两个最高有效位。第一个字节的第八位是（R/<span style=text-decoration:overline>w</span>）位用于确定消息的方向。</p><p>虽然保留的地址位0b1111_XXX有八种可能的组合，但只有四种组合的0b1111_0XX用于10位寻址。剩余的四种组合0b1111_1XX保留用于未来I2C总线的增强。</p><p>之前描述的7位寻址的所有读写格式组合在10位寻址中都是可能的。这里详细说明两种：</p><ul><li>主机发送端向10位从机地址的从机接收端发送数据，传输方向不变 <em><a href="#图 14">图 14</a></em> 。
当10位地址跟在START条件后时，每个从机都会将从机地址第一个字节的前七位0b1111_0XX与自己的地址进行比较，并检查第八位（R/<span style=text-decoration:overline>w</span>）方向位是否为0。
可能会有多个从机发现匹配并产生应答A1。所有发现匹配的从机都会将从机地址第二个字节的八位XXXX_XXXX与自己的地址进行比较。
但只有一个从机会发现匹配并产生应答A2，匹配的从机将一直被主机寻址直到它收到STOP条件P或者跟随不同从机地址的重复START条件Sr。</li><li>主机接收端从10位从机地址的从机发送端读取数据，传输方向在第二个（R/<span style=text-decoration:overline>w</span>）位之后改变 <em><a href="#图 15">图 15</a></em> ，
应答位A2的过程与主机发送端第一次寻址从机接收端的过程相同。
在重复START条件Sr之后匹配的从机会记住它之前被寻址过。该从机然后检查Sr之后从机地址第一个字节的前七位是否与从前START条件S之后的相同，
并检查第八位（R/<span style=text-decoration:overline>w</span>）位是否为1，如果匹配，则认为它已被寻址为从机发送端并产生应答A3。
从机发送端将一直被寻址直到它收到STOP条件P或者直到它收到跟随不同从机地址的另一个重复START条件Sr。
在重复START条件Sr之后所有其他从机也将比较从机地址第一个字节的前七位0b1111_0XX与自己的地址，并检查第八位（R/<span style=text-decoration:overline>w</span>）位。
然而它们可能都不会被寻址，因为即使10位从机地址的（R/<span style=text-decoration:overline>w</span>）为1，但0b1111_0XX从机地址对于7位设备不匹配。</li></ul><p>10位地址从机响应通用呼叫地址 <em><a href="#3.1.13 通用呼叫地址">3.1.13 通用呼叫地址</a></em> 的方式与7位地址从机的操作相同。
主机可以在通用呼叫地址之后传输其10位地址。
在这种情况下，通用呼叫地址字节之后跟随两个连续字节，包含主机发送端的10位地址。
格式如 <em><a href="#图 15">图 15</a></em> 所示，其中第一个数据字节包含主机地址的八个位权重最低的位。</p><p>START字节 0b0000_0001（0h1）可以像7位寻址一样位于10位寻址之前（见 <em><a href="#3.1.15 start字节">3.1.15 START字节</a></em> ）。</p><p><a id="图 14">图 14
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_14._A_controller-transmitter_addresses_a_target-receiver_with_a_10-bit_address.png alt></a></p><p><a id="图 15">图 15
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_15._A_controller-receiver_addresses_a_target-transmitter_with_a_10-bit_address.png alt></a></p><h5 id=a-id3112-保留地址3112-保留地址a><a id="3.1.12 保留地址">3.1.12 保留地址</a></h5><p>两组8位地址（0b0000_XXX（R/<span style=text-decoration:overline>w</span>） 和 0b1111_XXX（R/<span style=text-decoration:overline>w</span>））为 <em><a href="#表 4">表 4</a></em> 中显示的目的保留：</p><p><a id="表 4">表 4</a> 保留地址</br>X = 不关心；1 = HIGH；0 = LOW</p><table><thead><tr><th>目标地址</th><th>读写位</th><th>描述</th></tr></thead><tbody><tr><td>0b0000_000</td><td>0</td><td>通用呼叫地址 <sup><em><a href=#[3-7]>[3-7]</a></em></sup></td></tr><tr><td>0b0000_000</td><td>1</td><td>START字节 <sup><em><a href=#[3-8]>[3-8]</a></em></sup></td></tr><tr><td>0b0000_001</td><td>X</td><td>CBUS 地址 <sup><em><a href=#[3-9]>[3-9]</a></em></sup></td></tr><tr><td>0b0000_010</td><td>X</td><td>保留以备不同总线格式 <sup><em><a href=#[3-10]>[3-10]</a></em></sup></td></tr><tr><td>0b0000_011</td><td>X</td><td>保留以备未来使用</td></tr><tr><td>0b0000_1XX</td><td>X</td><td>高速模式主机代码</td></tr><tr><td>0b1111_1XX</td><td>1</td><td>设备ID</td></tr><tr><td>0b1111_0XX</td><td>X</td><td>10位目标寻址</td></tr></tbody></table><p><a id=[3-7]>[3-7]</a> :广播地址用于多个功能，包括软件复位。<br><a id=[3-8]>[3-8]</a> :没有设备可以在接收START字节时进行应答。<br><a id=[3-9]>[3-9]</a> :CBUS一种三线制总线，地址已被保留，以便在同一系统中混合CBUS兼容设备和I2C总线兼容设备。I2C总线兼容设备在接收此地址时不允许响应。<br><a id=[3-10]>[3-10]</a> :为不同总线格式保留的地址是为了允许 I2C 和其他协议的混合。只有能够与此类格式和协议一起工作的 I2C 总线兼容设备才被允许响应此地址。</p><p>在本地系统中地址的分配取决于系统架构师，他们必须考虑总线上使用的设备以及与其他传统I2C总线的任何未来交互。
举例来说，具有七个用户可分配地址引脚的设备允许将所有128个地址分配。
如果已知保留地址将永远不会用于其预定目的，则可以将保留地址用于从机地址。</p><h5 id=a-id3113-通用呼叫地址3113-通用呼叫地址a><a id="3.1.13 通用呼叫地址">3.1.13 通用呼叫地址</a></h5><p>通用呼叫地址用于同时向连接到I2C总线的每个设备发送数据。
然而，如果某个设备不需要通用呼叫中提供的任何数据，则可以通过不发出确认信号来忽略该地址。</p><p>如果设备需要来自通用呼叫地址的数据，它会确认该地址并表现为从机接收端。
如果一个或多个设备响应，主机实际上并不知晓有多少设备已确认。
第二个及后续字节由每个能够处理这些数据的从机接收端确认。
无法处理这些字节之一的从机必须通过nack来忽略它。
再次强调，如果一个或多个从机确认，则主机将看不到nack的信号。通用呼叫地址的含义总是在第二个字节中指定（见 <em><a href="#图 16">图 16</a></em> ）。</p><p><a id="图 16">图 16
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_16._General_call_address_format.png alt></a></p><p>有两种情况需要考虑：</p><ul><li>当最低有效位B为‘0’时，第二个字节的定义如下：<ul><li>0b0000_0110 (0h6)：<strong>硬件重置并写入从机地址的可编程部分</strong>。</br>接收到这个2字节序列后，所有设计为响应通用呼叫地址的设备将被重置并接受它们地址的可编程部分。
必须采取预防措施以确保在施加供电电压后，设备不会拉低<strong>SDA</strong>或<strong>SCL</strong>线，因为这些低电平会阻塞总线。</li><li>0b0000_0100 (0h4)：<strong>通过硬件写入目标地址的可编程部分</strong>。</br>行为与上述相同，但设备不会重置。<br>编程过程的序列已在相应的设备数据表中发布。其余代码尚未固定，设备必须忽略它们。</li><li>0b0000_0000 (0h0)：<strong>此代码不允许作为第二个字节使用</strong>。</li></ul></li><li>当最低有效位 B 为‘1’时：</br><ul><li>2字节序列为‘硬件通用呼叫’。
这意味着该序列是由硬件主机（例如键盘扫描仪）传输的，该设备可以被编程以传输所需的从机地址。
由于主机事先不知道消息要传输到哪个从机，因此它只能生成这个硬件通用呼叫及其自身地址（向系统识别自身）（见 <em><a href="#图 17">图 17</a></em> ）。</li></ul></li></ul><p><a id="图 17">图 17
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_17._Data_transfer_from_a_hardware_controller-transmitter.png alt></a></p><p>第二个字节中剩下的七个位包含该主机的地址。
这个地址被连接到总线的智能设备（例如微控制器）识别，智能设备随后接受来自该主机的信息。
如果该主机也可以充当从机，则从机地址与主机地址相同。</p><p>在某些系统中，另一种选择是主机发送端在系统重置后设置为从机接收模式。
通过这种方式，系统配置主机可以指示主机发送端（现在处于从机接收模式）将数据发送到哪个地址（见 <em><a href="#图 18">图 18</a></em> ）。
在这个编程过程中，主机仍然保持在主机发送模式。</p><p><a id="图 18">图 18
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_18._Data_transfer_by_a_hardware-transmitter_capable_of_dumping_data_directly_to.png alt></a></p><h5 id=a-id3114-软件复位3114-软件复位a><a id="3.1.14 软件复位">3.1.14 软件复位</a></h5><p>根据通用呼叫（0b0000_0000），发送0x0000_0110（0h6）作为第二字节会导致软件复位。
此功能是可选的，并非所有设备都对该命令作出响应。
在接收到这2字节序列后，所有设计为响应通用呼叫地址的设备都会复位，并接受其地址的可编程部分。
必须采取预防措施，以确保在施加电源电压后设备不会拉低<strong>SDA</strong>或<strong>SCL</strong>线，因为这些低电平会阻塞总线。</p><h5 id=a-id3115-start字节3115-start字节a><a id="3.1.15 start字节">3.1.15 START字节</a></h5><p>微控制器可以通过两种方式连接到I2C总线。
具有片上硬件I2C总线接口的微控制器可以被编程为仅接受来自总线的请求被中断。
当设备没有这样的接口时，它必须通过软件不断监控总线。
显然，微控制器监视或轮询总线的次数越多，它用于执行其预期功能的时间就越少。</p><p>因此，依赖软件轮询的相对较慢的微控制器与快速硬件设备之间存在速度差异。</p><p>在这种情况下，数据传输可以通过启动程序来进行，该程序比正常情况要长得多（见 <em><a href="#图 19">图 19</a></em> ）。启动程序由以下内容组成：</p><ul><li>START；</li><li>START字节包（0b0000_0001）；</li><li>ACK脉冲；</li><li>重复的START；</li></ul><p><a id="图 19">图 19
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_19._START_byte_procedure.png alt></a></p><p>在一个需要总线访问的控制器传输了START条件S之后，START字节（0b0000_0001）被传输。
因此，另一个微控制器可以以低采样率对<strong>SDA</strong>线进行采样，直到检测到START字节中的七个零之一。
在检测到<strong>SDA</strong>线上的低电平之后，微控制器可以切换到更高的采样率，以找到重复的START条件Sr，然后用于同步。</p><p>硬件接收端在接收到重复的START条件Sr后重置，因此忽略START字节。</p><p>在START字节之后生成与确认相关的时钟脉冲。这仅存在于与总线上使用的字节处理格式相一致的情况。任何设备都不允许确认START字节。</p><h5 id=a-id3116-总线清除3116-总线清除a><a id="3.1.16 总线清除">3.1.16 总线清除</a></h5><p>在不太可能的情况下，如果时钟（<strong>SCL</strong>）被固定为低电平，如果I2C设备具有硬件复位输入,则优选的步骤是使用硬件复位信号重置总线。
如果I2C设备没有硬件复位输入，则切断设备电源以激活强制性的内部上电复位（POR）电路。</p><p>如果数据线（<strong>SDA</strong>）被固定为低电平，控制器应发送九个时钟脉冲。
保持总线为低电平的设备应在这九个时钟内某个时间释放它。
如果没有，则使用硬件复位或切断电源以清除总线。</p><h5 id=a-id3117-设备id3117-设备ida><a id="3.1.17 设备id">3.1.17 设备ID</a></h5><p>设备ID字段（见 <em><a href="#图 20">图 20</a></em> ）是一个可选的3字节只读（24 位），提供以下信息：</p><ul><li>十二位具有制造商名称，每个制造商唯一（例如，NXP）</li><li>九位具有部件标识，由制造商分配（例如，PCA9698）</li><li>三位具有晶圆修订，由制造商分配（例如，RevX）</li></ul><p><a id="图 20">图 20
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_20._Device_ID_field.png alt></a></p><p>设备ID是只读的，硬件固定在设备中，可以通过以下方式访问：</p><ol><li>START;</li><li>主机发送保留设备ID的I2C总线地址，后跟R/W位设置为‘0’（写）：‘0b1111_1000’。</li><li>主机发送它必须识别从机的I2C总线从机地址。 LSB是‘不关心’值。 仅有一个设备必须确认此字节（拥有I2C总线从机地址的设备）。</li><li>主机发送Re-START条件。</br>注意：一个STOP条件后跟一个START条件会重置目标状态机，无法执行设备ID读取。
同时，一个STOP条件或一个Re-START 条件后跟对另一个从机的访问会重置目标状态机，无法执行设备ID读取。</li><li>主机发送保留设备ID的I2C总线地址，后跟（R/<span style=text-decoration:overline>w</span>）位设置为‘1’（读）：‘1111 1001’。</li><li>设备ID读取可以进行，
从12个位制造商位（第一个字节+第二个字节的四个MSB）开始，
接着是9个位部件识别位（第二个字节的四个LSB+第三个字节的五个MSB），
然后是3个晶圆修订位（第三个字节的三个LSB）。</li><li>主机通过对最后一个字节发送NACK结束读取序列，从而重置目标设备状态机，并允许主机发送停止条件。</br>注意：设备ID的读取可以通过发送NACK随时停止。如果主机在第三个字节后继续ACK这些字节，目标将回滚到第一个字节，并继续发送设备ID序列，直到检测到NACK。</li></ol><p><a id="表 5">表 5
<img src=https://icjj.github.io/icer/img/post/i2c/Table_5._Assigned_manufacturer_IDs-1.png alt>
<img src=https://icjj.github.io/icer/img/post/i2c/Table_5._Assigned_manufacturer_IDs-2.png alt></a></p><h4 id=a-id32-i2c超高速模式ufm32-i2c超高速模式ufma><a id="3.2 i2c超高速模式（ufm）">3.2 i2c超高速模式（UFm）</a></h4><p>UFm I2C总线是一种2线推挽串行总线，工作频率从直流到5 MHz，数据单向传输。
对于速度大于1 MHz的应用，它最适合驱动LED控制器和不需要反馈的其他设备。
UFm I2C总线协议基于标准I2C总线协议，由START、从机地址、命令位、第九个时钟和STOP组成。
命令位仅为“写入”，第九个时钟上的数据位驱动为高电平。因为总线是单向的，所以忽略ACK周期。
2线推挽驱动器由UFm串行时钟（<strong>USCL</strong>）和串行数据（<strong>USDA</strong>）组成。</p><p>从机包含一个唯一地址（无论是微控制器、LCD驱动器、LED控制器或GPO），并仅作为接收端工作。
LED驱动器可能只是一个接收端，可以由UFm支持，但内存则可以接收和发送数据，不受UFm支持。</p><p>由于UFm I2C总线使用推挽驱动器，因此没有有线与门开漏Sm、Fm和Fm+ I2C总线的多控制器能力。
在UFm中，主机是唯一发起总线上数据传输的设备，并生成时钟信号以允许该传输。所有其他被寻址的设备被视为从机。</p><p><a id="表 6">表 6</a> UFm的术语描述</p><table><thead><tr><th>术语</th><th>描述</th></tr></thead><tbody><tr><td>发送端</td><td>这个设备将数据发送到总线上。</td></tr><tr><td>接收端</td><td>这个设备从总线上接收数据。</td></tr><tr><td>主机（Controller）</td><td>这个设备主动发起传输，产生时钟以及终止传输。</td></tr><tr><td>从机（Target）</td><td>这个设备由主机进行控制。</td></tr></tbody></table><p>让我们考虑在主机与连接到UFm I2C总线的多个从机之间进行数据传输的情况（见 <em><a href="#图 21">图 21</a></em> ）</p><p><a id="图 21">图 21
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_21._Example_of_UFm_I2C-bus_configuration.png alt></a></p><p>这突出了在UFm I2C总线上的主机发射端和从机接收端的关系。要注意的是这些关系是永久性的，因为数据传输仅允许单向进行。
数据传输将按如下方式进行：<br>假设ASIC主机想要将信息发送到LED控制器2：</p><ul><li>ASIC A（主机发射端）通过在<strong>USDA</strong>上发送地址并在<strong>USCL</strong>上生成时钟来寻址LED控制器2（从机接收端）。</li><li>ASIC A（主机发射端）在<strong>USDA</strong>上向LED控制器2（从机接收端）发送数据并在<strong>USCL</strong>上生成时钟。</li><li>ASIC A终止传输。</li></ul><p>由于推挤输出上的总线争用问题，不允许将多个UFm控制器连接到UFm I2C总线。
如果系统中需要额外的控制器，则必须与其他控制器完全隔离（即，使用真正的“独热”多路复用器，输入多个主机信号，只使能一个主机使用总线）。
因为在总线上一次只允许一个控制器。</p><p>在UFm I2C总线上生成时钟信号始终是主机的责任，也就是说，主机在总线传输数据时生成时钟信号。
主机发出的总线时钟信号不能被从机通过时钟拉伸改变，并且在UFm I2C总线上不存在仲裁和时钟同步的过程。</p><p><em><a href="#表 7">表 7 </a></em>总结了UFm I2C总线规范中强制性和可选部分的使用。</p><p><a id="表 7">表 7</a> UFm i2c总线的功能适用性
M = 强制的；O=可选的；n/p = 不可能。</p><table><thead><tr><th>功能</th><th>适用性</th></tr></thead><tbody><tr><td>START</td><td>M</td></tr><tr><td>STOP</td><td>M</td></tr><tr><td>ACK（A<span style=text-decoration:overline>A</span>）</td><td>n/p</td></tr><tr><td>同步</td><td>n/p</td></tr><tr><td>仲裁</td><td>n/p</td></tr><tr><td>时钟拉伸</td><td>n/p</td></tr><tr><td>7位目标地址</td><td>M</td></tr><tr><td>10位目标地址</td><td>O</td></tr><tr><td>通用呼叫地址</td><td>O</td></tr><tr><td>软件重置</td><td>O</td></tr><tr><td>START字节</td><td>O</td></tr><tr><td>设备 ID</td><td>n/p</td></tr></tbody></table><h5 id=a-id321-usda和uscl信号321-usda和uscl信号a><a id="3.2.1 usda和uscl信号">3.2.1 USDA和USCL信号</a></h5><p><strong>USDA</strong>和<strong>USCL</strong>都是单向线路，具有推拉输出。
当总线空闲时，两个线路都由输出级的上部晶体管拉高。
在UFm模式下，I2C总线上的数据传输速率可以达到5000 kbit/s。
连接到总线的接口数量受到总线负载、来自电缆端、连接器和分支的反射的限制。</p><p><a id="图 22">图 22
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_22._Simplified_schematic_of_USCL,_USDA_outputs.png alt></a></p><h5 id=a-id322-usda和uscl的逻辑电平322-usda和uscl的逻辑电平a><a id="3.2.2 usda和uscl的逻辑电平">3.2.2 usda和uscl的逻辑电平</a></h5><p>由于可以连接到I2C总线的多种不同技术设备（CMOS，NMOS，双极型），逻辑‘0’（低）和‘1’（高）的电平并不是固定的，而是取决于相关的V<sub>DD</sub>电平。
输入参考电平设定为V<sub>DD</sub>的30%和70%；V<sub>IL</sub>为0.3V<sub>DD</sub>，V<sub>IH</sub>为0.7V<sub>DD</sub>。参见 <em><a href="#图 40">图 40</a></em> ，时序图。
有关电气规格，请参见 <em><a href="#第6章 io阶段和总线线路的电气规格及时序">第6章 IO阶段和总线线路的电气规格及时序</a></em> 。</p><h5 id=a-id323-数据有效性323-数据有效性a><a id="3.2.3 数据有效性">3.2.3 数据有效性</a></h5><p><strong>USDA</strong>线路上的数据在时钟的HIGH期间必须是稳定的。
数据线路的HIGH或LOW状态只能在<strong>USCL</strong>线路上的时钟信号为LOW时改变（见 <em><a href="#图 23">图 23</a></em> ）。
每传输一个数据位就会生成一个时钟脉冲。</p><p><a id="图 23">图 23
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_23._Bit_transfer_on_the_UFm_I2C-bus.png alt></a></p><h5 id=a-id324-start和stop条件324-start和stop条件a><a id="3.2.4 start和stop条件">3.2.4 START和STOP条件</a></h5><p>当总线未被占用时，数据线和时钟线保持高电平。
所有传输以START信号(S)开始，并可以通过STOP信号(P)结束(见 <em><a href="#图 24">图 24</a></em> )。
当<strong>USCL</strong>线为高电平时，<strong>USDA</strong>线从高电平到低电平的转换定义了START条件。
当<strong>USCL</strong>线为高电平时，<strong>USDA</strong>线从低电平到高电平的转换定义了STOP条件。</p><p><a id="图 24">图 24
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_24._Definition_of_START_and_STOP_conditions_for_UFm_I2C-bus.png alt></a></p><p>START和STOP条件始终由主机生成。
总线在START条件后被视为忙碌。该总线在STOP条件后的某段时间内再次被视为空闲。
此总线空闲状态在 <em><a href="#第6章 io阶段和总线线路的电气规格及时序">第6章 IO阶段和总线线路的电气规格及时序</a></em> 中规定。</p><p>如果生成重复的START (Sr)而不是STOP条件，总线将保持忙碌。
在这方面，START (S)和重复的START (Sr)条件在功能上是相同的。
因此，在本文的其余部分，S符号将被用作通用术语，表示START和重复的START条件，除非Sr特别相关。</p><p>如果连接到总线的设备具备必要的接口硬件，则START和STOP条件的检测是简单的。
然而，具有未包含此接口的微控制器必须在每个时钟周期至少对<strong>USDA</strong>线采样两次以进行必要的过度感知。</p><h5 id=a-id325-byte-格式325-byte-格式a><a id="3.2.5 byte 格式">3.2.5 Byte 格式</a></h5><p>每个放在<strong>USDA</strong>线路上的字节必须为八位长。
每次传输可以传输的字节数没有限制。
在确认周期中，主机在每个字节之后将<strong>USDA</strong>拉高。
如果从机无法接收另一个完整的数据字节，或者在执行其他功能时，例如处理内部中断，则不允许将时钟保持在低电平。</p><p><a id="图 25">图 25
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_25._Data_transfer_on_the_UFm_I2C-bus.png alt></a></p><h5 id=a-id326-ack和nack326-ack和nacka><a id="3.2.6 ack和nack">3.2.6 ack和nack</a></h5><p>由于从机无法在第九个时钟周期内响应，因此不需要ACK和NACK。
然而，第九个时钟周期在UFm中被保留，以兼容I2C总线协议。ACK和NACK也被称为第九个时钟周期。
主机生成所有时钟脉冲，包括第九个时钟脉冲。第九个数据位始终为高电平（‘1’）。
从机不允许在任何时候驱动SDA线。</p><h5 id=a-id327-从机地址和rw读写327-从机地址和rw读写a><a id="3.2.7 从机地址和rw读写">3.2.7 从机地址和rw读写</a></h5><p>数据传输遵循 <em><a href="#图 26">图 26</a></em> 所示的格式。
在START条件（S）之后，发送从机地址。
该地址为七位长，后面跟着一个第八位，即数据方向位（W）——‘0’表示传输（写入）；‘1’表示请求数据（读取），
而且UFm不支持读取（除了START字节，<em><a href="#3.2.12 start byte">3.2.12 START byte</a></em> ），因为通信是单向的（参见 <em><a href="#图 27">图 27</a></em> ）。
数据传输总是由主机生成的STOP条件（P）终止。
然而，如果主机仍希望在总线上进行通信，它可以生成重复的START条件（Sr），并在不先生成STOP条件的情况下指定另一个从机。</p><p><a id="图 26">图 26
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_26._A_complete_UFm_data_transfer.png alt></a></p><p><a id="图 27">图 27
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_27._The_first_byte_after_the_START_procedure.png alt></a></p><p>UFm数据传输格式为：</p><ul><li>主机发射端发送数据到从机接收端。传输方向不变。
（见 <em><a href="#图 28">图 28</a></em> ）。主机永远不会ack，因为它从未接收任何数据。
但在第九位上生成“1”以便目标符合I2C总线协议。</li></ul><p><a id="图 28">图 28
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_28._A_controller-transmitter_addressing_a_target_receiver_with_a_7-bit_address.png alt></a></p><p>Note：</p><ol><li>可以使用单个传输或重复的START格式来一次性处理多个从机。在重复START条件和从机地址后，可以传输数据。</li><li>有关自动递增或递减先前访问的内存位置等的所有决策由设备设计者做出。</li><li>每个字节后面都有一个nack位，如序列中的<span style=text-decoration:overline>A</span>块所示。</li><li>I2C总线兼容设备必须在收到START或重复START条件时重置其总线逻辑，以便它们都能够预期从机地址的发送，即使这些START条件未按照正确格式定位。</li><li>一个START条件紧接着一个STOP条件（无效消息）是非法格式。然而，许多设备可以设计为在这种条件下正常运行。</li><li>连接到总线的每个设备都可以通过唯一地址寻址。只存在简单的主从关系，但可以有多个相同的从机可以同时接收和响应。
例如在组播中，所有相同的设备同时配置，可以理解到无法同时确定每个从机是否都有响应。请参考各个组件的数据手册。</li></ol><h5 id=a-id328-10-bit地址328-10-bit地址a><a id="3.2.8 10-bit地址">3.2.8 10-bit地址</a></h5><p>10位寻址扩展了可用地址的数量。
具有7位和10位地址的设备可以连接到同一I2C总线，并且7位和10位寻址可以用于所有总线速率模式。</p><p>10位从机地址由在START条件(S)或重复START条件(Sr)后面的前两个字节构成。
第一个字节的前七位是组合0b1111_0XX，其中最后两位(XX)是10位地址的两个最高有效位(MSB)；
第一个字节的第八位是R/<span style=text-decoration:overline>W</span>位，用来确定消息的方向。</p><p>尽管有八种可能的保留地址位组合0b1111_XXX，但仅用于10位寻址的组合是0b1111_0XX。剩下的四种组合0b1111_1XX被保留用于未来的I2C总线增强。
仅以前描述的7位寻址写格式可用于10位寻址。详细信息如下：</p><ul><li>主机发射端使用10位从机地址向从机接收端发送数据。
传输方向不变（见 <em><a href="#图 29">图 29</a></em> ）。
当10位地址跟随一个START条件时，每个从机将从机地址第一个字节的前七位(0b1111_0XX)与其自身地址进行比较，
并检查第八位(R/<span style=text-decoration:overline>W</span>方向位)是否为0(<span style=text-decoration:overline>W</span>)。
所有找到匹配的从机将从机地址的第二个字节的八位(XXXX XXXX)与自己的地址进行比较，但只有一个从机找到匹配。
匹配的从机将由主机保持寻址，直到它接收到停止条件(P)或跟随不同从机地址的重复START条件(Sr)。</li></ul><h5 id=a-id329-ufm的保留地址329-ufm的保留地址a><a id="3.2.9 ufm的保留地址">3.2.9 UFM的保留地址</a></h5><p>UFm I2C总线的物理层与其他I2C总线模式不同。
因此可用的从机地址范围也不同。
<em><a href="#表 8">表 8</a></em> 中所示的从机保留了两组八个地址（0b0000_XXX和0b1111_XXX）。</p><p><a id="表 8">表 8</a> 保留地址</br>X = 不care；1 = HIGH；0 = LOW。</p><table><thead><tr><th>从机地址</th><th>R/W</th><th>bit</th><th>Description</th></tr></thead><tbody><tr><td>0b0000_000</td><td>0</td><td>通用呼叫地址 <sup><em><a href=#[3-11]>[3-11]</a></em></sup></td><td></td></tr><tr><td>0b0000_000</td><td>1</td><td>START byte <sup><em><a href=#[3-11]>[3-11]</a></em></sup></td><td></td></tr><tr><td>0b0000_001</td><td>X</td><td>reserved for future purposes</td><td></td></tr><tr><td>0b0000_010</td><td>X</td><td>reserved for future purposes</td><td></td></tr><tr><td>0b0000_011</td><td>X</td><td>reserved for future purposes</td><td></td></tr><tr><td>0b0000_1XX</td><td>X</td><td>reserved for future purposes</td><td></td></tr><tr><td>0b1111_1XX</td><td>X</td><td>reserved for future purposes</td><td></td></tr><tr><td>0b1111_0XX</td><td>X</td><td>10-bit 从机地址</td><td></td></tr></tbody></table><p><a id=[3-11]>[3-11]</a> ：通用呼叫地址用于多个功能，包括软件重置。</p><p><a id=[3-11]>[3-11]</a> ：不允许任何UFm设备在接收到START字节时进行确认。</p><p>在本地系统中地址的分配由系统架构师负责，他们必须考虑总线上使用的设备以及将来与保留地址的任何交互。
例如，一个具有七个用户可分配地址引脚的设备允许所有128个地址被分配。如果已知保留地址将永远不会用于其预定目的，则可以将保留地址用作从机地址。</p><h5 id=a-id3210-通用呼叫地址3210-通用呼叫地址a><a id="3.2.10 通用呼叫地址">3.2.10 通用呼叫地址</a></h5><p>通用官博地址用于同时寻址所有连接到I2C总线的设备。
然而，如果某个设备不需要一般调用结构中提供的任何数据，它可以忽略此地址。
如果某个设备确实需要来自通用呼叫地址的数据，它会表现得像一从机接收端。
主机实际上并不知道有多少设备对通用呼叫做出响应。
每个能够处理这些数据的从机接收端都会接收第二个及后续字节。
无法处理其中一个字节的从机必须忽略它。
通用呼叫地址的含义总是在第二个字节中指定（见 <em><a href="#图 30">图 30</a></em>）。</p><p><a id="图 30">图 30
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_30._General_call_address_format.png alt></a></p><p>考虑两个情况：</p><ul><li>当最低有效位B为‘1’时，第二个字节的定义如下：<ul><li>0b0000_0110 (0h6)</br>通过硬件重置并写入目标地址的可编程部分。在接收到这个2字节序列后，所有设计为响应广播地址的设备都会重置并接受它们地址的可编程部分。</li><li>0b0000_0100 (0h4)</br>通过硬件写入目标地址的可编程部分。表现如上，但设备不会重置。</li><li>0b0000_0000 (0h0)</br>这个代码不允许用作第二个字节。编程过程的序列已在相应设备的数据手册中发布。其余代码未被固定，设备必须忽略它们。</li></ul></li><li>当最低有效位B为‘1’时，2字节序列被忽略。</li></ul><h5 id=a-id3211-软件复位3211-软件复位a><a id="3.2.11 软件复位">3.2.11 软件复位</a></h5><p>在接收到通用呼叫（0b0000_0000）后，发送0b0000_0110（0h6）作为第二个字节会导致软件复位。
此功能是可选的，并不是所有设备都对该命令做出响应。在接收到此2字节序列时，所有设计为响应通用呼叫地址的设备将复位并接受其地址的可编程部分。</p><h5 id=a-id3212-start-byte3212-start-bytea><a id="3.2.12 start byte">3.2.12 START Byte</a></h5><p>微控制器可以通过两种方式连接到I2C总线。
具有片上硬件I2C总线接口的微控制器可以被编程为仅在接收到来自总线的请求时中断。
当设备没有这样的接口时，它必须通过软件不断监控总线。
显然，微控制器监控或轮询总线的次数越多，它就越少时间用于执行其预期功能。</p><p>因此，快速硬件设备与依赖软件轮询的相对较慢的微控制器之间存在速度差异。
在这种情况下，数据传输可以通过一个比正常长得多的START程序进行（见 <em><a href="#图 31">图 31</a></em> ）。START程序包括：</p><ul><li>START（S）</li><li>START字节（0000 0001）</li><li>非确认时钟脉冲（NACK）</li><li>重复START条件（Sr）</li></ul><p><a id="图 31">图 31
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_31._START_byte_procedure.png alt></a></p><p>在需要总线访问的主机传输START条件S之后，START字节（0b0000_0001）被传输。
因此，另一个微控制器可以以较低的采样率对<strong>USDA</strong>线进行采样，直到检测到START字节中的七个零之一。
在检测到<strong>USDA</strong>线上这个低电平后，微控制器可以切换到更高的采样率，以查找重复的START条件Sr，
然后用于同步。硬件接收器在接收到重复的START条件Sr时重置，因此忽略START字节。
在START字节之后生成一个与确认相关的时钟脉冲。这仅用于符合总线中使用的字节处理格式。没有设备被允许确认START字节。</p><h5 id=a-id3213-无响应从机复位3213-无响应从机复位a><a id="3.2.13 无响应从机复位">3.2.13 无响应从机复位</a></h5><p>在极少数的情况下，如果从机变得无响应（例如，通过外部反馈判断，而非通过UFm I2C总线），
首选程序是使用软件重置命令或硬件重置信号重置目标。
如果目标不支持这些功能，则需要切断设备电源以启动强制内部上电复位（POR）电路。</p><h5 id=a-id3214-设备id3214-设备ida><a id="3.2.14 设备id">3.2.14 设备ID</a></h5><p>在UFm中不支持设备ID。</p><h3 id=a-id第4章-i2c总线的其他使用第4章-i2c总线的其他使用a><a id="第4章 i2c总线的其他使用">第4章 i2c总线的其他使用</a></h3><p>I2C总线被用作多个系统架构的通讯协议。
这些架构在基本I2C规范的基础上增加了命令集和特定应用的扩展。</p><p>一般而言，简单的I2C总线设备如I/O扩展器可以用于这些架构中的任何一种，因为协议和物理接口都是相同的。</p><h4 id=a-id41-cbus兼容性41-cbus兼容性a><a id="4.1 cbus兼容性">4.1 CBUS兼容性</a></h4><p>CBUS 接收器可以连接到标准模式 I2C 总线上。
然而，必须连接一条称为<strong>DLEN</strong>的第三条总线，并省略确认位。
通常，I2C 传输是一系列 8 位字节；CBUS 兼容设备具有不同的格式。
在混合总线结构中，I2C 总线设备不得响应 CBUS 消息。
因此，保留了一个特殊的 CBUS 地址（0000 001X），没有 I2C 总线兼容设备对此做出响应。
在传输 CBUS 地址后，DLEN 线可以激活，并发送 CBUS 格式的传输。
在START条件之后，所有设备再次准备接受数据。主机发送端在发送 CBUS 地址后可以发送 CBUS 格式。
所有设备都可以识别的START条件标志着传输结束。</p><blockquote><p>Note：</br>如果已知 CBUS 配置，并且不打算使用 CBUS 兼容设备进行扩展，设计者可以根据所用设备的特定要求调整保持时间。</p></blockquote><h4 id=a-id42-smbus---系统管理总线42-smbus---系统管理总线a><a id="4.2 smbus - 系统管理总线">4.2 SMBus - 系统管理总线</a></h4><p>SMBus使用I2C硬件和I2C硬件寻址，但增加了第二级软件用于构建特殊系统。
特别是，它的规范包括一个地址解析协议，可以进行动态地址分配。</p><p>硬件和软件的动态重配置允许总线设备“热插拔”并立即使用，而无需重启系统。
设备会被自动识别并分配唯一地址。这一优势使得即插即用的用户界面成为可能。
在这两种协议中，对系统主机和系统中所有其他可以充当主机或者从机的设备之间进行了非常有用地区分。</p><p>SMBus今天作为大多数个人计算机中的系统管理总线使用。
由英特尔等公司于1995年开发，它修改了一些I2C电气和软件特性，以更好地兼容便携设备快速下降的电源预算。
SMBus还拥有一个“高功率”版本2.0，包含4 mA的漏电流，除非上拉电阻的大小达到I2C总线水平，否则I2C芯片无法驱动。</p><h5 id=a-id421-i2c和smbus的兼容性421-i2c和smbus的兼容性a><a id="4.2.1 i2c和smbus的兼容性">4.2.1 I2C和SMBus的兼容性</a></h5><p>SMBus和I2C协议基本相同：</br>SMBus控制器能够在协议层面上控制I2C设备，反之亦然。
SMBus的时钟频率定义为10 kHz到100 kHz，而I2C可以在0 Hz到100 kHz、0 Hz到400 kHz、0 Hz到1 MHz和0 Hz到3.4 MHz之间变化，这取决于模式。
这意味着在低于10 kHz运行的I2C总线不符合SMBus标准，因为SMBus设备可能会超时。</p><p>逻辑电平也略有不同：</br>对于SMBus，TTL的低电平为0.8 V，高电平为2.1 V，而I2C的电平为30%/70% V<sub>DD</sub> CMOS。如果V<sub>DD</sub> > 3.0 V并不是一个问题。
如果I2C设备低于3.0 V，那么如果逻辑高/低电平未被正确识别，就可能会出现问题。</p><h5 id=a-id422-超时功能422-超时功能a><a id="4.2.2 超时功能">4.2.2 超时功能</a></h5><p>SMBus具有超时功能，当通信时间过长时会重置设备。
这解释了最低时钟频率为10 kHz，以防止总线锁定。</p><p>I2C可以是‘DC’总线，意味着从机在主机访问它时会拉伸主机时钟，以进行某些例行操作。
这通知主机，从机正忙，但不想失去通信。
从机将在其任务完成后继续。</p><p>I2C总线协议对这种延迟的持续时间没有限制，而在SMBus系统中，延迟时间将限制在35毫秒内。
SMBus协议假设如果某件事情花费的时间过长，那么意味着总线上出现了问题，所有设备必须重置以清除此状态。
从机不允许将时钟保持在低电平状态过长时间。</p><h5 id=a-id423-smbus10-和-20的区别423-smbus10-和-20的区别a><a id="4.2.3 smbus1.0 和 2.0的区别">4.2.3 SMBus1.0 和 2.0的区别</a></h5><p>SMBus规范定义了两类电气特性：低功率和高功率。</p><p>第一类最初在SMBus 1.0和1.1规范中定义，主要针对智能电池，但也可以用于其他低功率设备。</p><p>2.0版本引入了一组替代的高功率电气特性。
当需要更高的驱动能力时，例如在PCI扩展卡上的SMBus设备以及通过PCI连接器连接这些卡与系统板上的SMBus设备时，可使用这一类别。</p><p>设备可以由总线V<sub>DD</sub>供电，也可以由另一电源VBUS供电（例如智能电池），只要遵循其类的SMBus电气规格，它们就可以互操作。</p><p>NXP设备具有比SMBus 1.0更高的电气特性。主要区别在于电流下沉能力，V<sub>OL</sub> = 0.4 V。</p><ul><li>SMBus低功率 = 350 μA</li><li>SMBus高功率 = 4 mA</li><li>I2C总线 = 3 mA</li></ul><p>如果拉升电阻为3 mA，SMBus“高功率”设备和I2C总线设备将一起工作。<br>有关更多信息，请参见：<a href=http://www.smbus.org/>http://www.smbus.org/</a></p><h4 id=a-id43-pmbus---电源管理总线43-pmbus---电源管理总线a><a id="4.3 pmbus - 电源管理总线">4.3 PMBus - 电源管理总线</a></h4><p>PMBus 是一种在 SMBus 上实现电源转换器与系统主机之间通信的标准方式，以提供对电源转换器更智能的控制。
PMBus 规范定义了一组标准的设备命令，使来自多个来源的设备具有相同的功能。
PMBus 设备使用 SMBus 版本 1.1 及其扩展进行传输。<br>如需更多信息，请访问： <a href=https://pmbus.org/>https://pmbus.org/</a></p><h4 id=a-id44-智能平台管理接口44-智能平台管理接口a><a id="4.4 智能平台管理接口">4.4 智能平台管理接口</a></h4><p>智能平台管理接口（Intelligent Platform Management Interface - IPMI）定义了一种标准化、抽象化的基于消息的接口，用于智能平台管理硬件。
IPMI还定义了用于描述平台管理设备及其特性的标准化记录。IPMI通过监控温度、电压、风扇和机壳入侵等参数来提高系统的可靠性。</p><p>IPMI提供了一般的系统管理功能，如自动警报、自动系统关机和重启、远程重启和电源控制。
对智能平台管理硬件的标准化接口有助于预测和早期监控硬件故障以及故障诊断。</p><p>这个标准化的总线和协议用于扩展机壳内的管理控制、监控和事件传递：</p><ul><li>基于I2C。</li><li>多控制器。</li><li>简单的请求/响应协议。</li><li>使用IPMI命令集。</li><li>支持非IPMI设备。</li><li>物理上为I2C，但为只写（支持控制器的设备）；不需要热插拔。</li><li>使基础管理控制器（BMC）能够接受来自系统中其他管理控制器的IPMI请求消息。</li><li>允许非智能设备以及总线上的管理控制器。</li><li>BMC作为控制器使系统软件能够访问IPMB。</li></ul><p>硬件实现与软件实现隔离，因此可以在不进行任何软件更改的情况下添加新传感器和事件。。
欲了解更多信息，请访问：<a href=https://www.intel.com/content/www/us/en/products/docs/servers/ipmi/ipmi-home.html>https://www.intel.com/content/www/us/en/products/docs/servers/ipmi/ipmi-home.html</a></p><h4 id=a-id45-高级电信计算架构advanced-telecom-computing-architecture---atca45-高级电信计算架构advanced-telecom-computing-architecturea><a id="4.5 高级电信计算架构（advanced telecom computing architecture - atca）">4.5 高级电信计算架构（Advanced Telecom Computing Architecture）</a></h4><p>高级电信计算架构（ATCA）是对紧凑型PCI（Compact PCI - cPCI）的后续方案，提供标准化的外形规格，
具有更大的card面积、更大的间距和更大的电源供应，用于先进的机架安装电信硬件。
它包括一种用于热管理的容错方案，该方案在电路板之间使用I2C总线通信。</p><p>高级电信计算架构（ATCA）得到了包括英特尔、朗讯和摩托罗拉等众多大型企业在内的100多家公司的支持。</p><p>对ATCA兼容的风扇控制有两种通用的合规方案：</p><ul><li>第一个是智能FRU（现场可更换单元），这意味着风扇控制将直接连接到IPMB（智能平台管理总线）；</li><li>第二个是管理型或非智能FRU。</li></ul><p>管理双I2C总线的要求中需要包含硬件和软件。这需要一个板载绝缘电源为电路供电，一个带有上升时间加速器的缓冲双I2C总线，以及三态能力。
I2C主机必须能够支持多主机I2C双总线，并处理协议中列出的标准风扇命令集。
此外，还需要板载温度报告、托盘能力报告、风扇关闭功能和非易失性存储。有关更多信息，请参考：
<a href=https://www.picmg.org/openstandards/advancedtca/>https://www.picmg.org/openstandards/advancedtca/</a></p><h4 id=a-id46-显示数据通道display-data-channel---ddc46-显示数据通道display-data-channel---ddca><a id="4.6 显示数据通道（display data channel - ddc)）">4.6 显示数据通道（Display Data Channel - DDC)）</a></h4><p>显示数据通道（DDC）允许监视器或显示器向主机通报其身份和能力。
DDC版本2的规范要求符合I2C总线标准模式规范，它支持显示器与主机之间的双向通信，使得可以控制监视器功能。
例如图像的显示方式以及与连接到I2C总线的其他设备的通信。</p><p>有关更多信息，请参阅：<a href=https://vesa.org/>https://vesa.org/</a></p><h3 id=a-id第5章-总线速度第5章-总线速度a><a id="第5章 总线速度">第5章 总线速度</a></h3><p>最初I2C总线的操作速度限制为100 kbit/s。随着时间的推移，规范中增加了几个内容，现在有五种操作速度类别。
标准模式（Sm）、快速模式（Fm）、快速加模式（Fm+）和高速模式（Hs-mode）。
设备是向下兼容的——任何设备都可以在较低的总线速度下运行。超快速模式设备与之前的版本不兼容，因为总线是单向的。</p><ul><li>双向总线：<ul><li>标准模式（Sm），比特率高达100 kbit/s</li><li>快速模式（Fm），比特率高达400 kbit/s</li><li>快速加模式（Fm+），比特率高达1 Mbit/s</li><li>高速模式（Hs-mode），比特率高达3.4 Mbit/s。</li></ul></li><li>单向总线：<ul><li>超快速模式（UFm），比特率高达5 Mbit/s</li></ul></li></ul><h4 id=a-id51-快速模式51-快速模式a><a id="5.1 快速模式">5.1 快速模式</a></h4><p>快速模式设备的接收和传输速度最高可达400 kbit/s。
最低要求是它们能够与400 kbit/s的传输同步；然后，它们可以延长<strong>SCL</strong>信号的LOW周期以减慢传输。
<strong>SDA</strong>和<strong>SCL</strong>线路的协议、格式、逻辑电平和最大电容负载与标准模式I2C总线规范相同。
快速模式设备向后兼容，可以在0到100 kbit/s的I2C总线系统中与标准模式设备通信。
然而，标准模式设备不向前兼容；它们不应被纳入快速模式I2C总线系统，因为它们无法跟上更高的传输速率，会出现不可预测的状态。</p><p>与标准模式相比，快速模式I2C总线规范具有以下附加功能：</p><ul><li>最大比特率增加到400 kbit/s。</li><li>串行数据（<strong>SDA</strong>）和串行时钟（<strong>SCL</strong>）信号的时序已经调整。无需与其他总线系统（例如CBUS）兼容，
因为它们无法以增加的比特率运行。</li><li>输入集成了尖峰抑制和在<strong>SDAH</strong>和<strong>SCLH</strong>输入处的施密特触发器。</li><li>快速模式设备的输出缓冲器包含<strong>SDA</strong>和<strong>SCL</strong>信号下降沿的斜率控制。</li><li>如果快速模式设备的电源关闭，<strong>SDA</strong>和<strong>SCL</strong> I/O引脚必须处于悬空状态，以免阻塞总线线路。</li></ul><p>连接到总线线路的外部上拉设备必须适应快速模式I2C总线较短的最大允许上升时间。
对于高达200 pF的总线负载，每条总线线路的上拉设备可以是一个电阻；
对于200 pF到400 pF之间的总线负载，
上拉设备可以是一个电流源（最大3 mA）或一个开关电阻电路（见 <em><a href="#7.2.4 切换式上拉电路">7.2.4 切换式上拉电路</a></em> ）。</p><h4 id=a-id52-快速加模式52-快速加模式a><a id="5.2 快速加模式">5.2 快速加模式</a></h4><p>快速加模式（Fm+）设备提高了I2C总线传输速度和总线电容。
Fm+设备能够以高达1 Mbit/s的比特率传输信息，在混合速度总线系统中与快速或标准模式设备完全向下兼容，以实现双向通信。
与快速或标准模式系统保持相同的串行总线协议和数据格式。
Fm+设备还提供比快速或标准模式设备更高的驱动电流，使其能够驱动更长和/或负载更重的总线，从而不需要使用总线缓冲器。</p><p>快速模式加部件中的驱动器足够强大，可以满足与标准模式部件相同的400 pF负载的快速模式加时序规范。
为了向后兼容标准模式，它们对于标准模式部件的1 μs上升时间也具有一定的容忍度。
在仅存在快速模式加部件的应用中，只要满足快速模式加的set-up时间、最小低电平时间和最小高电平时间，
且下降时间和上升时间不超过标准模式的300 ns t<sub>f</sub>和1 μs t<sub>r</sub>规范，
高驱动强度和对慢上升和下降时间的容忍性允许使用更大的总线电容。
总线速度可以与负载电容进行权衡，以将最大电容增加约十倍。</p><h4 id=a-id53-高速模式53-高速模式a><a id="5.3 高速模式">5.3 高速模式</a></h4><p>高速模式（Hs模式）设备在I2C总线传输速度上提供了量子飞跃。
Hs模式设备可以以高达3.4 Mbit/s的比特率传输信息，同时它们在混合速度总线系统中与快速加模式、快速或标准模式（F/S）设备完全向下兼容，能够进行双向通信。
唯一的例外是在Hs模式传输期间不进行仲裁和时钟同步，其他均与F/S模式系统保持相同的串行总线协议和数据格式。</p><h5 id=a-id531-高速模式传输531-高速模式传输a><a id="5.3.1 高速模式传输">5.3.1 高速模式传输</a></h5><p>为了实现高达3.4 Mbit/s的位传输，对常规I2C总线规范进行了以下改进：</p><ul><li>Hs模式主机对<strong>SDAH</strong>信号具有开漏输出缓冲器，并且在<strong>SCLH</strong>输出上具有开漏下拉和电流源上拉电路的组合。
该电流源电路缩短了<strong>SCLH</strong>信号的上升时间。任何时候只有一个主机的电流源在Hs模式下启用。</li><li>在多主机系统的Hs模式传输中，不执行仲裁或时钟同步，这加快了位处理能力。仲裁程序始终在F/S模式中完成前一个主机代码传输后结束。</li><li>Hs模式主机生成的串行时钟信号的高低比为1比2。这缓解了设置和保持时间的时序要求。</li><li>作为选择，Hs模式主机可以具有内置桥。在Hs模式传输期间，Hs模式设备的高速数据（<strong>SDAH</strong>）和高速串行时钟（<strong>SCLH</strong>）线
通过此桥与F/S模式设备的<strong>SDA</strong>和<strong>SCL</strong>线路隔离。
这减少了<strong>SDAH</strong>和<strong>SCLH</strong>线路的电容负载，从而导致更快的上升和下降时间。</li><li>Hs模式从机与F/S模式从机之间的唯一区别在于它们的操作速度。Hs模式从机在<strong>SCLH</strong>和<strong>SDAH</strong>输出上具有开漏输出缓冲器。
<strong>SCLH</strong>引脚上的可选下拉晶体管可用于拉伸<strong>SCLH</strong>信号的LOW电平，但这仅在Hs模式传输中的确认位之后允许。</li><li>Hs模式设备的输入集成了尖峰抑制和在<strong>SDAH</strong>和<strong>SCLH</strong>输入处的施密特触发器。</li><li>Hs模式设备的输出缓冲器集成了<strong>SDAH</strong>和<strong>SCLH</strong>信号下降沿的斜率控制。</li></ul><p><em><a href="#图 32">图 32</a></em> 显示了仅包含Hs模式设备的系统中的物理I2C总线配置。
主机的<strong>SDA</strong>和<strong>SCL</strong>针脚仅在混合速度总线系统中使用，并且在仅Hs模式的系统中不连接。在这种情况下，这些引脚可以用于其他功能。</p><p>可选的串联电阻R<sub>s</sub>保护I2C总线设备的I/O阶段免受总线线上的高电压尖峰，并最小化振铃和干扰。</p><p>上拉电阻R<sub>p</sub>在总线处于空闲状态时将<strong>SDAH</strong>和<strong>SCLH</strong>线路保持在高电平，
并确保信号在所需的上升时间内从低电平拉升到高电平。对于更高的电容总线负载（>100 pF），电阻R<sub>p</sub>可以由外部电流源上拉替代以满足上升时间要求。
除非在确认位之后，Hs模式传输中的<strong>SCLH</strong>时钟脉冲的上升时间由活动控制器的内部电流源上拉电路MCS缩短。</p><p><a id="图 32">图 32
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_32._I2C-bus_configuration_with_Hs-mode_devices_only.png alt></a></p><h5 id=a-id532-高速模式下的串行数据格式532-高速模式下的串行数据格式a><a id="5.3.2 高速模式下的串行数据格式">5.3.2 高速模式下的串行数据格式</a></h5><p>串行数据传输格式在高速模式下符合标准模式I2C总线规范。在满足以下条件后，才能开始高速模式（所有条件均在频率/同步模式下）：</p><ol><li>START（S）</li><li>8位主机代码（0b0000_1XXX）</li><li>不确认位（<span style=text-decoration:overline>A</span>）</li></ol><p><em><a href="#图 33">图 33</a></em> 和 <em><a href="#图 34">图 34</a></em> 对此进行了更详细的说明。
该主机代码有两个主要功能：</p><ul><li>它允许在频率/同步模式速度下进行竞争主机之间的仲裁和同步，从而产生一个获胜的主机。</li><li>它指示高速模式传输的开始。</li></ul><p>高速模式主机代码是保留的8位代码，不用于从机寻址或其他用途。
此外，由于每个主机都有其独特的主机代码，因此最多可以在一个I2C总线系统上存在八个高速模式主机（主机代码0b0000_1000应保留用于测试和诊断目的）。
高速模式主机的主机代码是软件可编程的，由系统设计人员选择。</p><p>仲裁和时钟同步仅在主机代码和不确认位（<span style=text-decoration:overline>A</span>）的传输过程中进行，之后一个获胜的主机保持活动状态。
主机代码向其他设备指示将开始高速模式传输，连接的设备必须符合高速模式规范。
由于不允许任何设备确认主机代码，因此主机代码后跟一个不确认位（<span style=text-decoration:overline>A</span>）。</p><p>在不确认位（<span style=text-decoration:overline>A</span>）之后，<strong>SCLH</strong>线被拉升到高电平，活动主机切换到高速模式，
并在时间t<sub>H</sub>处（见 <em><a href="#图 34">图 34</a></em> ）使<strong>SCLH</strong>信号的电流源上拉电路启用。
由于其他设备可以通过拉伸<strong>SCLH</strong>信号的低电平来延迟串行传输，因此当所有设备释放<strong>SCLH</strong>线且<strong>SCLH</strong>信号达到高电平时，
活动主机启用其电流源上拉电路，从而加速<strong>SCLH</strong>信号最后一部分的上升时间。</p><p>活动主机然后发送一个重复的START条件（Sr），后跟7位从机地址（或10位从机地址，见 <em><a href="#3.1.11 10-bit地址">3.1.11 10-bit地址</a></em> ）和一个读/写位地址，
并从所选从机接收一个确认位（A）。</p><p>在重复的START条件之后，以及在每个确认位（A）或不确认位（<span style=text-decoration:overline>A</span>A）之后，活动主机禁用其电流源上拉电路。
这使得其他设备能够通过拉伸<strong>SCLH</strong>信号的低电平来延迟串行传输。
当所有设备释放且<strong>SCLH</strong>信号达到高电平时，活动主机再次启用其电流源上拉电路，从而加速<strong>SCLH</strong>信号最后一部分的上升时间。</p><p>数据传输在下一个重复的START（Sr）之后继续在高速模式下进行，并且仅在STOP条件（P）后切换回频率/同步模式。
为了减少主机代码的开销，主机可以链接多个高速模式传输，这些传输由重复的START条件（Sr）分隔。</p><p><a id="图 33">图 33
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_33._Data_transfer_format_in_Hs-mode.png alt></a></p><p><a id="图 34">图 34
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_34._A_complete_Hs-mode_transfer.png alt></a></p><h5 id=a-id533-fs模式和hs模式的转化533-fs模式和hs模式的转化a><a id="5.3.3 fs模式和hs模式的转化">5.3.3 FS模式和HS模式的转化</a></h5><p>在重置和初始化之后，Hs模式设备必须处于快速模式（这实际上是F/S模式，因为快速模式向下兼容标准模式）。
每个Hs模式设备可以在快速模式和Hs模式之间切换，由I2C总线上的串行传输控制。</p><p>在 <em><a href="#图 34">图 34</a></em> 中的时间t<sub>1</sub>之前，每个连接的设备都在快速模式下运行。
在t<sub>1</sub>和t<sub>H</sub>之间的这段时间（该时间间隔可以由任何设备拉长），每个连接的设备必须识别‘S/0b00001XXX/<span style=text-decoration:overline>A</span>’序列，
并且必须将其内部电路从快速模式设置切换到Hs模式设置。
在t<sub>1</sub>和t<sub>H</sub>之间，连接的主机和从机通过以下操作执行此切换。
活动（获胜）主机：</p><ol><li>根据Hs模式中的尖峰抑制要求调整其<strong>SDAH</strong>和<strong>SCLH</strong>输入滤波器。</li><li>根据Hs模式要求调整建立时间和保持时间。</li><li>根据Hs模式要求调整其<strong>SDAH</strong>和<strong>SCLH</strong>输出级的斜率控制。</li><li>切换到Hs模式比特率，该比特率在时间t<sub>H</sub>之后是必需的。</li><li>在时间t<sub>H</sub>时使能其<strong>SCLH</strong>输出级的电流源上拉电路。</li></ol><p>非活动或失败的主机：</p><ol><li>根据Hs模式中的尖峰抑制要求调整其<strong>SDAH</strong>和<strong>SCLH</strong>输入滤波器。</li><li>等待STOP条件以检测总线何时再次空闲。</li></ol><p>所有从机：</p><ol><li>根据Hs模式中的尖峰抑制要求调整其<strong>SDAH</strong>和<strong>SCLH</strong>输入滤波器。</li><li>根据Hs模式要求调整建立时间和保持时间。该要求可能已经通过输入滤波器的适应得以满足。</li><li>如有必要，调整其<strong>SDAH</strong>输出级的斜率控制。
对于从机，斜率控制仅适用于<strong>SDAH</strong>输出级，并且根据电路容差，快速模式和Hs模式的要求在不切换其内部电路的情况下都可能得以满足。</li></ol><p>在 <em><a href="#图 34">图 34</a></em> 中的时间t<sub>FS</sub>，连接的每个设备必须识别STOP条件（P），
并将其内部电路从Hs模式设置切换回t<sub>1</sub>之前的快速模式设置。这必须在快速模式规范中规定的最小总线空闲时间内完成，如 <em><a href="#表 10">表 11</a></em> 所示。</p><h5 id=a-id534-较低速度下的高速模式534-较低速度下的高速模式a><a id="5.3.4 较低速度下的高速模式">5.3.4 较低速度下的高速模式</a></h5><p>Hs模式设备具有完全向下兼容性，可以连接到F/S模式I2C总线系统（见 <em><a href="#图 35">图 35</a></em> ）。
由于在这种配置中不会传输主机代码，因此所有Hs模式控制器设备保持在F/S模式，并以F/S模式速度进行通信，同时禁用其电流源。
<strong>SDAH</strong>和<strong>SCLH</strong>引脚用于连接到F/S模式总线系统，
允许Hs模式主机设备上的<strong>SDA</strong>和<strong>SCL</strong>引脚（如果存在）用于其他功能。</p><p><a id="图 35">图 35
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_35._Hs-mode_devices_at_FS-mode_speed.png alt></a></p><h5 id=a-id535-串行总线系统上的混合模式535-串行总线系统上的混合模式a><a id="5.3.5 串行总线系统上的混合模式">5.3.5 串行总线系统上的混合模式</a></h5><p>如果一个系统中有Hs模式、快速模式和/或标准模式设备的组合，可以通过使用互联桥，
在不同设备之间实现不同的比特率（见 <em><a href="#图 36">图 36</a></em> 和 <em><a href="#图 37">图 37</a></em> ）。</p><p>在适当的时间，需要一个桥来连接/断开Hs模式部分与F/S模式部分。该桥包括一个电平转换功能，允许具有不同供电电压的设备连接。
例如，V<sub>VDD2</sub>为5V的F/S模式设备可以连接到V<sub>DD1</sub>为3V或更低的Hs模式设备（即V<sub>DD2</sub> ≥ V<sub>DD1</sub>），
前提是<strong>SDA</strong>和<strong>SCL</strong>引脚耐受5V。
该桥被包含在Hs模式主机设备中，并完全由串行信号<strong>SDAH</strong>、<strong>SCLH</strong>、<strong>SDA</strong>和<strong>SCL</strong>控制。
这样的桥可以作为自治电路在任何集成电路中实现。</p><p>TR1、TR2和TR3是N沟道晶体管。TR1和TR2具有传输门功能，而TR3是一个开漏下拉级。
如果TR1或TR2被打开，它们将双向传输低电平，否则当漏极和源极电平上升到高电平时，每个已开启晶体管的漏极和源极之间有高阻抗。
在后一种情况下，晶体管作为电平转换器，因为<strong>SDAH</strong>和<strong>SCLH</strong>拉高到V<sub>DD1</sub>，
<strong>SDA</strong>和<strong>SCL</strong>被拉高到V<sub>DD2</sub>。</p><p>在F/S模式下，连接在一个Hs模式主机上的桥将<strong>SDAH</strong>和<strong>SCLH</strong>线连接到相应的<strong>SDA</strong>和<strong>SCL</strong>线，
从而允许Hs模式设备以较慢的速度与F/S模式设备进行通信。正如 <em><a href="#3.1.7 时钟同步">3.1.7 时钟同步</a></em> 所述，
在所有连接设备之间的F/S模式传输过程中，仲裁和同步都是可能的。
然而，在Hs模式传输过程中，桥打开以分离两个总线部分，并允许Hs模式设备在3.4 Mbit/s下相互通信。
Hs模式设备与F/S模式设备之间的仲裁仅在主机代码（0b0000_1XXX）期间执行，并通常由一个Hs模式主机赢得，因为没有从机地址具有四个前导零。
其他控制器只有在发送保留的8位代码（0b0000_0XXX）时才能赢得仲裁。在这种情况下，桥保持关闭，传输以F/S模式进行。
<em><a href="#表 9">表 9</a></em> 给出了该系统中可能的通信速度。</p><p><a id="图 36">图 36
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_36._Bus_system_with_transfer_at_Hs-mode_and_FS-mode_speeds.png alt></a></p><p><a id="表 9">表 9
<img src=https://icjj.github.io/icer/img/post/i2c/Table_9._Communication_bit_rates_in_a_mixed-speed_bus_system.png alt></a></p><blockquote><p>Note：</br><em><a href="#表 9">表 9</a></em> 假设Hs设备在以3.4 Mbit/s操作时与Fm和Sm设备隔离。总线速度始终受到连接到总线的最慢设备的最大通信速率的限制。</p></blockquote><h5 id=a-id536-混合速度总线中的标准快速增强快速传输536-混合速度总线中的标准快速增强快速传输a><a id="5.3.6 混合速度总线中的标准、快速、增强快速传输">5.3.6 混合速度总线中的标准、快速、增强快速传输</a></h5><p><em><a href="#图 36">图 36</a></em> 所示的桥接器连接了相应的串行总线线，形成了一个串行总线系统。
由于没有主机代码（0b0000_1XXX）被传输，电流源上拉电路保持禁用，所有输出级为开漏状态。
所有设备，包括Hs模式设备，按照协议、格式和F/S模式I2C总线规范的速度进行相互通信。</p><h5 id=a-id537-混合速度总线中的高速传输537-混合速度总线中的高速传输a><a id="5.3.7 混合速度总线中的高速传输">5.3.7 混合速度总线中的高速传输</a></h5><p><em><a href="#图 37">图 37</a></em> 显示了完整的Hs模式传输的时序图，
此传输由START条件、主机代码和不确认<span style=text-decoration:overline>A</span>（在F/S模式速度下）被调用。
尽管这个时序图被分为两个部分，但它应该被视为一个时序图，其中时间点t<sub>H</sub>是两个部分的共通点。
主机代码被桥接电路在活动或不活动的控制器中识别（见 <em><a href="#图 36">图 36</a></em> ）。桥接电路执行以下操作：</p><ol><li>在t<sub>1</sub>和t<sub>H</sub>之间（见 <em><a href="#图 37">图 37</a></em> ），
晶体管TR1打开以分离<strong>SDAH</strong>和<strong>SDA</strong>线，然后晶体管TR3关闭，将<strong>SDA</strong>线拉低到V<sub>SS</sub>。</li><li>当<strong>SCLH</strong>和<strong>SCL</strong>都变为高电平时（ <em><a href="#图 37">图 37</a></em> 中的t<sub>H</sub>），
晶体管TR2打开以分离<strong>SCLH</strong>和<strong>SCL</strong>线。TR2必须在<strong>SCLH</strong>在Sr之后变为低电平之前打开。</li></ol><p>Hs模式传输在t<sub>H</sub>后以重复的START条件（Sr）开始。
在Hs模式传输期间，<strong>SCL</strong>线保持在高电平，而<strong>SDA</strong>线保持在低电平稳态水平，因此为传输START条件（P）做好准备。
在每个确认（A）或不确认位（<span style=text-decoration:overline>A</span>）之后，活动控制器禁用其当前源拉升电路。
这使得其他设备能够通过拉伸<strong>SCLH</strong>信号的低电平周期来延迟串行传输。
当所有设备被释放且<strong>SCLH</strong>信号达到高电平时，活动控制器再次启用其当前源拉升电路，从而加快<strong>SCLH</strong>信号上升时间的最后部分。
在不规则情况下，F/S模式设备可以通过将<strong>SCL</strong>线拉低至少1μs任意关闭桥接电路（TR1和TR2关闭，TR3打开），例如，以恢复总线挂起的情况。</p><p>Hs模式以STOP条件结束，并将总线系统恢复到F/S模式。
当检测到<strong>SDAH</strong>上的STOP条件（P）时，活动控制器禁用其当前源MCS（<em><a href="#图 37">图 37</a></em> 中的t<sub>FS</sub>）。
桥接电路也识别这个STOP条件，并采取以下行动：</p><ol><li>晶体管TR2在t<sub>FS</sub>后关闭，以将<strong>SCLH</strong>与<strong>SCL</strong>连接；
此时两者都是高电平。晶体管TR3在t<sub>FS</sub>后打开，释放<strong>SDA</strong>线并允许其被拉高，由拉升电阻R<sub>p</sub>拉高。
这是F/S模式设备的STOP条件。TR3必须快速打开，以确保STOP条件与下一个最早的START条件之间的总线空闲时间符合快速模式规范
（见 <em><a href="#表 11">表 11</a></em> 中的t<sub>BUF</sub>）。</li><li>当<strong>SDA</strong>达到高电平时（ <em><a href="#图 37">图 37</a></em> 中的t<sub>2</sub>），
晶体管TR1关闭以连接<strong>SDAH</strong>和<strong>SDA</strong>。（注意：当所有线路为高电平时会进行互连，从而防止总线线上的尖峰。）
TR1和TR2必须在符合快速模式规范的最小总线空闲时间内关闭（见 <em><a href="#表 11">表 11</a></em> 中的t<sub>BUF</sub>）。</li></ol><p><a id="图 37">图 37
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_37._A_complete_Hs-mode_transfer_in_a_mixed-speed_bus_system.png alt></a></p><h5 id=a-id538-混合速度总线中桥接器的时序要求538-混合速度总线中桥接器的时序要求a><a id="5.3.8 混合速度总线中桥接器的时序要求">5.3.8 混合速度总线中桥接器的时序要求</a></h5><p>从 <em><a href="#图 37">图 37</a></em> 可以看出，桥接器在t<sub>1</sub>，t<sub>H</sub>和t<sub>FS</sub>时的动作必须非常迅速，
以至于不影响<strong>SDAH</strong>和<strong>SCLH</strong>线。
此外，桥接器还必须满足<strong>SDA</strong>和<strong>SCL</strong>线快速模式规范的相关时序要求。</p><h4 id=a-id54-超快速模式54-超快速模式a><a id="5.4 超快速模式">5.4 超快速模式</a></h4><p>超高速模式（UFm）设备提供了I2C总线传输速度的提升。
UFm设备可以以最高5 Mbit/s的比特率传输信息。UFm设备提供推挽驱动器，消除了上拉电阻，允许更高的传输速率。
与Sm、Fm或Fm+系统一样，串行总线协议和数据格式保持不变。UFm总线设备与双向I2C总线设备不兼容。</p><h3 id=a-id第6章-io阶段和总线线路的电气规格和时序第6章-io阶段和总线线路的电气规格和时序a><a id="第6章 io阶段和总线线路的电气规格和时序">第6章 IO阶段和总线线路的电气规格和时序</a></h3><h4 id=a-id61-标准快速快速加模式设备61-标准快速快速加模式设备a><a id="6.1 标准、快速、快速加模式设备">6.1 标准、快速、快速加模式设备</a></h4><p>I/O levels、I/O current、spike suppression、输出slope控制和引脚电容见 <em><a href=#表10>表10</a></em> 。</p><p>I2C总线时序特性、总线线电容和噪声余量见 <em><a href="#表 11">表 11</a></em> 。</p><p><em><a href="#图 38">图 38</a></em> 显示了I2C总线的时序定义。
<em><a href="#表 11">表 11</a></em> 中指定的<strong>SCL</strong>时钟的最小高低电平持续时间决定了标准模式设备的最大比特传输速率为 100 kbit/s。
快速模式设备为400kbit/s和快速加模式为1000kbit/s设备必须能够以其自身的最大比特速率跟随传输。
无论是能够以该速度发送或接收还是通过应用 <em><a href="#3.1.7 时钟同步">3.1.7 时钟同步</a></em>
中描述的时钟同步程序强制主机进入等待状态并拉伸<strong>SCL</strong>信号的低电平持续时间。在后者的情况下，比特传输速率降低。</p><p><a id="表 10">表 10</a> <strong>SDA</strong>和<strong>SCL</strong> I/O阶段设备特性</br></p><table><thead><tr><th>Symbol</th><th>Parameter</th><th>Conditions</th><th>Sm-Min</th><th>Sm-Max</th><th>Fm-Min</th><th>Fm-Max</th><th>Fm+-Min</th><th>Fm+-Max</th><th>Unit</th></tr></thead><tbody><tr><td>V<sub>IL</sub></td><td>LOW-level input voltage <sup><em><a href=#[6-1]>[6-1]</a></em></sup></td><td></td><td>-0.5</td><td>0.3V<sub>DD</sub></td><td>-0.5</td><td>0.3V<sub>DD</sub></td><td>-0.5</td><td>0.3V<sub>DD</sub></td><td>V</td></tr><tr><td>V<sub>IH</sub></td><td>HIGH-level input voltage <sup><em><a href=#[6-1]>[6-1]</a></em></sup></td><td></td><td>0.7V<sub>DD</sub></td><td><sup><em><a href=#[6-2]>[6-2]</a></em></sup></td><td>0.7V<sub>DD</sub></td><td><sup><em><a href=#[6-2]>[6-2]</a></em></sup></td><td>0.7V<sub>DD</sub> <sup><em><a href=#[6-1]>[6-1]</a></em></sup></td><td><sup><em><a href=#[6-2]>[6-2]</a></em></sup></td><td>V</td></tr><tr><td>V<sub>hys</sub></td><td>hysteresis（滞后） of Schmitt trigger inputs</td><td></td><td>-</td><td>-</td><td>0.05V<sub>DD</sub></td><td>-</td><td>0.05V<sub>DD</sub></td><td>-</td><td>V</td></tr><tr><td>V<sub>OL1</sub></td><td>LOW-level output voltage 1</td><td>(open-drain or open-collector) at 3 mA sink current; V<sub>DD</sub> > 2V</td><td>0</td><td>0.4</td><td>0</td><td>0.4</td><td>0</td><td>0.4</td><td>V</td></tr><tr><td>V<sub>OL2</sub></td><td>LOW-level output voltage 2</td><td>(open-drain or open-collector) at 2 mA sink current <sup><em><a href=#[6-3]>[6-3]</a></em> </sup>; V<sub>DD</sub> ≤ 2V</td><td>-</td><td>-</td><td>0</td><td>0.2V<sub>DD</sub></td><td>0</td><td>0.2V<sub>DD</sub></td><td>V</td></tr><tr><td>I<sub>OL</sub></td><td>LOW-level output current</td><td>V<sub>OL</sub> = 0.4 V</td><td>3</td><td>-</td><td>3</td><td>-</td><td>20</td><td>-</td><td>mA</td></tr><tr><td>I<sub>OL</sub></td><td>LOW-level output current</td><td>V<sub>OL</sub> = 0.6V <sup><em><a href=#[6-4]>[6-4]</a></em></sup></td><td>-</td><td>-</td><td>6</td><td>-</td><td>-</td><td>-</td><td>mA</td></tr><tr><td>t<sub>of</sub></td><td>output fall time from V<sub>IHmin</sub> to V<sub>ILmax</sub></td><td></td><td>-</td><td>250 <sup><em><a href=#[6-5]>[6-5]</a></em></sup></td><td>20 × (V<sub>DD</sub>/5.5V) <sup><em><a href=#[6-5]>[6-6]</a></em></sup></td><td>250 <sup><em><a href=#[6-5]>[6-5]</a></em></sup></td><td>20 × (V<sub>DD</sub>/5.5V) <sup><em><a href=#[6-6]>[6-6]</a></em></sup></td><td>120 <sup><em><a href=#[6-7]>[6-7]</a></em></sup></td><td>ns</td></tr><tr><td>t<sub>SP</sub></td><td>pulse width of spikes that must be suppressed by the input filter</td><td></td><td>-</td><td>-</td><td>0</td><td>50 <sup><em><a href=#[6-8]>[6-8]</a></em></sup></td><td>0</td><td>50 <sup><em><a href=#[6-8]>[6-8]</a></em></sup></td><td>ns</td></tr><tr><td>I<sub>i</sub></td><td>input current each I/O pin</td><td>0.1V<sub>DD</sub> &lt; V<sub>I</sub> &lt; 0.9V<sub>DDmax</sub></td><td>-10</td><td>+10</td><td>-10 <sup><em><a href=#[6-9]>[6-9]</a></em></sup></td><td>+10 <sup><em><a href=#[6-9]>[6-9]</a></em></td><td>-10 <sup><em><a href=#[6-9]>[6-9]</a></em></td><td>+10 <sup><em><a href=#[6-9]>[6-9]</a></em></td><td>μA</td></tr><tr><td>C<sub>i</sub></td><td>capacitance for each I/O pin <sup><em><a href=#[6-10]>[6-10]</a></em></td><td></td><td>-</td><td>10</td><td>-</td><td>10</td><td>-</td><td>10</td><td>pF</td></tr></tbody></table><p><a id=[6-1]>[3-11]</a> ：一些传统标准模式设备的输入电平固定为 V<sub>IL</sub> = 1.5 V 和 V<sub>IH</sub> = 3.0 V。请参阅元件数据手册。<br><a id=[6-2]>[6-2]</a> ：最大 V<sub>IH</sub> = V<sub>DDmax</sub> + 0.5 V 或 5.5 V，以较低者为准。请参阅元件数据手册。<br><a id=[6-3]>[6-3]</a> ：在 3.0 V V<sub>DD</sub> 下驱动 3 mA 的相同电阻值在使用 &lt;2 V V<sub>DD</sub> 和较小电流时提供相同的 RC 时间常数。<br><a id=[6-4]>[6-4]</a> ：为了在 400 kHz 驱动满总线负载，在 0.6 V V<sub>OL</sub> 下需要 6 mA I<sub>DD</sub>。不符合此规格的部件仍然可以工作，但无法在 400 kHz 和 400 pF 下工作。<br><a id=[6-5]>[6-5]</a> ：<em><a href="#表 11">表 11</a></em> 中引用的<strong>SDA</strong>和<strong>SCL</strong>总线线的最大
t<sub>f</sub>（300 ns）比输出级指定的最大 t<sub>of</sub>（250 ns）要长。这允许保护电阻（R<sub>s</sub>）串联连接
在 <strong>SDA</strong>/<strong>SCL</strong> 引脚和 <strong>SDA</strong>/<strong>SCL</strong> 总线线之间，
如 <em><a href="#图 45">图 45</a></em> 所示，而不超过规定的最大 t<sub>f</sub>。<br><a id=[6-6]>[6-6]</a> ：必须向后兼容快速模式。<br><a id=[6-7]>[6-7]</a> ：在快速加模式中，下降时间对输出级和总线时序是相同的。如果使用串联电阻，设计人员在考虑总线时序时应考虑这一点。<br><a id=[6-8]>[6-8]</a> ：<strong>SDA</strong>和<strong>SCL</strong>输入上的输入滤波器抑制小于50ns的噪声尖峰。<br><a id=[6-9]>[6-9]</a> ：如果V<sub>DD</sub>关闭，快速模式和快速加模式设备的I/O引脚不得阻碍<strong>SDA</strong>和<strong>SCL</strong>线路。<br><a id=[6-10]>[6-10]</a> ：诸如多路复用器和开关等特殊用途设备可能会超过此电容，因为它们将多个路径连接在一起。</p><p><a id="表 11">表 11</a> Sm、Fm、Fm+下<strong>SDA</strong>和<strong>SCL</strong> I/O阶段总线</br>所有值均指V<sub>IH(min)</sub> (0.7V<sub>DD</sub>)和V<sub>IL(max)</sub> (0.3V<sub>DD</sub>)水平。</p><table><thead><tr><th>Symbol</th><th>Parameter</th><th>Conditions</th><th>Sm-Min</th><th>Sm-Max</th><th>Fm-Min</th><th>Fm-Max</th><th>Fm+-Min</th><th>Fm+-Max</th><th>Unit</th></tr></thead><tbody><tr><td>f<sub>SCL</sub></td><td>SCL clock frequency</td><td></td><td>0</td><td>100</td><td>0</td><td>400</td><td>0</td><td>1000</td><td>kHz</td></tr><tr><td>t</sub>HD;STA</sub></td><td>hold time (repeated) START</td><td>After this period, the first clock pulse is generated.</td><td>4.0</td><td>-</td><td>0.6</td><td>-</td><td>0.26</td><td>-</td><td>μs</td></tr><tr><td>t<sub>LOW</sub></td><td>LOW period of the SCL clock</td><td></td><td>4.7</td><td>-</td><td>1.3</td><td>-</td><td>0.5</td><td>-</td><td>μs</td></tr><tr><td>t<sub>HIGH</sub></td><td>HIGH period of the SCL clock</td><td></td><td>4.0</td><td>-</td><td>0.6</td><td>-</td><td>0.26</td><td>-</td><td>μs</td></tr><tr><td>t<sub>SU;STA</sub></td><td>set-up time for a repeated START condition</td><td></td><td>4.7</td><td>-</td><td>0.6</td><td>-</td><td>0.26</td><td>-</td><td>μs</td></tr><tr><td>t<sub>HD;DAT</sub></td><td>data hold time <sup><em><a href=#[6-11]>[6-11]</a></em></sup></td><td>CBUS compatible controllers (see Remark in <em><a href="#4.1 cbus兼容性">4.1 cbus兼容性</a></em> Section 4.1)</td><td>5.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>μs</td></tr><tr><td>t<sub>HD;DAT</sub></td><td>data hold time <sup><em><a href=#[6-11]>[6-11]</a></em></sup></td><td>I2C-bus devices</td><td>0 <sup><em><a href=#[6-12]>[6-12]</a></em></sup></td><td>- <sup><em><a href=#[6-13]>[6-13]</a></em></sup></td><td>0 <sup><em><a href=#[6-12]>[6-12]</a></em></sup></td><td>- <sup><em><a href=#[6-13]>[6-13]</a></em></sup></td><td>0</td><td>-</td><td>μs</td></tr><tr><td>t<sub>SU;DAT</sub></td><td>data set-up time</td><td></td><td>250</td><td>-</td><td>100 <sup><em><a href=#[6-14]>[6-14]</a></em></sup></td><td>-</td><td>50</td><td>-</td><td>ns</td></tr><tr><td>t<sub>r</sub></td><td>rise time of both <strong>SDA</strong> and <strong>SCL</strong> signals</td><td></td><td>-</td><td>1000</td><td>20</td><td>300</td><td>-</td><td>120</td><td>ns</td></tr><tr><td>t<sub>f</sub></td><td>fall time of both <strong>SDA</strong> and <strong>SCL</strong> signals <sup><em><a href=#[6-12]>[6-12]</a></em> </sup><sup><em><a href=#[6-15]>[6-15]</a></em> </sup><sup><em><a href=#[6-16]>[6-16]</a></em> </sup><sup><em><a href=#[6-17]>[6-17]</a></em></sup></td><td>-</td><td>300</td><td>20 × (V<sub>DD</sub>/5.5V)</td><td>300</td><td>20 × (V<sub>DD</sub>/5.5V) <sup><em><a href=#[6-18]>[6-18]</a></em></sup></td><td>120 <sup><em><a href=#[6-17]>[6-17]</a></em></sup></td><td>ns</td><td></td></tr><tr><td>t<sub>SU;STO</sub></td><td>set-up time for STOP condition</td><td></td><td>4.0</td><td>-</td><td>0.6</td><td>-</td><td>0.26</td><td>-</td><td>μs</td></tr><tr><td>t<sub>BUF</sub></td><td>bus free time between a STOP and START condition</td><td></td><td>4.7</td><td>-</td><td>1.3</td><td>-</td><td>0.5</td><td>-</td><td>μs</td></tr><tr><td>C<sub>b</sub></td><td>capacitive load for each bus line <sup><em><a href=#[6-19]>[6-19]</a></em></sup></td><td></td><td>-</td><td>400</td><td>-</td><td>400</td><td>-</td><td>550</td><td>pF</td></tr><tr><td>t<sub>VD;DAT</sub></td><td>data valid time <sup><em><a href=#[6-20]>[6-20]</a></em></sup></td><td></td><td>-</td><td>3.45 <sup><em><a href=#[6-13]>[6-13]</a></em></sup></td><td>-</td><td>0.9 <sup><em><a href=#[6-13]>[6-13]</a></em></sup></td><td>-</td><td>0.45 <sup><em><a href=#[6-13]>[6-13]</a></em></sup></td><td>μs</td></tr><tr><td>t<sub>VD;ACK</sub></td><td>data valid acknowledge time <sup><em><a href=#[6-21]>[6-21]</a></em></sup></td><td></td><td>-</td><td>3.45 <sup><em><a href=#[6-13]>[6-13]</a></em></sup></td><td>-</td><td>0.9 <sup><em><a href=#[6-13]>[6-13]</a></em></sup></td><td>-</td><td>0.45 <sup><em><a href=#[6-13]>[6-13]</a></em></sup></td><td>μs</td></tr><tr><td>V<sub>nL</sub></td><td>noise margin at the LOW level</td><td>for each connected device (including hysteresis)</td><td>0.1V<sub>DD</sub></td><td>-</td><td>0.1V<sub>DD</sub></td><td>-</td><td>0.1V<sub>DD</sub></td><td>-</td><td>V</td></tr><tr><td>V<sub>nH</sub></td><td>noise margin at the HIGH level</td><td>for each connected device (including hysteresis)</td><td>0.2V<sub>DD</sub></td><td>-</td><td>0.2V<sub>DD</sub></td><td>-</td><td>0.2V<sub>DD</sub></td><td>-</td><td>V</td></tr></tbody></table><p><a id=[6-11]>[6-11]</a> ：t<sub>HD;DAT</sub> 是从<strong>SCL</strong>的下降沿测量的数据保持时间，适用于传输中的数据和确认。<br><a id=[6-12]>[6-12]</a> ：在<strong>SDA</strong>进入0.3V<sub>DD</sub>到0.7V<sub>DD</sub>的不确定范围之前，<br>确保<strong>SCL</strong>在下降沿时降到0.3V<sub>DD</sub>以下。注意：对于无法观察V<sub>DD</sub>下降沿的控制器，<br>应该独立测量<strong>SCL</strong>从静态高电平(V<sub>DD</sub>)到0.3V<sub>DD</sub>的过渡时间，以便在<strong>SDA</strong>过渡时插入相应的延迟。<br><a id=[6-13]>[6-13]</a> ：最大t<sub>HD;DAT</sub>可以为标准模式下的3.45μs和快速模式下的0.9μs，<br>但必须小于t<sub>VD;DAT</sub>或t<sub>VD;ACK</sub>的最大值加上过渡时间。只有在设备不拉伸<strong>SCL</strong>信号的低电平(t<sub>LOW</sub>)的情况下，<br>这个最大值才能满足。如果时钟拉伸了<strong>SCL</strong>，数据必须在时钟释放之前在设置时间内保持有效。<br><a id=[6-14]>[6-14]</a> ：快速模式I2C总线设备可以在标准模式I2C总线系统中使用，但必须满足t<sub>SU;DAT</sub>=250ns。<br>如果设备不拉伸<strong>SCL</strong>信号的低电平，则自动满足这一要求。如果这样的设备确实拉伸了<strong>SCL</strong>信号的低电平，<br>它必须在<strong>SCL</strong>信号释放之前将下一个数据位输出到<strong>SDA</strong>线。<br>t<sub>r(max)</sub> + t<sub>SU;DAT</sub> = 1000 + 250 = 1250 ns（符合标准模式 I2C 总线规范）。确认时序也必须满足这个设置时间。<br><a id=[6-15]>[6-15]</a> ：如果与 Hs 模式设备混合使用，则根据 <em><a href=#表10>表10</a></em> 允许更快的下降时间。<br><a id=[6-16]>[6-16]</a> ：<strong>SDA</strong>和<strong>SCL</strong>总线线的最大t<sub>f</sub>规定为 300 ns。<br><strong>SDA</strong>输出级的最大下降时间 t<sub>f</sub> 规定为 250 ns。
这允许在<strong>SDA</strong>和<strong>SCL</strong>引脚及<strong>SDA</strong>/<strong>SCL</strong>总线线之间连接串联保护电阻，<br>而不超过规定的最大 t<sub>f</sub>。<br><a id=[6-17]>[6-17]</a> ：在快速加模式模式中，下降时间对于输出阶段和总线时是相同的。如果使用了串联电阻，设计人员应在考虑总线时序时考虑到这一点。<br><a id=[6-18]>[6-18]</a> ：需要向后兼容快速模式。<br><a id=[6-19]>[6-19]</a> ：最大允许总线电容可能根据实际工作电压和应用的频率不同于该值。<br><em><a href="#7.2 超出最大允许电容运行">7.2 超出最大允许电容运行</a></em> 讨论了应对较高总线电容的技术。<br><a id=[6-20]>[6-20]</a> ：t<sub>VD;DAT</sub> = 数据信号从<strong>SCL</strong>低电平到<strong>SDA</strong>输出（高或低，取决于哪个更差）的时间。<br><a id=[6-21]>[6-21]</a> ：t<sub>VD;ACK</sub> = 确认信号从<strong>SCL</strong>低电平到<strong>SDA</strong>输出（高或低，取决于哪个更差）的时间。</p><p><a id="图 38">图 38
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_38._Definition_of_timing_for_FS-mode_devices_on_the_I2C-bus.png alt></a></p><h4 id=a-id62-高速模式62-高速模式a><a id="6.2 高速模式">6.2 高速模式</a></h4><p>I/O 电平、I/O 电流、脉冲抑制、输出斜率控制和 I2C 总线 Hs 模式设备的引脚电容值见 <em><a href="#表 12">表 12</a></em> 。
总线线路上的高低电平噪声裕度与 F/S 模式 I2C 总线设备的规定相同。
<em><a href="#图 39">图 39</a></em> 显示了 Hs 模式时序的所有时序参数。
在 Hs 模式下不存在“正常”的START条件 S。地址位、读写位、应答位和数据位的时序参数都是相同的。
只有在应答位之后第一个<strong>SCLH</strong>时钟信号的上升沿值更大，
因为外部 R<sub>p</sub> 必须在没有内部电流源帮助的情况下拉高<strong>SCLH</strong>。
总线线路的 Hs 模式时序参数见 <em><a href="#表 12">表 12</a></em> 。
<strong>SCLH</strong>时钟信号的最低高电平和低电平周期以及最大上升时间和下降时间决定了最高比特率。
使用内部生成的 <strong>SCLH</strong> 信号，其低电平和高电平周期分别为 200 ns 和 100 ns，
Hs 模式控制器满足外部 <strong>SCLH</strong> 时钟脉冲（考虑到上升和下降时间）的时序要求，最高比特率为 3.4 Mbit/s。
因此，Hs 模式控制器可以使用 10 MHz 或 10 MHz 的倍频基本频率生成 <strong>SCLH</strong> 信号。
SCLH 时钟的最高高电平和低电平周期没有限制，最低比特率也没有限制。</p><p>时序参数对于每条总线线路的电容负载高达 100 pF 是独立的，允许最大比特率为 3.4 Mbit/s。
在总线线路上电容负载增大时，比特率逐渐减小。电容负载为 400 pF 时的时序参数见 <em><a href=#表12>表12</a></em> ，
允许的最大比特率为 1.7 Mbit/s。
对于电容负载在 100 pF 和 400 pF 之间的总线，时序参数必须线性插值。
上升时间和下降时间应符合 <strong>SDAH</strong> 和 <strong>SCLH</strong> 传输线的最大传播时间，以防止开端反射。</p><p><a id="表 12">表 12</a> 高速模式下 <strong>SDAH</strong>、<strong>SCLH</strong>、<strong>SDA</strong>、<strong>SCL</strong> 的IO阶段设备特性</p><table><thead><tr><th>Symbol</th><th>Parameter</th><th>Conditions</th><th>Hs-Min</th><th>Hs-Max</th><th>Unit</th></tr></thead><tbody><tr><td>V<sub>IL</sub></td><td>LOW-level input voltage</td><td></td><td>-0.5</td><td>0.3 V<sub>DD</sub> <sup><em><a href=#[6-22]>[6-22]</a></em></sup></td><td>V</td></tr><tr><td>V<sub>IH</sub></td><td>HIGH-level input voltage</td><td></td><td>0.7 V<sub>DD</sub> <sup><em><a href=#[6-22]>[6-22]</a></em></sup></td><td>VDD + 0.5 <sup><em><a href=#[[6-23]]>[[6-23]]</a></em></sup></td><td>V</td></tr><tr><td>V<sub>hys</sub></td><td>hysteresis of Schmitt trigger inputs</td><td></td><td>0.1V<sub>DD</sub> <sup><em><a href=#[6-22]>[6-22]</a></em></sup></td><td>-</td><td>V</td></tr><tr><td>V<sub>OL</sub></td><td>LOW-level output voltage</td><td>(open-drain) at 3 mA sink current at <strong>SDAH</strong>, <strong>SDA</strong> and <strong>SCLH</strong></td><td></td><td></td><td></td></tr><tr><td>V<sub>OL</sub></td><td>LOW-level output voltage</td><td>V<sub>DD</sub> > 2V</td><td>0</td><td>0.4</td><td>V</td></tr><tr><td>V<sub>OL</sub></td><td>LOW-level output voltage</td><td>V<sub>DD</sub> ≤ 2 V</td><td>0</td><td>0.2V<sub>DD</sub></td><td>V</td></tr><tr><td>R<sub>onL</sub></td><td>transfer gate on resistance for currents between <strong>SDA</strong> and <strong>SDAH</strong> or f<sub>SCL</sub></td><td>V<sub>OL</sub> level; I<sub>OL</sub> = 3 mA</td><td>-</td><td>50</td><td>Ω</td></tr><tr><td>R<sub>onH</sub> <sup><em><a href=#[6-23]>[6-23]</a></em></sup></td><td>transfer gate on resistance between <strong>SDA</strong> and <strong>SDAH</strong> or <strong>SCL</strong> and <strong>SCLH</strong></td><td>both signals (<strong>SDA</strong> and <strong>SDAH</strong>, or <strong>SCL</strong> and <strong>SCLH</strong>) at V<sub>DD</sub> level</td><td>50</td><td>-</td><td>kΩ</td></tr><tr><td>I<sub>CS</sub></td><td>pull-up current of the <strong>SCLH</strong> current-source</td><td><strong>SCLH</strong> output levels between 0.3V<sub>DD</sub> and 0.7V<sub>DD</sub></td><td>3</td><td>12</td><td>mA</td></tr><tr><td>t<sub>rCL</sub></td><td>rise time of <strong>SCLH</strong> signal</td><td>output rise time (current-source enabled)with an external pull-up current source of 3 mA</td><td></td><td></td><td></td></tr><tr><td>t<sub>rCL</sub></td><td>rise time of <strong>SCLH</strong> signal</td><td>capacitive load from 10 pF to 100 pF</td><td>10</td><td>40</td><td>ns</td></tr><tr><td>t<sub>rCL</sub></td><td>rise time of <strong>SCLH</strong> signal</td><td>capacitive load of 400 pF <sup><em><a href=#[6-24]>[6-24]</a></em></sup></td><td>20</td><td>80</td><td>ns</td></tr><tr><td>t<sub>fCL</sub></td><td>fall time of <strong>SCLH</strong> signal</td><td>output fall time (current-source enabled)with an external pull-up current source of 3 mA</td><td></td><td></td><td></td></tr><tr><td>t<sub>fCL</sub></td><td>fall time of <strong>SCLH</strong> signal</td><td>capacitive load from 10 pF to 100 pF</td><td>10</td><td>40</td><td>ns</td></tr><tr><td>t<sub>fCL</sub></td><td>fall time of <strong>SCLH</strong> signal</td><td>capacitive load of 400 pF <sup><em><a href=#[6-24]>[6-25]</a></em></sup></td><td>20</td><td>80</td><td>ns</td></tr><tr><td>t<sub>fDA</sub></td><td>fall time of <strong>SDAH</strong> signal</td><td>capacitive load from 10 pF to 100 pF</td><td>10</td><td>80</td><td>ns</td></tr><tr><td>t<sub>fDA</sub></td><td>fall time of <strong>SDAH</strong> signal</td><td>capacitive load of 400 pF <sup><em><a href=#[6-24]>[6-24]</a></em></sup></td><td>20</td><td>160</td><td>ns</td></tr><tr><td>t<sub>SP</sub></td><td>pulse width of spikes that must be suppressed by the input filter</td><td><strong>SDAH</strong> and <strong>SCLH</strong></td><td>0</td><td>10</td><td>ns</td></tr><tr><td>I<sub>i</sub> <sup><em><a href=#[6-25]>[6-25]</a></em></sup></td><td>input current each I/O pin</td><td>input voltage between 0.1V<sub>DD</sub> and 0.9V<sub>DD</sub></td><td>-</td><td>10</td><td>μA</td></tr><tr><td>C<sub>i</sub></td><td>capacitance for each I/O pin <sup><em><a href=#[6-26]>[6-26]</a></em></sup></td><td></td><td>-</td><td>10</td><td>pF</td></tr></tbody></table><p><a id=[6-22]>[6-22]</a> ：使用非标准供电电压的设备必须将其输入电平与连接到上拉电阻R<sub>p</sub>的V<sub>DD</sub>电压相关联，这些电压不符合预期的I2C总线系统电平。<br><a id=[6-22]>[6-22]</a> ：提供电平转换功能的设备必须容忍<strong>SDA</strong>和<strong>SCL</strong> 的最大输入电压为5.5 V。<br><a id=[6-23]>[6-23]</a> ：对于100 pF至400 pF之间的电容总线负载，升降时间值必须线性插值。<br><a id=[6-24]>[6-24]</a> ：如果其供电电压已关闭，Hs模式目标设备的<strong>SDAH</strong>和<strong>SCLH</strong> I/O阶段必须具有浮动输出。由于电流源输出电路通常具有连接到V<sub>DD</sub>的钳位二极管，因此对于Hs模式控制器设备的<strong>SCLH</strong>或 <strong>SDAH</strong> I/O阶段，此要求并不是强制性的。这意味着不能关闭Hs模式控制器设备的供电电压，否则会影响 <strong>SDAH</strong>和<strong>SCLH</strong>线路。<br><a id=[6-25]>[6-25]</a> ：特殊目的设备，如多路复用器和开关，可能会超过这一电容，因为它们将多个路径连接在一起。</p><p><a id="表 13">表 13</a> 高速模式下 <strong>SDAH</strong>、<strong>SCLH</strong>、<strong>SDA</strong>、<strong>SCL</strong> 的IO阶段总线特性 <sup><em><a href=#37>37</a></em></sup></p><table><thead><tr><th>Symbol</th><th>Parameter</th><th>Conditions</th><th>Hs-Min</th><th>Hs-Max（Cb=100pF）</th><th>HsMin（cb=400pF <sup><em><a href=#[6-27]>[6-27]</a></em> </sup>）</th><th>Hs-Max（cb=400pF <sup><em><a href=#[6-27]>[6-27]</a></em> </sup>）</th><th>Unit</th></tr></thead><tbody><tr><td>f<sub>SCL</sub></td><td><strong>SCLH</strong> clock frequency</td><td></td><td>0</td><td>3.4</td><td>0</td><td>1.7</td><td>MHz</td></tr><tr><td>t<sub>SU;STA</sub></td><td>set-up time for a repeated START condition</td><td></td><td>160</td><td>-</td><td>160</td><td>-</td><td>ns</td></tr><tr><td>t</sub>HD;STA</sub></td><td>hold time (repeated) START condition</td><td></td><td>160</td><td>-</td><td>160</td><td>-</td><td>ns</td></tr><tr><td>t<sub>LOW</sub></td><td>LOW period of the <strong>SCL</strong> clock</td><td></td><td>160</td><td>-</td><td>320</td><td>-</td><td>ns</td></tr><tr><td>t<sub>HIGH</sub></td><td>HIGH period of the <strong>SCL</strong> clock</td><td></td><td>60</td><td>-</td><td>120</td><td>-</td><td>ns</td></tr><tr><td>t<sub>SU;DAT</sub></td><td>data set-up time</td><td></td><td>10</td><td>-</td><td>10</td><td>-</td><td>ns</td></tr><tr><td>t<sub>HD;DAT</sub></td><td>data hold time</td><td></td><td>0 <sup><em><a href=#[6-28]>[6-28]</a></em></sup></td><td>70</td><td>0 <sup><em><a href=#[6-28]>[6-28]</a></em></sup></td><td>150</td><td>ns</td></tr><tr><td>t<sub>rCL</sub></td><td>rise time of <strong>SCLH</strong> signal</td><td></td><td>10</td><td>40</td><td>20</td><td>80</td><td>ns</td></tr><tr><td>t<sub>rCL1</sub></td><td>rise time of <strong>SCLH</strong> signal after a repeated START condition and after an acknowledge bit</td><td></td><td>10</td><td>80</td><td>20</td><td>160</td><td>ns</td></tr><tr><td>t<sub>fCL</sub></td><td>fall time of <strong>SCLH</strong> signal</td><td></td><td>10</td><td>40</td><td>20</td><td>80</td><td>ns</td></tr><tr><td>t<sub>rDA</sub></td><td>rise time of <strong>SDAH</strong> signal</td><td></td><td>10</td><td>80</td><td>20</td><td>160</td><td>ns</td></tr><tr><td>t<sub>fDA</sub></td><td>fall time of <strong>SDAH</strong> signal</td><td></td><td>10</td><td>80</td><td>20</td><td>160</td><td>ns</td></tr><tr><td>t<sub>SU;STO</sub></td><td>set-up time for STOP condition</td><td></td><td>160</td><td>-</td><td>160</td><td>-</td><td>ns</td></tr><tr><td>C<sub>b</sub> <sup><em><a href=#[6-27]>[6-27]</a></em></sup></td><td>capacitive load for each bus line</td><td><strong>SDAH</strong> and <strong>SCLH</strong> lines</td><td>-</td><td>100</td><td>-</td><td>400</td><td>pF</td></tr><tr><td>C<sub>b</sub> <sup><em><a href=#[6-27]>[6-27]</a></em></sup></td><td>capacitive load for each bus line</td><td><strong>SDAH</strong> + <strong>SDA</strong> line and <strong>SCLH</strong> + <strong>SCL</strong> line</td><td>-</td><td>400</td><td>-</td><td>400</td><td>pF</td></tr><tr><td>V<sub>nL</sub></td><td>noise margin at the LOW level</td><td>for each connected device (including hysteresis)</td><td>0.1V<sub>DD</sub></td><td>-</td><td>0.1V<sub>DD</sub></td><td>-</td><td>V</td></tr><tr><td>V<sub>nH</sub></td><td>noise margin at the HIGH level</td><td>for each connected device (including hysteresis)</td><td>0.2V<sub>DD</sub></td><td>-</td><td>0.2V<sub>DD</sub></td><td>-</td><td>V</td></tr></tbody></table><p><a id=[6-26]>[6-26]</a> ：所有数值指的是V<sub>IH(min)</sub>和V<sub>IL(max)</sub0>水平（见 <em><a href="#表 12">表 12</a></em> ）。<br><a id=[6-27]>[6-27]</a> ：对于电源线负载C<sub>b</sub>在100 pF到400 pF之间时，时序参数必须进行线性插值。<br><a id=[6-28]>[6-28]</a> ：设备必须在内部提供数据保持时间，以桥接<strong>SCLH</strong>信号下降沿的V<sub>IH</sub>和V<sub>IL</sub>之间的不确定部分。
输入电路阈值越低，则<strong>SCLH</strong>信号的下降沿数据保持时间越短。</p><p><a id="图 39">图 39
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_39._Definition_of_timing_for_Hs-mode_devices_on_the_I2C-bus.png alt></a></p><h4 id=a-id63-超高速设备63-超高速设备a><a id="6.3 超高速设备">6.3 超高速设备</a></h4><p>I/O 电平、I/O 电流、脉冲抑制、输出斜率控制和引脚电容见 <em><a href="#表 14">表 14</a></em> 。
UFm I2C 总线时序特性见 <em><a href="#表 15">表 15</a></em> .
<em><a href="#图 40">图 40</a></em> 显示了 I2C 总线的时序定义.
<em><a href="#表 15">表 15</a></em> 中指定的<strong>SCL</strong>时钟的最小HIGH和LOW周期决定了超快速模式下最大 5000 kbit/s 的位传输速率。
设备必须能够在其自身最大位速率下跟随传输，无论是能够以该速度发送还是接收。</p><p><a id="表 14">表 14</a> 超高速模式下 <strong>SDAH</strong>、<strong>SCLH</strong>、<strong>SDA</strong>、<strong>SCL</strong> 的IO阶段设备特性</p><table><thead><tr><th>Symbol</th><th>Parameter</th><th>Conditions</th><th>UFm-Min</th><th>UFm-Max</th><th>Unit</th></tr></thead><tbody><tr><td>V<sub>IL</sub></td><td>LOW-level input voltage <sup><em><a href=#[6-29]>[6-29]</a></em></sup></td><td></td><td>-0.5</td><td>+0.3V<sub>DD</sub></td><td>V</td></tr><tr><td>V<sub>IH</sub></td><td>HIGH-level input voltage <sup><em><a href=#[6-29]>[6-29]</a></em></sup></td><td></td><td>0.7V<sub>DD</sub> <sup><em><a href=#[6-29]>[6-29]</a></em></sup></td><td>- <sup><em><a href=#[6-30]>[6-30]</a></em></sup></td><td>V</td></tr><tr><td>V<sub>hys</sub></td><td>hysteresis of Schmitt trigger inputs</td><td></td><td>0.05V<sub>DD</sub></td><td>-</td><td>V</td></tr><tr><td>V<sub>OL</sub></td><td>LOW-level output voltage</td><td>at 4 mA sink current; V<sub>DD</sub> > 2 V</td><td>0</td><td>0.4</td><td>V</td></tr><tr><td>V<sub>OH</sub></td><td>HIGH-level output voltage</td><td>at 4 mA source current; V<sub>DD</sub> > 2 V</td><td>V<sub>DD</sub> - 0.4</td><td>-</td><td>V</td></tr><tr><td>I<sub>L</sub></td><td>leakage current</td><td>V<sub>DD</sub> = 3.6 V</td><td>-1</td><td>+1</td><td>μA</td></tr><tr><td>I<sub>L</sub></td><td>leakage current</td><td>V<sub>DD</sub> = 5.5 V</td><td>-10</td><td>+10</td><td>μA</td></tr><tr><td>C<sub>i</sub></td><td>input capacitance <sup><em><a href=#[6-31]>[6-31]</a></em></sup></td><td></td><td>-</td><td>10</td><td>pF</td></tr><tr><td>t<sub>SP</sub></td><td>pulse width of spikes that must be suppressed by the input filter <sup><em><a href=#[6-32]>[6-32]</a></em></sup></td><td></td><td>-</td><td>10</td><td>ns</td></tr></tbody></table><p><a id=[6-29]>[6-29]</a> ：请参阅元件数据表以获取实际开关点。
<a id=[6-30]>[6-30]</a> ：最大V<sub>IH</sub> = V<sub>DD</sub> + 0.5 V或5.5 V，以较低者为准。请参阅元件数据表。<br><a id=[6-31]>[6-31]</a> ：特殊用途设备如多路复用器和开关可能会超过此电容，因为它们连接多个路径。<br><a id=[6-32]>[6-32]</a> ：<strong>USDA</strong>和<strong>USCL</strong>目标输入上的输入滤波器抑制小于10 ns的噪声尖峰。</p><p><a id="表 15">表 15</a> 超高速模式下 <strong>SDAH</strong>、<strong>SCLH</strong>、<strong>SDA</strong>、<strong>SCL</strong> 的IO阶段总线特性 <sup><em><a href=#37>37</a></em></sup></p><table><thead><tr><th>Symbol</th><th>Parameter</th><th>Conditions</th><th>UFm-Min</th><th>UFm-Max</th><th>Unit</th></tr></thead><tbody><tr><td>f<sub>USCL</sub></td><td><strong>USCL</strong> clock frequency</td><td></td><td>0</td><td>5000</td><td>kHz</td></tr><tr><td>t<sub>BUF</sub></td><td>bus free time between a STOP and START condition</td><td></td><td>80</td><td>-</td><td>ns</td></tr><tr><td>t<sub>HD;STA</sub></td><td>hold time (repeated) START condition</td><td></td><td>50</td><td>-</td><td>ns</td></tr><tr><td>t<sub>SU;STA</sub></td><td>set-up time for a repeated START condition</td><td></td><td>50</td><td>-</td><td>ns</td></tr><tr><td>t<sub>SU;STO</sub></td><td>set-up time for STOP condition</td><td></td><td>50</td><td>-</td><td>ns</td></tr><tr><td>t<sub>HD;DAT</sub></td><td>data hold time</td><td></td><td>10</td><td>-</td><td>ns</td></tr><tr><td>t<sub>VD;DAT</sub></td><td>data valid time <sup><em><a href=#[6-33]>[6-33]</a></em></sup></td><td></td><td>10</td><td>-</td><td>ns</td></tr><tr><td>t<sub>SU;DAT</sub></td><td>data set-up time</td><td></td><td>30</td><td>-</td><td>ns</td></tr><tr><td>t<sub>LOW</sub></td><td>LOW period of the <strong>USCL</strong> clock</td><td></td><td>50</td><td>-</td><td>ns</td></tr><tr><td>t<sub>HIGH</sub></td><td>HIGH period of the <strong>USCL</strong> clock</td><td></td><td>50</td><td>-</td><td>ns</td></tr><tr><td>t<sub>f</sub></td><td>fall time of both <strong>USDA</strong> and <strong>USCL</strong> signals</td><td></td><td>- <sup><em><a href=#[6-34]>[6-34]</a></em></sup></td><td>50</td><td>ns</td></tr><tr><td>t<sub>r</sub></td><td>rise time of both <strong>USDA</strong> and <strong>USCL</strong> signals</td><td></td><td>- <sup><em><a href=#[6-34]>[6-34]</a></em></sup></td><td>50</td><td>n</td></tr></tbody></table><p><a id=[6-33]>[6-33]</a> ：t<sub>VD;DAT</sub> = <strong>USDA</strong>数据在<strong>USCL</strong>低点后的最低有效时间。<br><a id=[6-34]>[6-34]</a> ：UFm信号的典型上升时间或下降时间为25纳秒，从30%的水平测量到70%的水平（上升时间）或从70%的水平测量到30%的水平（下降时间）。</p><p><a id="图 40">图 40
<img src=https://icjj.github.io/icer/img/post/i2c/igure_40._Definition_of_timing_for_Ultra_Fast-mode_devices_on_the_I2C-bus.png alt></a></p><h3 id=a-id第7章-i2c总线设备与总线线路的电气连接第7章-i2c总线设备与总线线路的电气连接a><a id="第7章 i2c总线设备与总线线路的电气连接">第7章 i2c总线设备与总线线路的电气连接</a></h3><h4 id=a-id71-上拉电阻的电阻值选择71-上拉电阻的电阻值选择a><a id="7.1 上拉电阻的电阻值选择">7.1 上拉电阻的电阻值选择</a></h4><p>总线电容是导线、连接和引脚的总电容。这种电容限制了由于规定的上升时间而导致的R<sub>p</sub>的最大值。
<em><a href="#图 41">图 41</a></em> 显示了R<sub>p(max)</sub>与总线电容的关系。</p><p>考虑与V<sub>DD</sub>相关的输入阈值V<sub>IH</sub> = 0.7V<sub>DD</sub>和VV<sub>IL</sub> = 0.3V<sub>DD</sub>，
以便计算RC时间常数。则V(t) = V<sub>DD</sub> (1 - e<sup>-t / RC</sup>)，其中t是从充电开始后的时间，RC是时间常数。</p><p>V(t1) = 0.3 × V<sub>DD</sub> = V<sub>DD</sub> (1 - e<sup>-t1 / RC</sup>)；因此t1 = 0.3566749 × RC</p><p>V(t2) = 0.7 × V<sub>DD</sub> = V<sub>DD</sub> (1 - e<sup>-t2 / RC</sup>)；因此t2 = 1.2039729 × RC</p><p>T = t2 - t1 = 0.8473 × RC</p><p><a id="图 41">图 41</a> 和 <em><a href="#方程 1">方程 1</a></em> 显示了标准模式、快速模式和快速加模式的总线电容对最大R<sub>p</sub>的影响。
对于每种模式，R<sub>p(max)</sub>是来自 <em><a href="#表 11">表 11</a></em> 的上升时间最大值(t<sub>r</sub>)和来自 <em><a href="#表 10">表 10</a></em> 估计的总线电容(C<sub>b</sub>)的函数：</p><p><a id="方程 1">方程 1
<img src=https://icjj.github.io/icer/img/post/i2c/%e6%96%b9%e7%a8%8b1.svg alt></a></p><p><a id="图 41">图 41
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_41._Rpmax_as_a_function_of_bus_capacitance.png alt></a></p><p><a id="图 42">图 42
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_42._Rpmin_as_a_function_of_VDD.png alt></a></p><p>供电电压限制了电阻R<sub>p</sub>的最小值，这取决于标准模式和快速模式下规定的最小漏电流3 mA，
或者快速加模式下的20 mA。R<sub>p(min)</sub>作为V<sub>DD</sub>的函数如 <em><a href="#图 42">图 42</a></em> 所示。
曲线是使用 <em><a href="#公式 2">公式 2</a></em> 计算得出的。</p><p><a id="方程 2">方程 2
<img src=https://icjj.github.io/icer/img/post/i2c/%e6%96%b9%e7%a8%8b2.svg alt></a></p><p>设计师现在已确定满足时序规范所需的R<sub>p</sub>的最小值和最大值。
对供电电流消耗敏感的便携式设计可以使用靠近范围高端的值，以限制I<sub>DD</sub>。</p><h4 id=a-id72-超出最大允许电容运行72-超出最大允许电容运行a><a id="7.2 超出最大允许电容运行">7.2 超出最大允许电容运行</a></h4><p>总线电容限制被规定以限制上升时间的降低并允许在额定频率下工作。
虽然大多数设计可以轻松保持在这一限制之内，但某些应用可能会超过这个限制。系统设计师有几种策略可以应对过高的总线电容。</p><ul><li><em><a href="#7.2.1 降低fscl">7.2.1 降低f<sub>scl</sub></a></em> ：总线可以以更低的速度（较低的 f<sub>SCL</sub>）运行。</li><li><em><a href="#7.2.2 更高的驱动输出">7.2.2 更高的驱动输出</a></em> ：可以使用具有更高驱动电流的设备，
例如额定为快速加模式的设备（PCA96xx）。</li><li><em><a href="#7.2.3 总线缓冲器、多路复用器和开关">7.2.3 总线缓冲器、多路复用器和开关</a></em> ：有多种总线缓冲器设备可用，可以将总线分成多个段，
以使每个段的电容低于允许的限制，例如 PCA9517 总线缓冲器或 PCA9546A 交换机。</li><li><em><a href="#7.2.4 切换式上拉电路">7.2.4 切换式上拉电路</a></em> ：可以使用切换式上拉电路通过在需要时交替接入和拔出低值上拉电阻来加速上升沿。</li></ul><h5 id=a-id721-降低fscl721-降低fsubsclsuba><a id="7.2.1 降低fscl">7.2.1 降低f<sub>scl</sub></a></h5><p>要确定允许的最低总线操作频率，首先找到总线上最限制性的器件的t<sub>LOW</sub>和t<sub>HIGH</sub>。
请参阅各个组件的数据手册以获取这些值。实际上升时间(t<sub>r</sub>)取决于RC时间常数。
最限制的下降时间(t<sub>f</sub>)取决于总线上最低的输出驱动。
确保考虑到任何具有最小t<sub>r</sub>或t<sub>f</sub>的器件。请参考 <em><a href="#方程 3">方程 3</a></em> 以获得结果f<sub>max</sub>。</p><p><a id="方程 3">方程 3
<img src=https://icjj.github.io/icer/img/post/i2c/%e6%96%b9%e7%a8%8b3.svg alt></a></p><blockquote><p>Note：</br>非常长的总线还必须考虑信号的飞行时间。</p></blockquote><p>实际结果较慢，因为实际部分并未把t<sub>LOW</sub>和t<sub>HIGH</sub>控制在从30%到70%或从70%到30%的最小值。</p><h5 id=a-id722-更高的驱动输出722-更高的驱动输出a><a id="7.2.2 更高的驱动输出">7.2.2 更高的驱动输出</a></h5><p>如果使用像PCA96xx快速加模式或P82B总线缓冲器这样的高驱动设备，那么更强的输出驱动器会吸收更多电流，
这会导致边缘速率显著加快，或者换个角度来看，允许更高的总线电容。
有关实际输出驱动能力，请参阅个别元件数据表。使用新的C<sub>b</sub>，R<sub>p</sub>，t<sub>r</sub>和t<sub>f</sub>值重复上述计算，
以确定最大频率。请记住，<em><a href="#表 11">表 11</a></em> 中规定的f<sub>SCL</sub>的
最大额定值（100 kHz，400 kHz和1000 kHz）可能会成为限制因素。</p><h5 id=a-id723-总线缓冲器多路复用器和开关723-总线缓冲器多路复用器和开关a><a id="7.2.3 总线缓冲器、多路复用器和开关">7.2.3 总线缓冲器、多路复用器和开关</a></h5><p>应对最多总线电容的另一种方法是使用总线缓冲器、多路复用器或开关将总线划分为更小的段。
<em><a href="#图 43">图 43</a></em> 显示了一个示例，该示例使用PCA9515缓冲器来处理高总线电容。
每个段允许具有最大电容，因此总的总线可以具有两倍的最大电容。
请注意，添加缓冲器总是会增加延迟——缓冲器延迟加上每个边缘的额外过渡时间，这会降低最大工作频率，
并可能引入特殊的V<sub>IL</sub>和V<sub>OL</sub>考虑。</p><p>有关此主题的更多详细信息以及NXP半导体提供的设备，请参阅应用笔记 <em>AN255、I2C / SMBus重复器、中心集线器和扩展器</em>，
以及<em>AN262、PCA954x系列I2C / SMBus多路复用器和开关</em>。</p><p><a id="图 43">图 43
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_43._Using_a_buffer_to_divide_bus_capacitance.png alt></a></p><h5 id=a-id724-切换式上拉电路724-切换式上拉电路a><a id="7.2.4 切换式上拉电路">7.2.4 切换式上拉电路</a></h5><p>电源电压（V<sub>DD</sub>）和最大输出低电平确定了上拉电阻R<sub>p</sub>的最小值
（见 <em><a href="#7.1 上拉电阻的电阻值选择">7.1 上拉电阻的电阻值选择</a></em> ）。
例如，当电源电压为V<sub>DD</sub> = 5 V ± 10 %，且在3 mA时V<sub>OL(max)</sub> = 0.4 V时，
R<sub>p(min)</sub> = （5.5 - 0.4）/ 0.003 = 1.7 kΩ。
如 <em><a href="#图 42">图 42</a></em> 所示，这个R<sub>p</sub>值将最大总线电容限制在约200 pF，
以满足最大t<sub>r</sub>要求300 ns。如果总线的电容高于这个值，可以使用切换式上拉电路（如 <em><a href="#图 44">图 44</a></em> 所示）。</p><p><a id="图 44">图 44
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_44._Switched_pull-up_circuit.png alt></a></p><p><em><a href="#图 44">图 44</a></em> 中的开关上拉电路适用于供电电压V<sub>DD</sub> = 5 V ± 10 %和最大电容负载为400 pF。
由于它由总线电平控制，因此不需要额外的开关控制信号。
在上升/下降沿期间，HCT4066中的双向开关在0.8 V和2.0 V之间的总线电平下切换上拉电阻R<sub>p2</sub>的开/关。
组合电阻R<sub>p1</sub>和R<sub>p2</sub>可以在最大规定上升时间(t<sub>r</sub>)为300 ns内将总线线拉高。</p><p>串联电阻R<sub>s</sub>是可选的。
它们保护I2C总线设备的I/O级别免受总线线上的高电压尖峰影响，并最小化总线线信号的串扰和下冲。
当总线线切换到低电平以关闭R<sub>p2</sub>时，R<sub>s</sub>的最大值由此电阻上的最大允许电压降决定。</p><p>此外，一些总线缓冲器含有内置的上升时间加速器。独立的上升时间加速器也可用。</p><h4 id=a-id73-串联保护电阻73-串联保护电阻a><a id="7.3 串联保护电阻">7.3 串联保护电阻</a></h4><p>如 <em><a href="#图 45">图 45</a></em> 所示，
可以使用例如300Ω的串联电阻（Rs）来防止<strong>SDA</strong>和<strong>SCL</strong>线路上的高压尖峰
（例如，电视显像管的闪络所导致）。如果使用串联电阻，设计人员必须将额外的电阻考虑到他们对R<sub>p</sub>和允许总线电容的计算中。</p><p><a id="图 45">图 45
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_45._Series_resistors_Rs_for_protection_against_high-voltage_spikes.png alt></a></p><p>对LOW电平所需的0.1V<sub>DD</sub>噪声裕度限制了R<sub>s</sub>的最大值。
R<sub>s(max)</sub>作为R<sub>p</sub>的函数如 <em><a href="#图 46">图 46</a></em> 所示。注意串联电阻会影响输出下降时间。</p><p><a id="图 46">图 46
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_46._Maximum_value_of_Rs_as_a_function_of_the_value_of_Rp_with_supply_voltage_as_a_parameter.png alt></a></p><h4 id=a-id74-输入泄露74-输入泄露a><a id="7.4 输入泄露">7.4 输入泄露</a></h4><p>每个输入/输出连接的最大高电平输入电流具有指定的最大值为10 μA。
由于高电平所需的噪声裕量为0.2V<sub>DD</sub>，这个输入电流限制了R<sub>p</sub>的最大值。
这个限制依赖于V<sub>DD</sub>。总高电平输入电流作为R<sub>p(max)</sub>的函数显示在 <em><a href="#图 47">图 47</a></em> 中。</p><p><a id="图 47">图 47
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_47._Total_HIGH-level_input_current_as_a_function_of_the_maximum_value_of_Rp_with_supply_voltage_as_a_parameter.png alt></a></p><h4 id=a-id75-总线线路的布线模式75-总线线路的布线模式a><a id="7.5 总线线路的布线模式">7.5 总线线路的布线模式</a></h4><p>一般来说，电缆的选择必须使总线线的串扰和干扰降到最低。
由于上拉设备的相对高阻抗，总线线在高电平时最容易受到串扰和干扰。</p><p>如果PCB或扁平电缆上的总线线长度超过10厘米，并且包括VDD和VSS线，则接线图案应为：</p><ul><li>SDA _______________________</li><li>VDD ________________________</li><li>VSS ________________________</li><li>SCL _______________________</li></ul><p>如果仅包括V<sub>SS</sub>线，则接线图案应为：</p><ul><li>SDA _______________________</li><li>VSS ________________________</li><li>SCL _______________________</li></ul><p>这些接线图案还会导致<strong>SDA</strong>和<strong>SCL</strong>线的电容负载相同。</p><p>如果使用带有V<strong>SS</strong>和/或V<sub>DD</sub>层的PCB，
则可以省略V<strong>SS</strong>和V<strong>DD</strong>线。</p><p>如果总线线是双绞线，则每条总线线必须与V<strong>SS</strong>回路成绞合。
此外，<strong>SCL</strong>线可以与V<strong>SS</strong>回路成绞合，
<strong>SDA</strong>线可以与V<sub>DD</sub>回路成绞合。
在后一种情况下，必须在双绞线的两端使用电容器将V<sub>DD</sub>线与V<strong>SS</strong>线解耦。</p><p>如果总线线是屏蔽的（屏蔽接地到V<strong>SS</strong>），则干扰会降到最低。
然而，屏蔽电缆必须在<strong>SDA</strong>和<strong>SCL</strong>线之间具有低电容耦合，以最小化串扰。</p><h3 id=a-id第-8章-缩写第-8章-缩写a><a id="第 8章 缩写">第 8章 缩写</a></h3><p><a id="表 16">表 16</a> 缩写</p><table><thead><tr><th>首字母缩略词 （Acronym）</th><th>描述</th></tr></thead><tbody><tr><td>A/D</td><td>Analog-to-Digital</td></tr><tr><td>ATCA</td><td>Advanced Telecom Computing Architecture</td></tr><tr><td>BMC</td><td>Baseboard（基板） Management Controller</td></tr><tr><td>CMOS</td><td>Complementary Metal-Oxide Semiconductor</td></tr><tr><td>cPCI</td><td>compact（紧凑） Peripheral Component Interconnect</td></tr><tr><td>D/A</td><td>Digital-to-Analog</td></tr><tr><td>DIP</td><td>Dual In-line Package</td></tr><tr><td>EEPROM</td><td>Electrically Erasable Programmable Read Only Memory</td></tr><tr><td>HW</td><td>Hardware</td></tr><tr><td>I/O</td><td>Input/Output</td></tr><tr><td>I2C-bus</td><td>Inter-Integrated Circuit bus</td></tr><tr><td>IC</td><td>Integrated Circuit</td></tr><tr><td>IPMI</td><td>Intelligent Platform Management Interface</td></tr><tr><td>LCD</td><td>Liquid Crystal Display</td></tr><tr><td>LED</td><td>Light Emitting Diode</td></tr><tr><td>LSB</td><td>Least Significant Bit</td></tr><tr><td>MCU</td><td>Microcontroller</td></tr><tr><td>MSB</td><td>Most Significant Bit</td></tr><tr><td>NMOS</td><td>Negative-channel Metal-Oxide Semiconductor</td></tr><tr><td>PCB</td><td>Printed-Circuit Board</td></tr><tr><td>PCI</td><td>Peripheral Component Interconnect</td></tr><tr><td>PMBus</td><td>Power Management Bus</td></tr><tr><td>RAM</td><td>Random Access Memory</td></tr><tr><td>ROM</td><td>Read-Only Memory</td></tr><tr><td>SMBus</td><td>System Management Bus</td></tr><tr><td>SPI</td><td>Serial Peripheral Interface</td></tr><tr><td>UART</td><td>Universal Asynchronous Receiver/Transmitter</td></tr><tr><td>USB</td><td>Universal Serial Bus</td></tr></tbody></table><h3 id=a-id第9章-mipi-i3c概述第9章-mipi-i3c概述a><a id="第9章 mipi i3c概述">第9章 MIPI I3C概述</a></h3><p>MIPI I3C（以及公开可用的MIPI I3C Basic）提供了一种可扩展的中速、实用和控制总线，用于将外设连接到应用处理器。
其设计结合了I2C总线和SPI接口的关键特性，提供了统一的高性能、低功耗接口解决方案，为I2C总线和SPI实施者提供了灵活的升级路径。
I3C最初于2017年推出，是基于与MEMS和传感器产业集团以及更广泛电子生态系统的广泛合作的多年开发项目的成果。</p><p>如 <em><a href="#图 48">图 48</a></em> 所示，具有50 ns滤波器的I2C总线目标可以与以12.5 MHz速度运行的I3C控制器共存，
使现有的I2C总线设计能够迁移到I3C规范。相反，在典型的400 kHz或1 MHz I2C总线速度下工作的I3C目标可以与现有的I2C总线控制器共存。</p><p><a id="图 48">图 48
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_48._I2C_and_I3C_targets_coexisting_with_I3C_controller.png alt></a></p><p>就像I2C一样，I3C也采用标准的CMOS I/O引脚，通过两线接口实现，但与I2C不同的是，它支持带内中断，使从机能够通知主机发生中断，
这一设计特性消除了每个从机需要单独的一般用途输入/输出(GPIO)中断的需求，从而降低了系统成本和复杂性。
对动态地址分配的支持有助于最小化引脚数量，这对适应空间受限的形状因素至关重要。</p><p>I3C支持一个多路总线，在12.5 MHz时支持10 Mbps的标准数据速率(SDR)，并提供高数据速率(HDR)模式的选项。
最终结果是，I3C在性能和功率效率上相比I2C有了显著提升，如 <em><a href="#图 49">图 49</a></em> 所示。</p><p><a id="图 49">图 49
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_49._Comparison_of_Energy_Consumption_and_Data_Rates_I3C_vs_I2C.png alt></a></p><p>I3C的其他技术亮点包括多主机支持、动态寻址、命令码兼容性以及统一的高级电源管理特性的方法，
例如睡眠模式。它提供了同步和异步时间戳功能，以提高融合来自各种外设的信号的应用的准确性。
它还可以快速批处理和传输数据，以最小化主处理器的能耗。</p><h4 id=a-id91-功能比较91-功能比较a><a id="9.1 功能比较">9.1 功能比较</a></h4><p><a id="图 50">图 50
<img src=https://icjj.github.io/icer/img/post/i2c/Figure_50._Comparison_of_I3C_and_I3C_Basic_Features.png alt></a></p><p>虽然I3C的完整版仅对MIPI联盟成员开放，但MIPI已经发布了一个公共版本，称为I3C Basic，
包含了开发人员和其他标准组织最常需要的I3C功能。I3C Basic可在没有MIPI会员资格的情况下实施，旨在为所有实施者提供一个免版税的许可环境。
<em><a href="#图 50">图 50</a></em> 总结了I3C和I3C Basic支持的关键功能。</p><p>为了支持开发人员，通过多次互操作性研讨会确认了不同I3C实施之间的兼容性，并提供了若干支持MIPI的资源。这些资源包括：</p><ul><li>I3C主控制器接口 – MIPI I3C HCI</li><li>适用于Linux的I3C HCI驱动程序</li><li>I3C发现与配置规范 – I3C的DisCo</li><li>I3C调试和测试接口 – MIPI调试I3C</li></ul><p>I3C知识产权（IP）可从多个供应商处获得，包括I3C Basic的免许可版本。I3C符合性测试和验证IP测试套件也可从多个供应商处获得。</p><p>有关I3C和I3C Basic的更多信息，可通过MIPI联盟网站获取<a href=https://www.mipi.org/specifications/i3c-sensor-specification>https://www.mipi.org/specifications/i3c-sensor-specification</a></p><h3 id=a-id第10章-法律信息第10章-法律信息a><a id="第10章 法律信息">第10章 法律信息</a></h3><h3 id=a-id表格表格a><a id=表格>表格</a></h3><h3 id=a-id图片图片a><a id=图片>图片</a></h3><h3 id=a-id目录目录a><a id=目录>目录</a></h3><hr><ul class=pager><li class=previous><a href=/icer/post/nxp-i2c-%E7%9F%A5%E8%AF%86%E6%8F%90%E7%BA%B2/ data-toggle=tooltip data-placement=top title="NXP I2C 知识提纲">&larr;
Previous Post</a></li><li class=next><a href=/icer/post/multi-layer-ahb-%E5%8D%8F%E8%AE%AE%E7%BF%BB%E8%AF%91/ data-toggle=tooltip data-placement=top title=Multi-layer-AHB-协议翻译>Next
Post &rarr;</a></li></ul><script src=https://giscus.app/client.js data-repo=ICJJ/icer data-repo-id=R_kgDOMWEQRg data-category=General data-category-id=DIC_kwDOMWEQRs4CgyrH data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=light data-lang=en crossorigin=anonymous async></script></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=/tags/>FEATURED TAGS</a></h5><div class=tags><a href=/icer/tags/ahb title=ahb>ahb
</a><a href=/icer/tags/amba title=amba>amba
</a><a href=/icer/tags/amba5 title=amba5>amba5
</a><a href=/icer/tags/apb title=apb>apb
</a><a href=/icer/tags/axi title=axi>axi
</a><a href=/icer/tags/bus title=bus>bus
</a><a href=/icer/tags/git title=git>git
</a><a href=/icer/tags/html title=html>html
</a><a href=/icer/tags/i2c title=i2c>i2c
</a><a href=/icer/tags/multi-layer-ahb title=multi-layer-ahb>multi-layer-ahb
</a><a href=/icer/tags/nxp title=nxp>nxp
</a><a href=/icer/tags/spi title=spi>spi
</a><a href=/icer/tags/uart title=uart>uart
</a><a href=/icer/tags/%E4%B8%B2%E5%8F%A3 title=串口>串口
</a><a href=/icer/tags/%E5%8D%8F%E8%AE%AE%E7%BF%BB%E8%AF%91 title=协议翻译>协议翻译
</a><a href=/icer/tags/%E5%A4%A7%E5%B0%8F%E7%AB%AF title=大小端>大小端
</a><a href=/icer/tags/%E5%AD%97%E8%8A%82%E5%BA%8F title=字节序>字节序
</a><a href=/icer/tags/%E7%9F%A5%E8%AF%86%E6%8F%90%E7%BA%B2 title=知识提纲>知识提纲</a></div></section><section><hr><h5>FRIENDS</h5><ul class=list-inline><li><a target=_blank href=https://zhaozhihan.com>Linda的博客</a></li></ul></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:chengjj9527@gmail.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/icjj><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/ICJJ><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-gitlab fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://stackoverflow.com/users/26381389><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i></span></a></li><li><a href rel=alternate type=application/rss+xml title="ICJJ Blog"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; ICJJ Blog 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> by <a href=https://zhaohuabing.com>Huabing</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){t=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),n=$(this).text(),i=$('<a href="'+o+'" rel="nofollow">'+n+"</a>"),s=$('<li class="'+t+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/icer/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script><script src=https://cdn.jsdelivr.net/gh/jmnote/plantuml-encoder@1.2.4/dist/plantuml-encoder.min.js integrity="sha256-Qsk2KRBCN5qVZX7B+8+2IvQl1Aqc723qV1tBCQaVoqo=" crossorigin=anonymous></script><script>(function(){let e="language-plantuml";Array.prototype.forEach.call(document.querySelectorAll("[class^="+e+"]"),function(e){let t=document.createElement("IMG");t.loading="lazy",t.src="http://www.plantuml.com/plantuml/svg/~1"+plantumlEncoder.encode(e.innerText),e.parentNode.parentNode.insertBefore(t,e.parentNode),e.parentNode.style.display="none"})})()</script></body></html>